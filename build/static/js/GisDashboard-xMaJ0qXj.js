import{r as A,R as st,a as Tr,e as qe,j as N,f as ml,t as cn,h as dn,c as _l,i as yl,k as ia,l as vl,m as Cl,n as Ei,o as bl,u as Ll,p as kl,q as xl,v as Ml,w as El,x as Bl,y as wl,z as Dl,A as na}from"./index-BEshu7i5.js";import{T as Sr,b as Ca,u as ba,L as Sl,c as Pl,d as Al,i as Tl,e as Fl,f as Rl,p as aa,h as Ol,j as Il,k as jl,l as La,m as Nl,n as ka,o as Gl,q as zl,r as $l,B as Ul,s as Fr,t as xa,A as Ma,R as _n,v as Pr,C as pn,w as Vl,a as Hl,S as Ea,x as sn,M as Kl,y as Ba,D as ql,z as wa,E as sa,F as oa,G as Yl,H as Xl,I as Zl,J as Da,K as Zr,N as Jl,O as Wl,P as Ql,Q as la,V as eu,W as tu,X as ru,Y as iu,Z as nu,_ as au,$ as su,a0 as on,a1 as Yr,a2 as ou,a3 as lu,a4 as uu,a5 as hu,a6 as cu,a7 as du,U as pu}from"./BufferTool-DvOO40rc.js";import{m as Sa,c as Ar,_ as dt,f as ot,e as Ut,K as We,w as Ct,x as gu,y as fu,z as wi,A as Qt,j as mu,D as _u,E as yu,F as ua,G as vu,H as Jr,n as Pa,J as Aa,r as Ta,u as mt,L as gn,o as Fa,M as Cu,t as bu,C as Si,v as Ra,N as Oa,O as Lu,W as ku,P as yn,B as nr,S as vr,I as Ia,Q as ja}from"./authApi-8tIZ5sXu.js";function fn(c,C,b){return(c-C)/(b-C)}function vn(c,C,b,B){var D=fn(C,b,B),G={};switch(c){case"rtl":G.right="".concat(D*100,"%"),G.transform="translateX(50%)";break;case"btt":G.bottom="".concat(D*100,"%"),G.transform="translateY(50%)";break;case"ttb":G.top="".concat(D*100,"%"),G.transform="translateY(-50%)";break;default:G.left="".concat(D*100,"%"),G.transform="translateX(-50%)";break}return G}function yr(c,C){return Array.isArray(c)?c[C]:c}var Cr=A.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),xu=A.createContext({}),Mu=["prefixCls","value","valueIndex","onStartMove","onDelete","style","render","dragging","draggingDelete","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],ha=A.forwardRef(function(c,C){var b=c.prefixCls,B=c.value,D=c.valueIndex,G=c.onStartMove,M=c.onDelete,V=c.style,Q=c.render,W=c.dragging,$=c.draggingDelete,ee=c.onOffsetChange,te=c.onChangeComplete,X=c.onFocus,Z=c.onMouseEnter,J=Sa(c,Mu),H=A.useContext(Cr),U=H.min,z=H.max,q=H.direction,ie=H.disabled,oe=H.keyboard,he=H.range,ge=H.tabIndex,xe=H.ariaLabelForHandle,me=H.ariaLabelledByForHandle,pe=H.ariaRequired,ce=H.ariaValueTextFormatterForHandle,fe=H.styles,Ae=H.classNames,ze="".concat(b,"-handle"),Se=function(we){ie||G(we,D)},He=function(we){X?.(we,D)},Be=function(we){Z(we,D)},Ge=function(we){if(!ie&&oe){var ye=null;switch(we.which||we.keyCode){case We.LEFT:ye=q==="ltr"||q==="btt"?-1:1;break;case We.RIGHT:ye=q==="ltr"||q==="btt"?1:-1;break;case We.UP:ye=q!=="ttb"?1:-1;break;case We.DOWN:ye=q!=="ttb"?-1:1;break;case We.HOME:ye="min";break;case We.END:ye="max";break;case We.PAGE_UP:ye=2;break;case We.PAGE_DOWN:ye=-2;break;case We.BACKSPACE:case We.DELETE:M?.(D);break}ye!==null&&(we.preventDefault(),ee(ye,D))}},Ke=function(we){switch(we.which||we.keyCode){case We.LEFT:case We.RIGHT:case We.UP:case We.DOWN:case We.HOME:case We.END:case We.PAGE_UP:case We.PAGE_DOWN:te?.();break}},Te=vn(q,B,U,z),Qe={};if(D!==null){var $e;Qe={tabIndex:ie?null:yr(ge,D),role:"slider","aria-valuemin":U,"aria-valuemax":z,"aria-valuenow":B,"aria-disabled":ie,"aria-label":yr(xe,D),"aria-labelledby":yr(me,D),"aria-required":yr(pe,D),"aria-valuetext":($e=yr(ce,D))===null||$e===void 0?void 0:$e(B),"aria-orientation":q==="ltr"||q==="rtl"?"horizontal":"vertical",onMouseDown:Se,onTouchStart:Se,onFocus:He,onMouseEnter:Be,onKeyDown:Ge,onKeyUp:Ke}}var Mt=A.createElement("div",Ar({ref:C,className:ot(ze,Ut(Ut(Ut({},"".concat(ze,"-").concat(D+1),D!==null&&he),"".concat(ze,"-dragging"),W),"".concat(ze,"-dragging-delete"),$),Ae.handle),style:dt(dt(dt({},Te),V),fe.handle)},Qe,J));return Q&&(Mt=Q(Mt,{index:D,prefixCls:b,value:B,dragging:W,draggingDelete:$})),Mt}),Eu=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","draggingDelete","onFocus"],Bu=A.forwardRef(function(c,C){var b=c.prefixCls,B=c.style,D=c.onStartMove,G=c.onOffsetChange,M=c.values,V=c.handleRender,Q=c.activeHandleRender,W=c.draggingIndex,$=c.draggingDelete,ee=c.onFocus,te=Sa(c,Eu),X=A.useRef({}),Z=A.useState(!1),J=Ct(Z,2),H=J[0],U=J[1],z=A.useState(-1),q=Ct(z,2),ie=q[0],oe=q[1],he=function(ce){oe(ce),U(!0)},ge=function(ce,fe){he(fe),ee?.(ce)},xe=function(ce,fe){he(fe)};A.useImperativeHandle(C,function(){return{focus:function(ce){var fe;(fe=X.current[ce])===null||fe===void 0||fe.focus()},hideHelp:function(){gu.flushSync(function(){U(!1)})}}});var me=dt({prefixCls:b,onStartMove:D,onOffsetChange:G,render:V,onFocus:ge,onMouseEnter:xe},te);return A.createElement(A.Fragment,null,M.map(function(pe,ce){var fe=W===ce;return A.createElement(ha,Ar({ref:function(ze){ze?X.current[ce]=ze:delete X.current[ce]},dragging:fe,draggingDelete:fe&&$,style:yr(B,ce),key:ce,value:pe,valueIndex:ce},me))}),Q&&H&&A.createElement(ha,Ar({key:"a11y"},me,{value:M[ie],valueIndex:null,dragging:W!==-1,draggingDelete:$,render:Q,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),wu=function(C){var b=C.prefixCls,B=C.style,D=C.children,G=C.value,M=C.onClick,V=A.useContext(Cr),Q=V.min,W=V.max,$=V.direction,ee=V.includedStart,te=V.includedEnd,X=V.included,Z="".concat(b,"-text"),J=vn($,G,Q,W);return A.createElement("span",{className:ot(Z,Ut({},"".concat(Z,"-active"),X&&ee<=G&&G<=te)),style:dt(dt({},J),B),onMouseDown:function(U){U.stopPropagation()},onClick:function(){M(G)}},D)},Du=function(C){var b=C.prefixCls,B=C.marks,D=C.onClick,G="".concat(b,"-mark");return B.length?A.createElement("div",{className:G},B.map(function(M){var V=M.value,Q=M.style,W=M.label;return A.createElement(wu,{key:V,prefixCls:G,style:Q,value:V,onClick:D},W)})):null},Su=function(C){var b=C.prefixCls,B=C.value,D=C.style,G=C.activeStyle,M=A.useContext(Cr),V=M.min,Q=M.max,W=M.direction,$=M.included,ee=M.includedStart,te=M.includedEnd,X="".concat(b,"-dot"),Z=$&&ee<=B&&B<=te,J=dt(dt({},vn(W,B,V,Q)),typeof D=="function"?D(B):D);return Z&&(J=dt(dt({},J),typeof G=="function"?G(B):G)),A.createElement("span",{className:ot(X,Ut({},"".concat(X,"-active"),Z)),style:J})},Pu=function(C){var b=C.prefixCls,B=C.marks,D=C.dots,G=C.style,M=C.activeStyle,V=A.useContext(Cr),Q=V.min,W=V.max,$=V.step,ee=A.useMemo(function(){var te=new Set;if(B.forEach(function(Z){te.add(Z.value)}),D&&$!==null)for(var X=Q;X<=W;)te.add(X),X+=$;return Array.from(te)},[Q,W,$,D,B]);return A.createElement("div",{className:"".concat(b,"-step")},ee.map(function(te){return A.createElement(Su,{prefixCls:b,key:te,value:te,style:G,activeStyle:M})}))},ca=function(C){var b=C.prefixCls,B=C.style,D=C.start,G=C.end,M=C.index,V=C.onStartMove,Q=C.replaceCls,W=A.useContext(Cr),$=W.direction,ee=W.min,te=W.max,X=W.disabled,Z=W.range,J=W.classNames,H="".concat(b,"-track"),U=fn(D,ee,te),z=fn(G,ee,te),q=function(ge){!X&&V&&V(ge,-1)},ie={};switch($){case"rtl":ie.right="".concat(U*100,"%"),ie.width="".concat(z*100-U*100,"%");break;case"btt":ie.bottom="".concat(U*100,"%"),ie.height="".concat(z*100-U*100,"%");break;case"ttb":ie.top="".concat(U*100,"%"),ie.height="".concat(z*100-U*100,"%");break;default:ie.left="".concat(U*100,"%"),ie.width="".concat(z*100-U*100,"%")}var oe=Q||ot(H,Ut(Ut({},"".concat(H,"-").concat(M+1),M!==null&&Z),"".concat(b,"-track-draggable"),V),J.track);return A.createElement("div",{className:oe,style:dt(dt({},ie),B),onMouseDown:q,onTouchStart:q})},Au=function(C){var b=C.prefixCls,B=C.style,D=C.values,G=C.startPoint,M=C.onStartMove,V=A.useContext(Cr),Q=V.included,W=V.range,$=V.min,ee=V.styles,te=V.classNames,X=A.useMemo(function(){if(!W){if(D.length===0)return[];var J=G??$,H=D[0];return[{start:Math.min(J,H),end:Math.max(J,H)}]}for(var U=[],z=0;z<D.length-1;z+=1)U.push({start:D[z],end:D[z+1]});return U},[D,W,G,$]);if(!Q)return null;var Z=X!=null&&X.length&&(te.tracks||ee.tracks)?A.createElement(ca,{index:null,prefixCls:b,start:X[0].start,end:X[X.length-1].end,replaceCls:ot(te.tracks,"".concat(b,"-tracks")),style:ee.tracks}):null;return A.createElement(A.Fragment,null,Z,X.map(function(J,H){var U=J.start,z=J.end;return A.createElement(ca,{index:H,prefixCls:b,style:dt(dt({},yr(B,H)),ee.track),start:U,end:z,key:H,onStartMove:M})}))},Tu=130;function da(c){var C="targetTouches"in c?c.targetTouches[0]:c;return{pageX:C.pageX,pageY:C.pageY}}function Fu(c,C,b,B,D,G,M,V,Q,W,$){var ee=A.useState(null),te=Ct(ee,2),X=te[0],Z=te[1],J=A.useState(-1),H=Ct(J,2),U=H[0],z=H[1],q=A.useState(!1),ie=Ct(q,2),oe=ie[0],he=ie[1],ge=A.useState(b),xe=Ct(ge,2),me=xe[0],pe=xe[1],ce=A.useState(b),fe=Ct(ce,2),Ae=fe[0],ze=fe[1],Se=A.useRef(null),He=A.useRef(null),Be=A.useRef(null),Ge=A.useContext(xu),Ke=Ge.onDragStart,Te=Ge.onDragChange;fu(function(){U===-1&&pe(b)},[b,U]),A.useEffect(function(){return function(){document.removeEventListener("mousemove",Se.current),document.removeEventListener("mouseup",He.current),Be.current&&(Be.current.removeEventListener("touchmove",Se.current),Be.current.removeEventListener("touchend",He.current))}},[]);var Qe=function(ye,Re,Oe){Re!==void 0&&Z(Re),pe(ye);var Ue=ye;Oe&&(Ue=ye.filter(function(Fe,Ye){return Ye!==U})),M(Ue),Te&&Te({rawValues:ye,deleteIndex:Oe?U:-1,draggingIndex:U,draggingValue:Re})},$e=wi(function(we,ye,Re){if(we===-1){var Oe=Ae[0],Ue=Ae[Ae.length-1],Fe=B-Oe,Ye=D-Ue,lt=ye*(D-B);lt=Math.max(lt,Fe),lt=Math.min(lt,Ye);var pt=G(Oe+lt);lt=pt-Oe;var _t=Ae.map(function(ut){return ut+lt});Qe(_t)}else{var bt=(D-B)*ye,Lt=Qt(me);Lt[we]=Ae[we];var kt=Q(Lt,bt,we,"dist");Qe(kt.values,kt.value,Re)}}),Mt=function(ye,Re,Oe){ye.stopPropagation();var Ue=Oe||b,Fe=Ue[Re];z(Re),Z(Fe),ze(Ue),pe(Ue),he(!1);var Ye=da(ye),lt=Ye.pageX,pt=Ye.pageY,_t=!1;Ke&&Ke({rawValues:Ue,draggingIndex:Re,draggingValue:Fe});var bt=function(ut){ut.preventDefault();var tt=da(ut),Vt=tt.pageX,Ht=tt.pageY,At=Vt-lt,gt=Ht-pt,De=c.current.getBoundingClientRect(),Xe=De.width,Et=De.height,xt,ht;switch(C){case"btt":xt=-gt/Et,ht=At;break;case"ttb":xt=gt/Et,ht=At;break;case"rtl":xt=-At/Xe,ht=gt;break;default:xt=At/Xe,ht=gt}_t=W?Math.abs(ht)>Tu&&$<me.length:!1,he(_t),$e(Re,xt,_t)},Lt=function kt(ut){ut.preventDefault(),document.removeEventListener("mouseup",kt),document.removeEventListener("mousemove",bt),Be.current&&(Be.current.removeEventListener("touchmove",Se.current),Be.current.removeEventListener("touchend",He.current)),Se.current=null,He.current=null,Be.current=null,V(_t),z(-1),he(!1)};document.addEventListener("mouseup",Lt),document.addEventListener("mousemove",bt),ye.currentTarget.addEventListener("touchend",Lt),ye.currentTarget.addEventListener("touchmove",bt),Se.current=bt,He.current=Lt,Be.current=ye.currentTarget},et=A.useMemo(function(){var we=Qt(b).sort(function(Fe,Ye){return Fe-Ye}),ye=Qt(me).sort(function(Fe,Ye){return Fe-Ye}),Re={};ye.forEach(function(Fe){Re[Fe]=(Re[Fe]||0)+1}),we.forEach(function(Fe){Re[Fe]=(Re[Fe]||0)-1});var Oe=W?1:0,Ue=Object.values(Re).reduce(function(Fe,Ye){return Fe+Math.abs(Ye)},0);return Ue<=Oe?me:b},[b,me,W]);return[U,X,oe,et,Mt]}function Ru(c,C,b,B,D,G){var M=A.useCallback(function(X){return Math.max(c,Math.min(C,X))},[c,C]),V=A.useCallback(function(X){if(b!==null){var Z=c+Math.round((M(X)-c)/b)*b,J=function(q){return(String(q).split(".")[1]||"").length},H=Math.max(J(b),J(C),J(c)),U=Number(Z.toFixed(H));return c<=U&&U<=C?U:null}return null},[b,c,C,M]),Q=A.useCallback(function(X){var Z=M(X),J=B.map(function(z){return z.value});b!==null&&J.push(V(X)),J.push(c,C);var H=J[0],U=C-c;return J.forEach(function(z){var q=Math.abs(Z-z);q<=U&&(H=z,U=q)}),H},[c,C,B,b,M,V]),W=function X(Z,J,H){var U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof J=="number"){var z,q=Z[H],ie=q+J,oe=[];B.forEach(function(pe){oe.push(pe.value)}),oe.push(c,C),oe.push(V(q));var he=J>0?1:-1;U==="unit"?oe.push(V(q+he*b)):oe.push(V(ie)),oe=oe.filter(function(pe){return pe!==null}).filter(function(pe){return J<0?pe<=q:pe>=q}),U==="unit"&&(oe=oe.filter(function(pe){return pe!==q}));var ge=U==="unit"?q:ie;z=oe[0];var xe=Math.abs(z-ge);if(oe.forEach(function(pe){var ce=Math.abs(pe-ge);ce<xe&&(z=pe,xe=ce)}),z===void 0)return J<0?c:C;if(U==="dist")return z;if(Math.abs(J)>1){var me=Qt(Z);return me[H]=z,X(me,J-he,H,U)}return z}else{if(J==="min")return c;if(J==="max")return C}},$=function(Z,J,H){var U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",z=Z[H],q=W(Z,J,H,U);return{value:q,changed:q!==z}},ee=function(Z){return G===null&&Z===0||typeof G=="number"&&Z<G},te=function(Z,J,H){var U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",z=Z.map(Q),q=z[H],ie=W(z,J,H,U);if(z[H]=ie,D===!1){var oe=G||0;H>0&&z[H-1]!==q&&(z[H]=Math.max(z[H],z[H-1]+oe)),H<z.length-1&&z[H+1]!==q&&(z[H]=Math.min(z[H],z[H+1]-oe))}else if(typeof G=="number"||G===null){for(var he=H+1;he<z.length;he+=1)for(var ge=!0;ee(z[he]-z[he-1])&&ge;){var xe=$(z,1,he);z[he]=xe.value,ge=xe.changed}for(var me=H;me>0;me-=1)for(var pe=!0;ee(z[me]-z[me-1])&&pe;){var ce=$(z,-1,me-1);z[me-1]=ce.value,pe=ce.changed}for(var fe=z.length-1;fe>0;fe-=1)for(var Ae=!0;ee(z[fe]-z[fe-1])&&Ae;){var ze=$(z,-1,fe-1);z[fe-1]=ze.value,Ae=ze.changed}for(var Se=0;Se<z.length-1;Se+=1)for(var He=!0;ee(z[Se+1]-z[Se])&&He;){var Be=$(z,1,Se+1);z[Se+1]=Be.value,He=Be.changed}}return{value:z[H],values:z}};return[Q,te]}function Ou(c){return A.useMemo(function(){if(c===!0||!c)return[!!c,!1,!1,0];var C=c.editable,b=c.draggableTrack,B=c.minCount,D=c.maxCount;return[!0,C,!C&&b,B||0,D]},[c])}var Iu=A.forwardRef(function(c,C){var b=c.prefixCls,B=b===void 0?"rc-slider":b,D=c.className,G=c.style,M=c.classNames,V=c.styles,Q=c.id,W=c.disabled,$=W===void 0?!1:W,ee=c.keyboard,te=ee===void 0?!0:ee,X=c.autoFocus,Z=c.onFocus,J=c.onBlur,H=c.min,U=H===void 0?0:H,z=c.max,q=z===void 0?100:z,ie=c.step,oe=ie===void 0?1:ie,he=c.value,ge=c.defaultValue,xe=c.range,me=c.count,pe=c.onChange,ce=c.onBeforeChange,fe=c.onAfterChange,Ae=c.onChangeComplete,ze=c.allowCross,Se=ze===void 0?!0:ze,He=c.pushable,Be=He===void 0?!1:He,Ge=c.reverse,Ke=c.vertical,Te=c.included,Qe=Te===void 0?!0:Te,$e=c.startPoint,Mt=c.trackStyle,et=c.handleStyle,we=c.railStyle,ye=c.dotStyle,Re=c.activeDotStyle,Oe=c.marks,Ue=c.dots,Fe=c.handleRender,Ye=c.activeHandleRender,lt=c.track,pt=c.tabIndex,_t=pt===void 0?0:pt,bt=c.ariaLabelForHandle,Lt=c.ariaLabelledByForHandle,kt=c.ariaRequired,ut=c.ariaValueTextFormatterForHandle,tt=A.useRef(null),Vt=A.useRef(null),Ht=A.useMemo(function(){return Ke?Ge?"ttb":"btt":Ge?"rtl":"ltr"},[Ge,Ke]),At=Ou(xe),gt=Ct(At,5),De=gt[0],Xe=gt[1],Et=gt[2],xt=gt[3],ht=gt[4],rt=A.useMemo(function(){return isFinite(U)?U:0},[U]),Bt=A.useMemo(function(){return isFinite(q)?q:100},[q]),Tt=A.useMemo(function(){return oe!==null&&oe<=0?1:oe},[oe]),Ie=A.useMemo(function(){return typeof Be=="boolean"?Be?Tt:!1:Be>=0?Be:!1},[Be,Tt]),it=A.useMemo(function(){return Object.keys(Oe||{}).map(function(be){var ue=Oe[be],ke={value:Number(be)};return ue&&mu(ue)==="object"&&!A.isValidElement(ue)&&("label"in ue||"style"in ue)?(ke.style=ue.style,ke.label=ue.label):ke.label=ue,ke}).filter(function(be){var ue=be.label;return ue||typeof ue=="number"}).sort(function(be,ue){return be.value-ue.value})},[Oe]),br=Ru(rt,Bt,Tt,it,Se,Ie),Ft=Ct(br,2),Rt=Ft[0],er=Ft[1],cr=_u(ge,{value:he}),Wr=Ct(cr,2),Ot=Wr[0],Ai=Wr[1],nt=A.useMemo(function(){var be=Ot==null?[]:Array.isArray(Ot)?Ot:[Ot],ue=Ct(be,1),ke=ue[0],Pe=ke===void 0?rt:ke,Ve=Ot===null?[]:[Pe];if(De){if(Ve=Qt(be),me||Ot===void 0){var Kt=me>=0?me+1:2;for(Ve=Ve.slice(0,Kt);Ve.length<Kt;){var It;Ve.push((It=Ve[Ve.length-1])!==null&&It!==void 0?It:rt)}}Ve.sort(function(jt,Nt){return jt-Nt})}return Ve.forEach(function(jt,Nt){Ve[Nt]=Rt(jt)}),Ve},[Ot,De,rt,me,Rt]),sr=function(ue){return De?ue:ue[0]},Lr=wi(function(be){var ue=Qt(be).sort(function(ke,Pe){return ke-Pe});pe&&!yu(ue,nt,!0)&&pe(sr(ue)),Ai(ue)}),Rr=wi(function(be){be&&tt.current.hideHelp();var ue=sr(nt);fe?.(ue),ua(!fe,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),Ae?.(ue)}),Qr=function(ue){if(!($||!Xe||nt.length<=xt)){var ke=Qt(nt);ke.splice(ue,1),ce?.(sr(ke)),Lr(ke);var Pe=Math.max(0,ue-1);tt.current.hideHelp(),tt.current.focus(Pe)}},Ti=Fu(Vt,Ht,nt,rt,Bt,Rt,Lr,Rr,er,Xe,xt),dr=Ct(Ti,5),ei=dr[0],ti=dr[1],Fi=dr[2],Or=dr[3],ri=dr[4],Ir=function(ue,ke){if(!$){var Pe=Qt(nt),Ve=0,Kt=0,It=Bt-rt;nt.forEach(function(qt,gr){var Nr=Math.abs(ue-qt);Nr<=It&&(It=Nr,Ve=gr),qt<ue&&(Kt=gr)});var jt=Ve;Xe&&It!==0&&(!ht||nt.length<ht)?(Pe.splice(Kt+1,0,ue),jt=Kt+1):Pe[Ve]=ue,De&&!nt.length&&me===void 0&&Pe.push(ue);var Nt=sr(Pe);if(ce?.(Nt),Lr(Pe),ke){var tr,Gt;(tr=document.activeElement)===null||tr===void 0||(Gt=tr.blur)===null||Gt===void 0||Gt.call(tr),tt.current.focus(jt),ri(ke,jt,Pe)}else fe?.(Nt),ua(!fe,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),Ae?.(Nt)}},Ri=function(ue){ue.preventDefault();var ke=Vt.current.getBoundingClientRect(),Pe=ke.width,Ve=ke.height,Kt=ke.left,It=ke.top,jt=ke.bottom,Nt=ke.right,tr=ue.clientX,Gt=ue.clientY,qt;switch(Ht){case"btt":qt=(jt-Gt)/Ve;break;case"ttb":qt=(Gt-It)/Ve;break;case"rtl":qt=(Nt-tr)/Pe;break;default:qt=(tr-Kt)/Pe}var gr=rt+qt*(Bt-rt);Ir(Rt(gr),ue)},Oi=A.useState(null),ii=Ct(Oi,2),kr=ii[0],ni=ii[1],Ii=function(ue,ke){if(!$){var Pe=er(nt,ue,ke);ce?.(sr(nt)),Lr(Pe.values),ni(Pe.value)}};A.useEffect(function(){if(kr!==null){var be=nt.indexOf(kr);be>=0&&tt.current.focus(be)}ni(null)},[kr]);var ji=A.useMemo(function(){return Et&&Tt===null?!1:Et},[Et,Tt]),ai=wi(function(be,ue){ri(be,ue),ce?.(sr(nt))}),si=ei!==-1;A.useEffect(function(){if(!si){var be=nt.lastIndexOf(ti);tt.current.focus(be)}},[si]);var pr=A.useMemo(function(){return Qt(Or).sort(function(be,ue){return be-ue})},[Or]),Ni=A.useMemo(function(){return De?[pr[0],pr[pr.length-1]]:[rt,pr[0]]},[pr,De,rt]),oi=Ct(Ni,2),li=oi[0],xr=oi[1];A.useImperativeHandle(C,function(){return{focus:function(){tt.current.focus(0)},blur:function(){var ue,ke=document,Pe=ke.activeElement;(ue=Vt.current)!==null&&ue!==void 0&&ue.contains(Pe)&&Pe?.blur()}}}),A.useEffect(function(){X&&tt.current.focus(0)},[]);var jr=A.useMemo(function(){return{min:rt,max:Bt,direction:Ht,disabled:$,keyboard:te,step:Tt,included:Qe,includedStart:li,includedEnd:xr,range:De,tabIndex:_t,ariaLabelForHandle:bt,ariaLabelledByForHandle:Lt,ariaRequired:kt,ariaValueTextFormatterForHandle:ut,styles:V||{},classNames:M||{}}},[rt,Bt,Ht,$,te,Tt,Qe,li,xr,De,_t,bt,Lt,kt,ut,V,M]);return A.createElement(Cr.Provider,{value:jr},A.createElement("div",{ref:Vt,className:ot(B,D,Ut(Ut(Ut(Ut({},"".concat(B,"-disabled"),$),"".concat(B,"-vertical"),Ke),"".concat(B,"-horizontal"),!Ke),"".concat(B,"-with-marks"),it.length)),style:G,onMouseDown:Ri,id:Q},A.createElement("div",{className:ot("".concat(B,"-rail"),M?.rail),style:dt(dt({},we),V?.rail)}),lt!==!1&&A.createElement(Au,{prefixCls:B,style:Mt,values:nt,startPoint:$e,onStartMove:ji?ai:void 0}),A.createElement(Pu,{prefixCls:B,marks:it,dots:Ue,style:ye,activeStyle:Re}),A.createElement(Bu,{ref:tt,prefixCls:B,style:et,values:Or,draggingIndex:ei,draggingDelete:Fi,onStartMove:ai,onOffsetChange:Ii,onFocus:Z,onBlur:J,handleRender:Fe,activeHandleRender:Ye,onChangeComplete:Rr,onDelete:Xe?Qr:void 0}),A.createElement(Du,{prefixCls:B,marks:it,onClick:Ir})))});const ju=A.createContext({}),pa=A.forwardRef((c,C)=>{const{open:b,draggingDelete:B,value:D}=c,G=A.useRef(null),M=b&&!B,V=A.useRef(null);function Q(){Jr.cancel(V.current),V.current=null}function W(){V.current=Jr(()=>{var $;($=G.current)===null||$===void 0||$.forceAlign(),V.current=null})}return A.useEffect(()=>(M?W():Q(),Q),[M,c.title,D]),A.createElement(Sr,Object.assign({ref:vu(G,C)},c,{open:M}))}),Nu=c=>{const{componentCls:C,antCls:b,controlSize:B,dotSize:D,marginFull:G,marginPart:M,colorFillContentHover:V,handleColorDisabled:Q,calc:W,handleSize:$,handleSizeHover:ee,handleActiveColor:te,handleActiveOutlineColor:X,handleLineWidth:Z,handleLineWidthHover:J,motionDurationMid:H}=c;return{[C]:Object.assign(Object.assign({},Ta(c)),{position:"relative",height:B,margin:`${mt(M)} ${mt(G)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${mt(G)} ${mt(M)}`},[`${C}-rail`]:{position:"absolute",backgroundColor:c.railBg,borderRadius:c.borderRadiusXS,transition:`background-color ${H}`},[`${C}-track,${C}-tracks`]:{position:"absolute",transition:`background-color ${H}`},[`${C}-track`]:{backgroundColor:c.trackBg,borderRadius:c.borderRadiusXS},[`${C}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${C}-rail`]:{backgroundColor:c.railHoverBg},[`${C}-track`]:{backgroundColor:c.trackHoverBg},[`${C}-dot`]:{borderColor:V},[`${C}-handle::after`]:{boxShadow:`0 0 0 ${mt(Z)} ${c.colorPrimaryBorderHover}`},[`${C}-dot-active`]:{borderColor:c.dotActiveBorderColor}},[`${C}-handle`]:{position:"absolute",width:$,height:$,outline:"none",userSelect:"none","&-dragging-delete":{opacity:0},"&::before":{content:'""',position:"absolute",insetInlineStart:W(Z).mul(-1).equal(),insetBlockStart:W(Z).mul(-1).equal(),width:W($).add(W(Z).mul(2)).equal(),height:W($).add(W(Z).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:$,height:$,backgroundColor:c.colorBgElevated,boxShadow:`0 0 0 ${mt(Z)} ${c.handleColor}`,outline:"0px solid transparent",borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${H},
            inset-block-start ${H},
            width ${H},
            height ${H},
            box-shadow ${H},
            outline ${H}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:W(ee).sub($).div(2).add(J).mul(-1).equal(),insetBlockStart:W(ee).sub($).div(2).add(J).mul(-1).equal(),width:W(ee).add(W(J).mul(2)).equal(),height:W(ee).add(W(J).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${mt(J)} ${te}`,outline:`6px solid ${X}`,width:ee,height:ee,insetInlineStart:c.calc($).sub(ee).div(2).equal(),insetBlockStart:c.calc($).sub(ee).div(2).equal()}}},[`&-lock ${C}-handle`]:{"&::before, &::after":{transition:"none"}},[`${C}-mark`]:{position:"absolute",fontSize:c.fontSize},[`${C}-mark-text`]:{position:"absolute",display:"inline-block",color:c.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:c.colorText}},[`${C}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${C}-dot`]:{position:"absolute",width:D,height:D,backgroundColor:c.colorBgElevated,border:`${mt(Z)} solid ${c.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${c.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:c.dotActiveBorderColor}},[`&${C}-disabled`]:{cursor:"not-allowed",[`${C}-rail`]:{backgroundColor:`${c.railBg} !important`},[`${C}-track`]:{backgroundColor:`${c.trackBgDisabled} !important`},[`
          ${C}-dot
        `]:{backgroundColor:c.colorBgElevated,borderColor:c.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${C}-handle::after`]:{backgroundColor:c.colorBgElevated,cursor:"not-allowed",width:$,height:$,boxShadow:`0 0 0 ${mt(Z)} ${Q}`,insetInlineStart:0,insetBlockStart:0},[`
          ${C}-mark-text,
          ${C}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${b}-tooltip-inner`]:{minWidth:"unset"}})}},Na=(c,C)=>{const{componentCls:b,railSize:B,handleSize:D,dotSize:G,marginFull:M,calc:V}=c,Q=C?"paddingBlock":"paddingInline",W=C?"width":"height",$=C?"height":"width",ee=C?"insetBlockStart":"insetInlineStart",te=C?"top":"insetInlineStart",X=V(B).mul(3).sub(D).div(2).equal(),Z=V(D).sub(B).div(2).equal(),J=C?{borderWidth:`${mt(Z)} 0`,transform:`translateY(${mt(V(Z).mul(-1).equal())})`}:{borderWidth:`0 ${mt(Z)}`,transform:`translateX(${mt(c.calc(Z).mul(-1).equal())})`};return{[Q]:B,[$]:V(B).mul(3).equal(),[`${b}-rail`]:{[W]:"100%",[$]:B},[`${b}-track,${b}-tracks`]:{[$]:B},[`${b}-track-draggable`]:Object.assign({},J),[`${b}-handle`]:{[ee]:X},[`${b}-mark`]:{insetInlineStart:0,top:0,[te]:V(B).mul(3).add(C?0:M).equal(),[W]:"100%"},[`${b}-step`]:{insetInlineStart:0,top:0,[te]:B,[W]:"100%",[$]:B},[`${b}-dot`]:{position:"absolute",[ee]:V(B).sub(G).div(2).equal()}}},Gu=c=>{const{componentCls:C,marginPartWithMark:b}=c;return{[`${C}-horizontal`]:Object.assign(Object.assign({},Na(c,!0)),{[`&${C}-with-marks`]:{marginBottom:b}})}},zu=c=>{const{componentCls:C}=c;return{[`${C}-vertical`]:Object.assign(Object.assign({},Na(c,!1)),{height:"100%"})}},$u=c=>{const b=c.controlHeightLG/4,B=c.controlHeightSM/2,D=c.lineWidth+1,G=c.lineWidth+1*1.5,M=c.colorPrimary,V=new gn(M).setA(.2).toRgbString();return{controlSize:b,railSize:4,handleSize:b,handleSizeHover:B,dotSize:8,handleLineWidth:D,handleLineWidthHover:G,railBg:c.colorFillTertiary,railHoverBg:c.colorFillSecondary,trackBg:c.colorPrimaryBorder,trackHoverBg:c.colorPrimaryBorderHover,handleColor:c.colorPrimaryBorder,handleActiveColor:M,handleActiveOutlineColor:V,handleColorDisabled:new gn(c.colorTextDisabled).onBackground(c.colorBgContainer).toHexString(),dotBorderColor:c.colorBorderSecondary,dotActiveBorderColor:c.colorPrimaryBorder,trackBgDisabled:c.colorBgContainerDisabled}},Uu=Pa("Slider",c=>{const C=Aa(c,{marginPart:c.calc(c.controlHeight).sub(c.controlSize).div(2).equal(),marginFull:c.calc(c.controlSize).div(2).equal(),marginPartWithMark:c.calc(c.controlHeightLG).sub(c.controlSize).equal()});return[Nu(C),Gu(C),zu(C)]},$u);function ln(){const[c,C]=A.useState(!1),b=A.useRef(null),B=()=>{Jr.cancel(b.current)},D=G=>{B(),G?C(G):b.current=Jr(()=>{C(G)})};return A.useEffect(()=>B,[]),[c,D]}var Vu=function(c,C){var b={};for(var B in c)Object.prototype.hasOwnProperty.call(c,B)&&C.indexOf(B)<0&&(b[B]=c[B]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,B=Object.getOwnPropertySymbols(c);D<B.length;D++)C.indexOf(B[D])<0&&Object.prototype.propertyIsEnumerable.call(c,B[D])&&(b[B[D]]=c[B[D]]);return b};function Hu(c,C){return c||c===null?c:C||C===null?C:b=>typeof b=="number"?b.toString():""}const ga=st.forwardRef((c,C)=>{const{prefixCls:b,range:B,className:D,rootClassName:G,style:M,disabled:V,tooltipPrefixCls:Q,tipFormatter:W,tooltipVisible:$,getTooltipPopupContainer:ee,tooltipPlacement:te,tooltip:X={},onChangeComplete:Z,classNames:J,styles:H}=c,U=Vu(c,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete","classNames","styles"]),{vertical:z}=c,{getPrefixCls:q,direction:ie,className:oe,style:he,classNames:ge,styles:xe,getPopupContainer:me}=Fa("slider"),pe=st.useContext(Cu),ce=V??pe,{handleRender:fe,direction:Ae}=st.useContext(ju),Se=(Ae||ie)==="rtl",[He,Be]=ln(),[Ge,Ke]=ln(),Te=Object.assign({},X),{open:Qe,placement:$e,getPopupContainer:Mt,prefixCls:et,formatter:we}=Te,ye=Qe??$,Re=(He||Ge)&&ye!==!1,Oe=Hu(we,W),[Ue,Fe]=ln(),Ye=De=>{Z?.(De),Fe(!1)},lt=(De,Xe)=>De||(Xe?Se?"left":"right":"top"),pt=q("slider",b),[_t,bt,Lt]=Uu(pt),kt=ot(D,oe,ge.root,J?.root,G,{[`${pt}-rtl`]:Se,[`${pt}-lock`]:Ue},bt,Lt);Se&&!U.vertical&&(U.reverse=!U.reverse),st.useEffect(()=>{const De=()=>{Jr(()=>{Ke(!1)},1)};return document.addEventListener("mouseup",De),()=>{document.removeEventListener("mouseup",De)}},[]);const ut=B&&!ye,tt=fe||((De,Xe)=>{const{index:Et}=Xe,xt=De.props;function ht(Ie,it,br){var Ft,Rt,er,cr;br&&((Rt=(Ft=U)[Ie])===null||Rt===void 0||Rt.call(Ft,it)),(cr=(er=xt)[Ie])===null||cr===void 0||cr.call(er,it)}const rt=Object.assign(Object.assign({},xt),{onMouseEnter:Ie=>{Be(!0),ht("onMouseEnter",Ie)},onMouseLeave:Ie=>{Be(!1),ht("onMouseLeave",Ie)},onMouseDown:Ie=>{Ke(!0),Fe(!0),ht("onMouseDown",Ie)},onFocus:Ie=>{var it;Ke(!0),(it=U.onFocus)===null||it===void 0||it.call(U,Ie),ht("onFocus",Ie,!0)},onBlur:Ie=>{var it;Ke(!1),(it=U.onBlur)===null||it===void 0||it.call(U,Ie),ht("onBlur",Ie,!0)}}),Bt=st.cloneElement(De,rt),Tt=(!!ye||Re)&&Oe!==null;return ut?Bt:st.createElement(pa,Object.assign({},Te,{prefixCls:q("tooltip",et??Q),title:Oe?Oe(Xe.value):"",value:Xe.value,open:Tt,placement:lt($e??te,z),key:Et,classNames:{root:`${pt}-tooltip`},getPopupContainer:Mt||ee||me}),Bt)}),Vt=ut?(De,Xe)=>{const Et=st.cloneElement(De,{style:Object.assign(Object.assign({},De.props.style),{visibility:"hidden"})});return st.createElement(pa,Object.assign({},Te,{prefixCls:q("tooltip",et??Q),title:Oe?Oe(Xe.value):"",open:Oe!==null&&Re,placement:lt($e??te,z),key:"tooltip",classNames:{root:`${pt}-tooltip`},getPopupContainer:Mt||ee||me,draggingDelete:Xe.draggingDelete}),Et)}:void 0,Ht=Object.assign(Object.assign(Object.assign(Object.assign({},xe.root),he),H?.root),M),At=Object.assign(Object.assign({},xe.tracks),H?.tracks),gt=ot(ge.tracks,J?.tracks);return _t(st.createElement(Iu,Object.assign({},U,{classNames:Object.assign({handle:ot(ge.handle,J?.handle),rail:ot(ge.rail,J?.rail),track:ot(ge.track,J?.track)},gt?{tracks:gt}:{}),styles:Object.assign({handle:Object.assign(Object.assign({},xe.handle),H?.handle),rail:Object.assign(Object.assign({},xe.rail),H?.rail),track:Object.assign(Object.assign({},xe.track),H?.track)},Object.keys(At).length?{tracks:At}:{}),step:U.step,range:B,className:kt,style:Ht,disabled:ce,ref:C,prefixCls:pt,handleRender:tt,activeHandleRender:Vt,onChangeComplete:Ye})))});function Ku(c,C,b){return typeof b=="boolean"?b:c.length?!0:bu(C).some(D=>D.type===Ca)}var Ga=function(c,C){var b={};for(var B in c)Object.prototype.hasOwnProperty.call(c,B)&&C.indexOf(B)<0&&(b[B]=c[B]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,B=Object.getOwnPropertySymbols(c);D<B.length;D++)C.indexOf(B[D])<0&&Object.prototype.propertyIsEnumerable.call(c,B[D])&&(b[B[D]]=c[B[D]]);return b};function Pi({suffixCls:c,tagName:C,displayName:b}){return B=>A.forwardRef((G,M)=>A.createElement(B,Object.assign({ref:M,suffixCls:c,tagName:C},G)))}const Cn=A.forwardRef((c,C)=>{const{prefixCls:b,suffixCls:B,className:D,tagName:G}=c,M=Ga(c,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:V}=A.useContext(Si),Q=V("layout",b),[W,$,ee]=ba(Q),te=B?`${Q}-${B}`:Q;return W(A.createElement(G,Object.assign({className:ot(b||te,D,$,ee),ref:C},M)))}),qu=A.forwardRef((c,C)=>{const{direction:b}=A.useContext(Si),[B,D]=A.useState([]),{prefixCls:G,className:M,rootClassName:V,children:Q,hasSider:W,tagName:$,style:ee}=c,te=Ga(c,["prefixCls","className","rootClassName","children","hasSider","tagName","style"]),X=Ra(te,["suffixCls"]),{getPrefixCls:Z,className:J,style:H}=Fa("layout"),U=Z("layout",G),z=Ku(B,Q,W),[q,ie,oe]=ba(U),he=ot(U,{[`${U}-has-sider`]:z,[`${U}-rtl`]:b==="rtl"},J,M,V,ie,oe),ge=A.useMemo(()=>({siderHook:{addSider:xe=>{D(me=>[].concat(Qt(me),[xe]))},removeSider:xe=>{D(me=>me.filter(pe=>pe!==xe))}}}),[]);return q(A.createElement(Sl.Provider,{value:ge},A.createElement($,Object.assign({ref:C,className:he,style:Object.assign(Object.assign({},H),ee)},X),Q)))}),Yu=Pi({tagName:"div",displayName:"Layout"})(qu),Xu=Pi({suffixCls:"header",tagName:"header",displayName:"Header"})(Cn),Zu=Pi({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(Cn),Ju=Pi({suffixCls:"content",tagName:"main",displayName:"Content"})(Cn),ar=Yu;ar.Header=Xu;ar.Footer=Zu;ar.Content=Ju;ar.Sider=Ca;ar._InternalSiderContext=Pl;const Wu=c=>{const{paddingXXS:C,lineWidth:b,tagPaddingHorizontal:B,componentCls:D,calc:G}=c,M=G(B).sub(b).equal(),V=G(C).sub(b).equal();return{[D]:Object.assign(Object.assign({},Ta(c)),{display:"inline-block",height:"auto",marginInlineEnd:c.marginXS,paddingInline:M,fontSize:c.tagFontSize,lineHeight:c.tagLineHeight,whiteSpace:"nowrap",background:c.defaultBg,border:`${mt(c.lineWidth)} ${c.lineType} ${c.colorBorder}`,borderRadius:c.borderRadiusSM,opacity:1,transition:`all ${c.motionDurationMid}`,textAlign:"start",position:"relative",[`&${D}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:c.defaultColor},[`${D}-close-icon`]:{marginInlineStart:V,fontSize:c.tagIconSize,color:c.colorIcon,cursor:"pointer",transition:`all ${c.motionDurationMid}`,"&:hover":{color:c.colorTextHeading}},[`&${D}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${c.iconCls}-close, ${c.iconCls}-close:hover`]:{color:c.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${D}-checkable-checked):hover`]:{color:c.colorPrimary,backgroundColor:c.colorFillSecondary},"&:active, &-checked":{color:c.colorTextLightSolid},"&-checked":{backgroundColor:c.colorPrimary,"&:hover":{backgroundColor:c.colorPrimaryHover}},"&:active":{backgroundColor:c.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${c.iconCls} + span, > span + ${c.iconCls}`]:{marginInlineStart:M}}),[`${D}-borderless`]:{borderColor:"transparent",background:c.tagBorderlessBg}}},bn=c=>{const{lineWidth:C,fontSizeIcon:b,calc:B}=c,D=c.fontSizeSM;return Aa(c,{tagFontSize:D,tagLineHeight:mt(B(c.lineHeightSM).mul(D).equal()),tagIconSize:B(b).sub(B(C).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:c.defaultBg})},Ln=c=>({defaultBg:new gn(c.colorFillQuaternary).onBackground(c.colorBgContainer).toHexString(),defaultColor:c.colorText}),za=Pa("Tag",c=>{const C=bn(c);return Wu(C)},Ln);var Qu=function(c,C){var b={};for(var B in c)Object.prototype.hasOwnProperty.call(c,B)&&C.indexOf(B)<0&&(b[B]=c[B]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,B=Object.getOwnPropertySymbols(c);D<B.length;D++)C.indexOf(B[D])<0&&Object.prototype.propertyIsEnumerable.call(c,B[D])&&(b[B[D]]=c[B[D]]);return b};const eh=A.forwardRef((c,C)=>{const{prefixCls:b,style:B,className:D,checked:G,children:M,icon:V,onChange:Q,onClick:W}=c,$=Qu(c,["prefixCls","style","className","checked","children","icon","onChange","onClick"]),{getPrefixCls:ee,tag:te}=A.useContext(Si),X=q=>{Q?.(!G),W?.(q)},Z=ee("tag",b),[J,H,U]=za(Z),z=ot(Z,`${Z}-checkable`,{[`${Z}-checkable-checked`]:G},te?.className,D,H,U);return J(A.createElement("span",Object.assign({},$,{ref:C,style:Object.assign(Object.assign({},B),te?.style),className:z,onClick:X}),V,A.createElement("span",null,M)))}),th=c=>Al(c,(C,{textColor:b,lightBorderColor:B,lightColor:D,darkColor:G})=>({[`${c.componentCls}${c.componentCls}-${C}`]:{color:b,background:D,borderColor:B,"&-inverse":{color:c.colorTextLightSolid,background:G,borderColor:G},[`&${c.componentCls}-borderless`]:{borderColor:"transparent"}}})),rh=Oa(["Tag","preset"],c=>{const C=bn(c);return th(C)},Ln);function ih(c){return typeof c!="string"?c:c.charAt(0).toUpperCase()+c.slice(1)}const Bi=(c,C,b)=>{const B=ih(b);return{[`${c.componentCls}${c.componentCls}-${C}`]:{color:c[`color${b}`],background:c[`color${B}Bg`],borderColor:c[`color${B}Border`],[`&${c.componentCls}-borderless`]:{borderColor:"transparent"}}}},nh=Oa(["Tag","status"],c=>{const C=bn(c);return[Bi(C,"success","Success"),Bi(C,"processing","Info"),Bi(C,"error","Error"),Bi(C,"warning","Warning")]},Ln);var ah=function(c,C){var b={};for(var B in c)Object.prototype.hasOwnProperty.call(c,B)&&C.indexOf(B)<0&&(b[B]=c[B]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,B=Object.getOwnPropertySymbols(c);D<B.length;D++)C.indexOf(B[D])<0&&Object.prototype.propertyIsEnumerable.call(c,B[D])&&(b[B[D]]=c[B[D]]);return b};const sh=A.forwardRef((c,C)=>{const{prefixCls:b,className:B,rootClassName:D,style:G,children:M,icon:V,color:Q,onClose:W,bordered:$=!0,visible:ee}=c,te=ah(c,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:X,direction:Z,tag:J}=A.useContext(Si),[H,U]=A.useState(!0),z=Ra(te,["closeIcon","closable"]);A.useEffect(()=>{ee!==void 0&&U(ee)},[ee]);const q=Tl(Q),ie=Fl(Q),oe=q||ie,he=Object.assign(Object.assign({backgroundColor:Q&&!oe?Q:void 0},J?.style),G),ge=X("tag",b),[xe,me,pe]=za(ge),ce=ot(ge,J?.className,{[`${ge}-${Q}`]:oe,[`${ge}-has-color`]:Q&&!oe,[`${ge}-hidden`]:!H,[`${ge}-rtl`]:Z==="rtl",[`${ge}-borderless`]:!$},B,D,me,pe),fe=Ge=>{Ge.stopPropagation(),W?.(Ge),!Ge.defaultPrevented&&U(!1)},[,Ae]=Rl(aa(c),aa(J),{closable:!1,closeIconRender:Ge=>{const Ke=A.createElement("span",{className:`${ge}-close-icon`,onClick:fe},Ge);return Lu(Ge,Ke,Te=>({onClick:Qe=>{var $e;($e=Te?.onClick)===null||$e===void 0||$e.call(Te,Qe),fe(Qe)},className:ot(Te?.className,`${ge}-close-icon`)}))}}),ze=typeof te.onClick=="function"||M&&M.type==="a",Se=V||null,He=Se?A.createElement(A.Fragment,null,Se,M&&A.createElement("span",null,M)):M,Be=A.createElement("span",Object.assign({},z,{ref:C,className:ce,style:he}),He,Ae,q&&A.createElement(rh,{key:"preset",prefixCls:ge}),ie&&A.createElement(nh,{key:"status",prefixCls:ge}));return xe(ze?A.createElement(ku,{component:"Tag"},Be):Be)}),$a=sh;$a.CheckableTag=eh;var oh={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},lh=function(C,b){return A.createElement(yn,Ar({},C,{ref:b,icon:oh}))},uh=A.forwardRef(lh),hh={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"},ch=function(C,b){return A.createElement(yn,Ar({},C,{ref:b,icon:hh}))},dh=A.forwardRef(ch),ph={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"},gh=function(C,b){return A.createElement(yn,Ar({},C,{ref:b,icon:ph}))},fh=A.forwardRef(gh);const mh=jl(function({children:C,...b},B){const D=new La.Control.Layers(void 0,void 0,b);return Nl(D,ka(B,{layersControl:D}))},function(C,b,B){b.collapsed!==B.collapsed&&(b.collapsed===!0?C.collapse():C.expand())}),_h=Il(mh),kn=Ol(_h);function Ua(c){return function(b){const B=Gl(),D=A.useRef(b),[G,M]=A.useState(null),{layersControl:V,map:Q}=B,W=A.useCallback(te=>{V!=null&&(D.current.checked&&Q.addLayer(te),c(V,te,D.current.name),M(te))},[c,V,Q]),$=A.useCallback(te=>{V?.removeLayer(te),M(null)},[V]),ee=A.useMemo(()=>ka(B,{layerContainer:{addLayer:W,removeLayer:$}}),[B,W,$]);return A.useEffect(()=>{G!==null&&D.current!==b&&(b.checked===!0&&(D.current.checked==null||D.current.checked===!1)?Q.addLayer(G):D.current.checked===!0&&(b.checked==null||b.checked===!1)&&Q.removeLayer(G),D.current=b)}),b.children?st.createElement(zl,{value:ee},b.children):null}}kn.BaseLayer=Ua(function(C,b,B){C.addBaseLayer(b,B)});kn.Overlay=Ua(function(C,b,B){C.addOverlay(b,B)});const yh=$l(function(C){return new La.Control.Zoom(C)}),vh=[{key:"openstreetmap",label:"OSM",title:"OpenStreetMap"},{key:"google_satellite",label:"Google",title:"Google Satellite"},{key:"esri_satellite",label:"ESRI Satellite",title:"ESRI Satellite"},{key:"carto",label:"Carto",title:"Carto Voyager"},{key:"open_topo_map",label:"Topo",title:"Open Topo Map"},{key:"carto_dark",label:"Dark",title:"Carto Dark"}];function Ch(){const c=Tr(),C=qe(b=>b.map?.activeBasemap)||"openstreetmap";return N.jsxs(N.Fragment,{children:[N.jsx(Ul,{}),N.jsx("div",{style:{position:"absolute",top:8,left:8,zIndex:1200,display:"flex",flexDirection:"column",gap:6,padding:6,borderRadius:6,background:"rgba(255,255,255,0.9)",boxShadow:"0 1px 6px rgba(0,0,0,0.15)",textAlign:"start"},children:vh.map(b=>N.jsx(Sr,{title:b.title,children:N.jsx(nr,{size:"small",type:b.key===C?"primary":"default",onClick:()=>c(ml(b.key)),style:{display:"flex",alignItems:"center",justifyContent:"start"},children:b.label})},b.key))})]})}/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=[["path",{d:"m12.99 6.74 1.93 3.44",key:"iwagvd"}],["path",{d:"M19.136 12a10 10 0 0 1-14.271 0",key:"ppmlo4"}],["path",{d:"m21 21-2.16-3.84",key:"vylbct"}],["path",{d:"m3 21 8.02-14.26",key:"1ssaw4"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}]],Lh=Fr("drafting-compass",bh);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],xh=Fr("eraser",kh);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],fa=Fr("info",Mh);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Bh=Fr("printer",Eh);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"M12 9v11",key:"1fnkrn"}],["path",{d:"M2 9h13a2 2 0 0 1 2 2v9",key:"11z3ex"}]],Dh=Fr("proportions",wh);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=[["path",{d:"M15 3v18",key:"14nvp0"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]],Ph=Fr("table-properties",Sh);function Ah(){const c=Tr(),C=qe(B=>B.ui.isAttributeTableOpen),b=A.useCallback(()=>{c(cn())},[c]);return N.jsx(xa,{title:"Attribute Table",placement:"bottom",onClose:b,open:C,height:"40vh",mask:!1,minimized:!0,children:C&&N.jsx(Ma,{csvDownloader:!0,clearDataOnTabChange:!0,clearDataOnClose:!0,defaultSelectAll:!1})})}function Th(){const c=Tr(),C=qe(b=>b.ui.isBufferOpen);return N.jsx(xa,{title:"Buffer Tool",placement:"bottom",onClose:()=>c(dn()),open:C,height:"45vh",getContainer:!1,mask:!1,afterOpenChange:b=>{},minimized:!0,children:N.jsxs(_n,{gutter:12,style:{height:"100%"},children:[N.jsx(Pr,{xs:24,sm:10,md:8,lg:7,style:{minWidth:260,height:"100%"},children:N.jsx(pn,{size:"small",style:{height:"100%"},styles:{body:{height:"100%",padding:12,overflow:"auto"}},children:C&&N.jsx(Vl,{open:C,clearDataOnClose:!0})})}),N.jsx(Pr,{xs:24,sm:14,md:16,lg:17,style:{minWidth:320,height:"100%"},children:N.jsx(pn,{size:"small",style:{height:"100%"},styles:{body:{height:"100%",padding:12,overflow:"auto"}},children:C&&N.jsx(Ma,{csvDownloader:!1,clearDataOnTabChange:!0,clearDataOnClose:!0,defaultSelectAll:!0})})})]})})}const Va=A.memo(({portalDetails:c})=>N.jsxs("div",{className:"top-location-card",children:[N.jsx("div",{className:"loc-icon",children:N.jsx("img",{src:Hl(c?.portal_logo_img_url),alt:"Location Logo",loading:"lazy"})}),N.jsxs("div",{className:"loc-text",children:[N.jsx("div",{className:"loc-title",children:c?.portal_nm}),N.jsx("div",{className:"loc-sub",children:c?.portal_desc})]})]}));Va.displayName="TopLocationCard";const{Option:ma}=Ea,Fh=A.memo(({filters:c,setFilters:C})=>{const b=A.useCallback((q,ie)=>{C(oe=>({...oe,[q]:ie}))},[C]),{measureBy:B,areaSubdivision:D,excludePostal:G,ageRange:M,residentsOnly:V,gender:Q,income:W}=c,$=A.useCallback(q=>b("measureBy",q),[b]),ee=A.useCallback(q=>b("areaSubdivision",q),[b]),te=A.useCallback(q=>b("ageRange",q),[b]),X=A.useCallback(q=>b("residentsOnly",q.target.value==="residents"),[b]),Z=A.useCallback(q=>b("gender",q),[b]),J=A.useCallback(q=>b("income",q),[b]),H=A.useCallback(q=>{b("excludePostal",G.filter(ie=>ie!==q))},[G,b]),U=A.useMemo(()=>G.map(q=>N.jsx($a,{closable:!0,onClose:()=>H(q),children:q},q)),[G,H]),z=A.useMemo(()=>["all","male","female"].map(q=>N.jsx(nr,{type:Q===q?"primary":"default",onClick:()=>Z(q),children:q.charAt(0).toUpperCase()+q.slice(1)},q)),[Q,Z]);return N.jsxs(N.Fragment,{children:[N.jsxs("div",{className:"measure-row",children:[N.jsx("div",{className:"measure-label",children:"Measured at"}),N.jsxs(vr,{children:[N.jsx(nr,{size:"small",type:B==="visits"?"primary":"default",onClick:()=>$("visits"),children:"Visits"}),N.jsx(nr,{size:"small",type:B==="visitors"?"primary":"default",onClick:()=>$("visitors"),children:"Visitors"})]})]}),N.jsxs("div",{className:"field",children:[N.jsx("label",{children:"Area subdivisions"}),N.jsxs(Ea,{value:D,onChange:ee,style:{width:"100%"},children:[N.jsx(ma,{value:"postal",children:"Postal codes"}),N.jsx(ma,{value:"district",children:"Districts"})]})]}),N.jsxs("div",{className:"field",children:[N.jsx("label",{children:"Exclude postal codes"}),N.jsx(Ia,{prefix:N.jsx(ja,{}),placeholder:"Postal code number"}),N.jsx("div",{className:"tag-row",children:U})]}),N.jsxs("div",{className:"field",children:[N.jsx("label",{children:"Age group"}),N.jsx(ga,{range:!0,min:0,max:100,value:M,onChange:te})]}),N.jsxs("div",{className:"field small-row",children:[N.jsx("label",{children:"Consider POI visitors"}),N.jsxs(sn.Group,{value:V?"residents":"all",onChange:X,children:[N.jsx(sn,{value:"residents",children:"Residents"}),N.jsx(sn,{value:"all",children:"All"})]}),N.jsx(Sr,{title:"Inclusion of locals, guests, workers",children:N.jsx("span",{className:"info-dot",children:"i"})})]}),N.jsxs("div",{className:"field",children:[N.jsx("label",{children:"Gender"}),N.jsx(vr,{children:z})]}),N.jsxs("div",{className:"field",children:[N.jsx("label",{children:"Household income"}),N.jsx(ga,{range:!0,min:0,max:1e4,value:W,onChange:J})]}),N.jsxs("div",{className:"controls-actions",children:[N.jsx(nr,{type:"primary",children:"Apply"}),N.jsx(nr,{children:"Clear"})]})]})});Fh.displayName="FiltersPanel";const Rh=_l.injectEndpoints({endpoints:c=>({getLayers:c.mutation({query:C=>({url:"layers/list/",method:"POST",body:{portal_id:C}}),transformResponse:C=>C,invalidatesTags:["Layer"]}),getLayerObjects:c.mutation({query:({layerId:C,portalId:b})=>({url:"object/layer-object/",method:"POST",body:{layer_id:C,portal_id:b}}),transformResponse:C=>C,invalidatesTags:(C,b,B)=>[{type:"Layer",id:B}]})}),overrideExisting:!1}),{useGetLayersMutation:Oh,useGetLayerObjectsMutation:Ih}=Rh,{Text:un}=Yl,Ha=A.memo(({option:c,disabled:C})=>N.jsx(wa,{value:c.value,disabled:C,style:{width:"100%"},children:N.jsxs(vr,{style:{width:"100%",justifyContent:"space-between"},children:[N.jsxs(vr,{children:[N.jsx(Xl,{iconInfo:c?.styleInfo}),N.jsx("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:c.label})]}),N.jsx(vr,{size:"small",children:C&&N.jsx(Ba,{size:"small"})})]})}));Ha.displayName="LayerCheckbox";const Ka=A.memo(({layers:c=[]})=>{const C=Tr(),{portalId:b}=qe(U=>U.portal),B=qe(U=>U.ui.loadingMessage),[D,G]=A.useState({checkedLayers:[],loadingLayers:new Set,pendingRequests:new Map}),[M]=Ih(),V=qe(U=>U.map.geoJsonLayers||{}),[Q,W]=A.useState(""),$=A.useMemo(()=>{const U=c.filter(ie=>ie?.layer_order_no==="0");return[...c.filter(ie=>ie?.layer_order_no!=="0").sort((ie,oe)=>{const he=Number(ie.layer_order_no),ge=Number(oe.layer_order_no);return he-ge}),...U]?.map((ie,oe)=>({label:ie.layer_mst.layer_nm,value:ie.layer_mst.layer_id,styleInfo:{geom_typ:ie.geomStyle_mst.geom_typ,fill_color:ie.geomStyle_mst.fill_color,stroke_color:ie.geomStyle_mst.stroke_color,marker_fa_icon_name:ie.geomStyle_mst.marker_fa_icon_name,marker_color:ie.geomStyle_mst.marker_color,marker_size:ie.geomStyle_mst.marker_size,marker_img_url:ie.geomStyle_mst.marker_img_url},orderNo:oe.toString()}))||[]},[c]),ee=A.useMemo(()=>{const U=(Q||"").trim().toLowerCase();return U?$.filter(z=>(z.label||"").toLowerCase().includes(U)):$},[$,Q]);A.useEffect(()=>{if(!$?.length)return;const U=$.map(z=>z.value).filter(z=>!!V[z]);G(z=>({...z,checkedLayers:U}))},[$,V]);const te=A.useCallback((U,z,q,ie,oe)=>{C(yl({layerId:U,geoJsonData:z,metaData:q,isActive:ie,orderNo:oe}))},[C]),X=A.useCallback(async U=>{G(z=>({...z,loadingLayers:new Set([...z.loadingLayers,U])}));try{const z=await M({layerId:U,portalId:b}).unwrap(),q=z?.metaData||{},ie=$.find(oe=>oe.value===U)?.orderNo||"0";te(U,z.geojson,q,!0,ie),G(oe=>{const he=new Set(oe.loadingLayers);return he.delete(U),{...oe,loadingLayers:he}})}catch(z){z?.name!=="AbortError"&&console.error(`Error fetching layer ${U}:`,z),G(q=>{const ie=new Set(q.loadingLayers);return ie.delete(U),{...q,loadingLayers:ie}})}},[M,te,b,$]),Z=A.useCallback(async U=>{const z=new Set(D.checkedLayers),q=new Set(U),ie=U.filter(he=>!z.has(he)&&!V[he]),oe=[...z].filter(he=>!q.has(he));G(he=>({...he,checkedLayers:U})),ie.forEach(X),oe.forEach(he=>{te(he,null,{},!1,"0")})},[D.checkedLayers,X,te,V]);A.useEffect(()=>{(async()=>{if(!$?.length)return;const z=$.filter(q=>c.find(oe=>oe.layer_mst.layer_id===q.value)?.default_view_flg==="Y");if(z.length){C(ia("Loading default layers..."));try{const q=z.map(ie=>X(ie.value));await Promise.allSettled(q),G(ie=>({...ie,checkedLayers:[...ie.checkedLayers,...z.map(oe=>oe.value)]}))}catch(q){console.error("Error loading default layers:",q)}finally{C(ia(null))}}})()},[$,c,C,X,b]),A.useCallback(()=>{const U=ee.map(q=>q.value),z=new Set(D.checkedLayers||[]);U.forEach(q=>z.add(q)),Z(Array.from(z))},[ee,D.checkedLayers,Z]);const J=A.useCallback(()=>{const U=new Set(ee.map(q=>q.value)),z=(D.checkedLayers||[]).filter(q=>!U.has(q));Z(z)},[ee,D.checkedLayers,Z]),H=(D.checkedLayers||[]).length;return N.jsxs(pn,{size:"small",variant:!1,styles:{body:{padding:12}},style:{width:"100%"},title:N.jsxs(_n,{align:"middle",justify:"space-between",style:{gap:8},children:[N.jsxs(Pr,{children:[N.jsx(un,{strong:!0,style:{fontSize:16},children:"Layers"}),N.jsxs("div",{style:{fontSize:12,color:"var(--muted, rgba(0,0,0,0.45))"},children:[N.jsxs(un,{type:"secondary",style:{marginRight:8},children:[H," active"]}),N.jsxs(un,{type:"secondary",children:[$.length," available"]})]})]}),N.jsx(Pr,{children:N.jsx(vr,{children:N.jsx(Sr,{title:"Deselect visible",children:N.jsx(nr,{type:"text",size:"small",icon:N.jsx(uh,{}),onClick:J})})})})]}),children:[B&&N.jsx(Kl,{title:"Loading",open:!!B,footer:null,closable:!1,children:N.jsxs(vr,{children:[N.jsx(Ba,{}),N.jsx("span",{children:B})]})}),N.jsx(Ia,{prefix:N.jsx(ja,{}),placeholder:"Search layers...",allowClear:!0,size:"middle",onChange:U=>W(U.target.value),value:Q,style:{marginBottom:8}}),N.jsx(ql,{style:{margin:"8px 0"}}),N.jsx(wa.Group,{onChange:Z,value:D.checkedLayers,style:{width:"100%"},children:ee.length===0?N.jsx(sa,{image:sa.PRESENTED_IMAGE_SIMPLE,description:"No layers"}):N.jsx(oa,{size:"small",dataSource:ee,split:!1,renderItem:U=>{const z=D.loadingLayers.has(U.value);return N.jsx(oa.Item,{style:{padding:"6px 0"},children:N.jsx(Ha,{option:U,disabled:z})},U.value)},style:{overflow:"auto"}})})]})});Ka.displayName="LayerPanel";const qa=A.memo(({})=>{const c=Tr(),{portalId:C}=qe(V=>V.portal),[b,{data:B,isLoading:D,error:G}]=Oh(),M=async V=>{try{const W=(await b(V).unwrap())?.portalDetails;c(Cl(W))}catch(Q){console.error("Failed to fetch layers: ",Q)}};return A.useEffect(()=>{C&&M(C)},[C]),A.useEffect(()=>{const V=B?.portalDetails?.max_zoom;typeof V=="number"&&c(vl({zoom:V}))},[B,c]),D?N.jsx("div",{children:"Loading layers..."}):G?N.jsxs("div",{children:["Error loading layers: ",G.message]}):N.jsxs("div",{className:"sider-inner",children:[N.jsx(Va,{portalDetails:B?.portalDetails}),N.jsx(Ka,{layers:B?.layers})]})});qa.displayName="Sidebar";var hn={exports:{}},_a;function jh(){return _a||(_a=1,(function(c,C){(function(b,B){c.exports=b(Zl()),typeof B<"u"&&B.L&&(B.L.Control.MiniMap=b(L),B.L.control.minimap=function(D,G){return new B.L.Control.MiniMap(D,G)})})(function(b){var B=b.Control.extend({includes:b.Evented?b.Evented.prototype:b.Mixin.Events,options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,centerFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,minimized:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"},mapOptions:{}},initialize:function(D,G){b.Util.setOptions(this,G),this.options.aimingRectOptions.clickable=!1,this.options.shadowRectOptions.clickable=!1,this._layer=D},onAdd:function(D){this._mainMap=D,this._container=b.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",b.DomEvent.disableClickPropagation(this._container),b.DomEvent.on(this._container,"mousewheel",b.DomEvent.stopPropagation);var G={attributionControl:!1,dragging:!this.options.centerFixed,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),scrollWheelZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),doubleClickZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:D.options.crs};return G=b.Util.extend(this.options.mapOptions,G),this._miniMap=new b.Map(this._container,G),this._miniMap.addLayer(this._layer),this._mainMapMoving=!1,this._miniMapMoving=!1,this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._miniMap.whenReady(b.Util.bind(function(){this._aimingRect=b.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap),this._shadowRect=b.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._miniMap.on("movestart",this._onMiniMapMoveStarted,this),this._miniMap.on("move",this._onMiniMapMoving,this),this._miniMap.on("moveend",this._onMiniMapMoved,this)},this)),this._container},addTo:function(D){b.Control.prototype.addTo.call(this,D);var G=this.options.centerFixed||this._mainMap.getCenter();return this._miniMap.setView(G,this._decideZoom(!0)),this._setDisplay(this.options.minimized),this},onRemove:function(D){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._miniMap.off("moveend",this._onMiniMapMoved,this),this._miniMap.removeLayer(this._layer)},changeLayer:function(D){this._miniMap.removeLayer(this._layer),this._layer=D,this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._createButton("",this._toggleButtonInitialTitleText(),"leaflet-control-minimap-toggle-display leaflet-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_toggleButtonInitialTitleText:function(){return this.options.minimized?this.options.strings.showText:this.options.strings.hideText},_createButton:function(D,G,M,V,Q,W){var $=b.DomUtil.create("a",M,V);$.innerHTML=D,$.href="#",$.title=G;var ee=b.DomEvent.stopPropagation;return b.DomEvent.on($,"click",ee).on($,"mousedown",ee).on($,"dblclick",ee).on($,"click",b.DomEvent.preventDefault).on($,"click",Q,W),$},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?this._restore():this._minimize()},_setDisplay:function(D){D!==this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position,this._toggleDisplayButton.title=this.options.strings.showText):this._container.style.display="none",this._minimized=!0,this._onToggle()},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,""),this._toggleDisplayButton.title=this.options.strings.hideText):this._container.style.display="block",this._minimized=!1,this._onToggle()},_onMainMapMoved:function(D){if(this._miniMapMoving)this._miniMapMoving=!1;else{var G=this.options.centerFixed||this._mainMap.getCenter();this._mainMapMoving=!0,this._miniMap.setView(G,this._decideZoom(!0)),this._setDisplay(this._decideMinimized())}this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(D){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(D){if(!this.options.centerFixed){var G=this._aimingRect.getBounds(),M=this._miniMap.latLngToContainerPoint(G.getSouthWest()),V=this._miniMap.latLngToContainerPoint(G.getNorthEast());this._lastAimingRectPosition={sw:M,ne:V}}},_onMiniMapMoving:function(D){this.options.centerFixed||!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new b.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onMiniMapMoved:function(D){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var D=this.options.zoomLevelFixed;return this._isDefined(D)&&this._isInteger(D)},_decideZoom:function(D){if(this._isZoomLevelFixed())return D?this.options.zoomLevelFixed:this._mainMap.getZoom();if(D)return this._mainMap.getZoom()+this.options.zoomLevelOffset;var G=this._miniMap.getZoom()-this._mainMap.getZoom(),M=this._miniMap.getZoom()-this.options.zoomLevelOffset,V;return G>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(V=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):V=this._mainMap.getZoom():V=M,this._lastMiniMapZoom=this._miniMap.getZoom(),V},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?!!this._mainMap.getBounds().contains(this._miniMap.getBounds()):this._minimized},_isInteger:function(D){return typeof D=="number"},_isDefined:function(D){return typeof D<"u"},_onToggle:function(){b.Util.requestAnimFrame(function(){b.DomEvent.on(this._container,"transitionend",this._fireToggleEvents,this),b.Browser.any3d||b.Util.requestAnimFrame(this._fireToggleEvents,this)},this)},_fireToggleEvents:function(){b.DomEvent.off(this._container,"transitionend",this._fireToggleEvents,this);var D={minimized:this._minimized};this.fire(this._minimized?"minimize":"restore",D),this.fire("toggle",D)}});return b.Map.mergeOptions({miniMapControl:!1}),b.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=new B().addTo(this))}),B},window)})(hn)),hn.exports}jh();function Nh(){const c=Da();return A.useEffect(()=>{const C=new Zr.TileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{minZoom:0,maxZoom:20,attribution:"Tiles  Esri"}),b=new Zr.Control.MiniMap(C,{toggleDisplay:!0,minimized:!1,position:"bottomleft",width:150,height:150,zoomLevelOffset:-5,aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0}});return b.addTo(c),()=>{c.removeControl(b)}},[c]),null}const{BaseLayer:Qh}=kn;function Gh(){const c=Da();return A.useEffect(()=>{if(!c.pm){console.error("Geoman not available on map instance");return}return c.pm.addControls({position:"topright",drawMarker:!0,drawCircle:!0,drawPolyline:!0,drawRectangle:!0,drawPolygon:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0}),()=>{c.pm.removeControls()}},[c]),null}const Ya=()=>{const c=qe($=>$.map.selectedFeature.feature),C=qe($=>$.map.selectedFeature.metaData),b=qe($=>$.map.multiSelectedFeatures||[]),B=A.useCallback(($,ee)=>Zr.circleMarker(ee,Jl),[]),D=A.useCallback(($,ee)=>Zr.circleMarker(ee,Wl),[]),G=A.useCallback(($,ee)=>{if($.properties){const te="Tooltip",X=$.geometry?.type?.toLowerCase();let Z=null;if(X==="point"&&$.geometry?.coordinates){const[J,H]=$.geometry.coordinates;Z=Zr.latLng(H,J)}Ql(ee,$.properties,te,Z,X)}},[C]),M=c&&c.length>0,V=b&&b.length>0,Q=A.useMemo(()=>`selected-single-${C?.selectedKeys}`,[C]),W=A.useMemo(()=>`selected-multi-${b.length}`,[b.length]);return N.jsxs(N.Fragment,{children:[M&&N.jsx(la,{data:{type:"FeatureCollection",features:c},style:eu,pointToLayer:B,onEachFeature:G,interactive:!1,pane:"pane-selected-features"},Q),V&&N.jsx(la,{data:{type:"FeatureCollection",features:b.map($=>$.feature)},style:tu,pointToLayer:D,onEachFeature:G,interactive:!1,pane:"pane-selected-features"},W)]})};Ya.displayName="SelectedFeaturesLayer";const zh=A.memo(Ya),Xa=A.memo(()=>{const c=qe(X=>X.map.geoJsonLayers),C=qe(X=>X.map.viewport),b=qe(X=>X.ui.isLegendVisible),B=qe(X=>X.ui.isPrintModalOpen),D=qe(X=>X.map.bufferLayers),G=qe(X=>X.map.bufferOrder),M=A.useMemo(()=>Object.entries(c||{}).filter(([,X])=>X?.geoJsonData).map(([X,Z])=>({layerId:X,orderNo:Number(Z.orderNo||0),data:Z})).sort((X,Z)=>Z.orderNo-X.orderNo||Z.layerId.localeCompare(X.layerId)),[c]),V=A.useMemo(()=>(Array.isArray(G)?G:Object.keys(D||{})).filter(Z=>D&&D[Z]&&D[Z].geoJsonData).map(Z=>({layerId:Z,data:D[Z]})),[D,G]),Q=A.useMemo(()=>{const X=Yr.OVERLAY_BASE;return M.map((Z,J)=>({name:`pane-layer-${Z.layerId}`,zIndex:X+J}))},[M]),W=A.useMemo(()=>{const X=Yr.OVERLAY_BASE,Z=Math.max(201,X-1e3),J=typeof Yr.BUFFER_BASE=="number"?Yr.BUFFER_BASE:Z;return V.map((H,U)=>({name:`pane-buffer-${H.layerId}`,zIndex:J+U}))},[V]),$=A.useMemo(()=>V.map(({layerId:X,data:Z},J)=>{const H=`pane-buffer-${X}`;return N.jsx(ru,{layerId:X,geoJsonData:Z.geoJsonData,metaData:Z.metaData,pane:H},X)}),[V]),ee=A.useMemo(()=>M.map(({layerId:X,data:Z},J)=>{const H=`pane-layer-${X}`;return N.jsx(iu,{layerId:X,geoJsonData:Z.geoJsonData,metaData:Z.metaData,pane:H},X)}),[M]),te=A.useMemo(()=>({center:C?.center||[28.7041,77.1025],zoom:C?.zoom||8,style:{width:"100%",height:"100%"},zoomControl:!1}),[C]);return N.jsx("div",{className:"map-panel",children:N.jsxs(nu,{...te,children:[N.jsx(yh,{position:"topright"}),N.jsx(au,{position:"bottomright",imperial:!0,metric:!0,maxWidth:200,updateWhenIdle:!0}),N.jsx(Ch,{}),N.jsx(su,{geoJsonLayers:c}),N.jsx(on,{panes:W}),$,N.jsx(on,{panes:Q}),ee,N.jsx(on,{panes:[{name:"pane-selected-features",zIndex:Yr.SELECTED_FEATURES}]}),N.jsx(zh,{}),N.jsx(Gh,{}),N.jsx(Nh,{}),N.jsx(ou,{visible:b}),N.jsx(Ah,{}),N.jsx(lu,{}),B&&N.jsx(uu,{}),N.jsx(Th,{})]})})});Xa.displayName="MapPanel";var ya={},va;function $h(){return va||(va=1,(()=>{var c=Object.create,C=Object.defineProperty,b=Object.getOwnPropertyDescriptor,B=Object.getOwnPropertyNames,D=Object.getPrototypeOf,G=Object.prototype.hasOwnProperty,M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),V=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of B(t))!G.call(e,n)&&n!==r&&C(e,n,{get:()=>t[n],enumerable:!(i=b(t,n))||i.enumerable});return e},Q=(e,t,r)=>(r=e!=null?c(D(e)):{},V(t||!e||!e.__esModule?C(r,"default",{value:e,enumerable:!0}):r,e)),W=M((e,t)=>{function r(){this.__data__=[],this.size=0}t.exports=r}),$=M((e,t)=>{function r(i,n){return i===n||i!==i&&n!==n}t.exports=r}),ee=M((e,t)=>{var r=$();function i(n,a){for(var s=n.length;s--;)if(r(n[s][0],a))return s;return-1}t.exports=i}),te=M((e,t)=>{var r=ee(),i=Array.prototype,n=i.splice;function a(s){var o=this.__data__,u=r(o,s);if(u<0)return!1;var h=o.length-1;return u==h?o.pop():n.call(o,u,1),--this.size,!0}t.exports=a}),X=M((e,t)=>{var r=ee();function i(n){var a=this.__data__,s=r(a,n);return s<0?void 0:a[s][1]}t.exports=i}),Z=M((e,t)=>{var r=ee();function i(n){return r(this.__data__,n)>-1}t.exports=i}),J=M((e,t)=>{var r=ee();function i(n,a){var s=this.__data__,o=r(s,n);return o<0?(++this.size,s.push([n,a])):s[o][1]=a,this}t.exports=i}),H=M((e,t)=>{var r=W(),i=te(),n=X(),a=Z(),s=J();function o(u){var h=-1,v=u==null?0:u.length;for(this.clear();++h<v;){var _=u[h];this.set(_[0],_[1])}}o.prototype.clear=r,o.prototype.delete=i,o.prototype.get=n,o.prototype.has=a,o.prototype.set=s,t.exports=o}),U=M((e,t)=>{var r=H();function i(){this.__data__=new r,this.size=0}t.exports=i}),z=M((e,t)=>{function r(i){var n=this.__data__,a=n.delete(i);return this.size=n.size,a}t.exports=r}),q=M((e,t)=>{function r(i){return this.__data__.get(i)}t.exports=r}),ie=M((e,t)=>{function r(i){return this.__data__.has(i)}t.exports=r}),oe=M((e,t)=>{var r=typeof Ei=="object"&&Ei&&Ei.Object===Object&&Ei;t.exports=r}),he=M((e,t)=>{var r=oe(),i=typeof self=="object"&&self&&self.Object===Object&&self,n=r||i||Function("return this")();t.exports=n}),ge=M((e,t)=>{var r=he(),i=r.Symbol;t.exports=i}),xe=M((e,t)=>{var r=ge(),i=Object.prototype,n=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;function o(u){var h=n.call(u,s),v=u[s];try{u[s]=void 0;var _=!0}catch{}var R=a.call(u);return _&&(h?u[s]=v:delete u[s]),R}t.exports=o}),me=M((e,t)=>{var r=Object.prototype,i=r.toString;function n(a){return i.call(a)}t.exports=n}),pe=M((e,t)=>{var r=ge(),i=xe(),n=me(),a="[object Null]",s="[object Undefined]",o=r?r.toStringTag:void 0;function u(h){return h==null?h===void 0?s:a:o&&o in Object(h)?i(h):n(h)}t.exports=u}),ce=M((e,t)=>{function r(i){var n=typeof i;return i!=null&&(n=="object"||n=="function")}t.exports=r}),fe=M((e,t)=>{var r=pe(),i=ce(),n="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",o="[object Proxy]";function u(h){if(!i(h))return!1;var v=r(h);return v==a||v==s||v==n||v==o}t.exports=u}),Ae=M((e,t)=>{var r=he(),i=r["__core-js_shared__"];t.exports=i}),ze=M((e,t)=>{var r=Ae(),i=(function(){var a=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""})();function n(a){return!!i&&i in a}t.exports=n}),Se=M((e,t)=>{var r=Function.prototype,i=r.toString;function n(a){if(a!=null){try{return i.call(a)}catch{}try{return a+""}catch{}}return""}t.exports=n}),He=M((e,t)=>{var r=fe(),i=ze(),n=ce(),a=Se(),s=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,u=Function.prototype,h=Object.prototype,v=u.toString,_=h.hasOwnProperty,R=RegExp("^"+v.call(_).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function I(Y){if(!n(Y)||i(Y))return!1;var re=r(Y)?R:o;return re.test(a(Y))}t.exports=I}),Be=M((e,t)=>{function r(i,n){return i?.[n]}t.exports=r}),Ge=M((e,t)=>{var r=He(),i=Be();function n(a,s){var o=i(a,s);return r(o)?o:void 0}t.exports=n}),Ke=M((e,t)=>{var r=Ge(),i=he(),n=r(i,"Map");t.exports=n}),Te=M((e,t)=>{var r=Ge(),i=r(Object,"create");t.exports=i}),Qe=M((e,t)=>{var r=Te();function i(){this.__data__=r?r(null):{},this.size=0}t.exports=i}),$e=M((e,t)=>{function r(i){var n=this.has(i)&&delete this.__data__[i];return this.size-=n?1:0,n}t.exports=r}),Mt=M((e,t)=>{var r=Te(),i="__lodash_hash_undefined__",n=Object.prototype,a=n.hasOwnProperty;function s(o){var u=this.__data__;if(r){var h=u[o];return h===i?void 0:h}return a.call(u,o)?u[o]:void 0}t.exports=s}),et=M((e,t)=>{var r=Te(),i=Object.prototype,n=i.hasOwnProperty;function a(s){var o=this.__data__;return r?o[s]!==void 0:n.call(o,s)}t.exports=a}),we=M((e,t)=>{var r=Te(),i="__lodash_hash_undefined__";function n(a,s){var o=this.__data__;return this.size+=this.has(a)?0:1,o[a]=r&&s===void 0?i:s,this}t.exports=n}),ye=M((e,t)=>{var r=Qe(),i=$e(),n=Mt(),a=et(),s=we();function o(u){var h=-1,v=u==null?0:u.length;for(this.clear();++h<v;){var _=u[h];this.set(_[0],_[1])}}o.prototype.clear=r,o.prototype.delete=i,o.prototype.get=n,o.prototype.has=a,o.prototype.set=s,t.exports=o}),Re=M((e,t)=>{var r=ye(),i=H(),n=Ke();function a(){this.size=0,this.__data__={hash:new r,map:new(n||i),string:new r}}t.exports=a}),Oe=M((e,t)=>{function r(i){var n=typeof i;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?i!=="__proto__":i===null}t.exports=r}),Ue=M((e,t)=>{var r=Oe();function i(n,a){var s=n.__data__;return r(a)?s[typeof a=="string"?"string":"hash"]:s.map}t.exports=i}),Fe=M((e,t)=>{var r=Ue();function i(n){var a=r(this,n).delete(n);return this.size-=a?1:0,a}t.exports=i}),Ye=M((e,t)=>{var r=Ue();function i(n){return r(this,n).get(n)}t.exports=i}),lt=M((e,t)=>{var r=Ue();function i(n){return r(this,n).has(n)}t.exports=i}),pt=M((e,t)=>{var r=Ue();function i(n,a){var s=r(this,n),o=s.size;return s.set(n,a),this.size+=s.size==o?0:1,this}t.exports=i}),_t=M((e,t)=>{var r=Re(),i=Fe(),n=Ye(),a=lt(),s=pt();function o(u){var h=-1,v=u==null?0:u.length;for(this.clear();++h<v;){var _=u[h];this.set(_[0],_[1])}}o.prototype.clear=r,o.prototype.delete=i,o.prototype.get=n,o.prototype.has=a,o.prototype.set=s,t.exports=o}),bt=M((e,t)=>{var r=H(),i=Ke(),n=_t(),a=200;function s(o,u){var h=this.__data__;if(h instanceof r){var v=h.__data__;if(!i||v.length<a-1)return v.push([o,u]),this.size=++h.size,this;h=this.__data__=new n(v)}return h.set(o,u),this.size=h.size,this}t.exports=s}),Lt=M((e,t)=>{var r=H(),i=U(),n=z(),a=q(),s=ie(),o=bt();function u(h){var v=this.__data__=new r(h);this.size=v.size}u.prototype.clear=i,u.prototype.delete=n,u.prototype.get=a,u.prototype.has=s,u.prototype.set=o,t.exports=u}),kt=M((e,t)=>{var r=Ge(),i=(function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch{}})();t.exports=i}),ut=M((e,t)=>{var r=kt();function i(n,a,s){a=="__proto__"&&r?r(n,a,{configurable:!0,enumerable:!0,value:s,writable:!0}):n[a]=s}t.exports=i}),tt=M((e,t)=>{var r=ut(),i=$();function n(a,s,o){(o!==void 0&&!i(a[s],o)||o===void 0&&!(s in a))&&r(a,s,o)}t.exports=n}),Vt=M((e,t)=>{function r(i){return function(n,a,s){for(var o=-1,u=Object(n),h=s(n),v=h.length;v--;){var _=h[i?v:++o];if(a(u[_],_,u)===!1)break}return n}}t.exports=r}),Ht=M((e,t)=>{var r=Vt(),i=r();t.exports=i}),At=M((e,t)=>{var r=he(),i=typeof e=="object"&&e&&!e.nodeType&&e,n=i&&typeof t=="object"&&t&&!t.nodeType&&t,a=n&&n.exports===i,s=a?r.Buffer:void 0,o=s?s.allocUnsafe:void 0;function u(h,v){if(v)return h.slice();var _=h.length,R=o?o(_):new h.constructor(_);return h.copy(R),R}t.exports=u}),gt=M((e,t)=>{var r=he(),i=r.Uint8Array;t.exports=i}),De=M((e,t)=>{var r=gt();function i(n){var a=new n.constructor(n.byteLength);return new r(a).set(new r(n)),a}t.exports=i}),Xe=M((e,t)=>{var r=De();function i(n,a){var s=a?r(n.buffer):n.buffer;return new n.constructor(s,n.byteOffset,n.length)}t.exports=i}),Et=M((e,t)=>{function r(i,n){var a=-1,s=i.length;for(n||(n=Array(s));++a<s;)n[a]=i[a];return n}t.exports=r}),xt=M((e,t)=>{var r=ce(),i=Object.create,n=(function(){function a(){}return function(s){if(!r(s))return{};if(i)return i(s);a.prototype=s;var o=new a;return a.prototype=void 0,o}})();t.exports=n}),ht=M((e,t)=>{function r(i,n){return function(a){return i(n(a))}}t.exports=r}),rt=M((e,t)=>{var r=ht(),i=r(Object.getPrototypeOf,Object);t.exports=i}),Bt=M((e,t)=>{var r=Object.prototype;function i(n){var a=n&&n.constructor,s=typeof a=="function"&&a.prototype||r;return n===s}t.exports=i}),Tt=M((e,t)=>{var r=xt(),i=rt(),n=Bt();function a(s){return typeof s.constructor=="function"&&!n(s)?r(i(s)):{}}t.exports=a}),Ie=M((e,t)=>{function r(i){return i!=null&&typeof i=="object"}t.exports=r}),it=M((e,t)=>{var r=pe(),i=Ie(),n="[object Arguments]";function a(s){return i(s)&&r(s)==n}t.exports=a}),br=M((e,t)=>{var r=it(),i=Ie(),n=Object.prototype,a=n.hasOwnProperty,s=n.propertyIsEnumerable,o=r((function(){return arguments})())?r:function(u){return i(u)&&a.call(u,"callee")&&!s.call(u,"callee")};t.exports=o}),Ft=M((e,t)=>{var r=Array.isArray;t.exports=r}),Rt=M((e,t)=>{var r=9007199254740991;function i(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=r}t.exports=i}),er=M((e,t)=>{var r=fe(),i=Rt();function n(a){return a!=null&&i(a.length)&&!r(a)}t.exports=n}),cr=M((e,t)=>{var r=er(),i=Ie();function n(a){return i(a)&&r(a)}t.exports=n}),Wr=M((e,t)=>{function r(){return!1}t.exports=r}),Ot=M((e,t)=>{var r=he(),i=Wr(),n=typeof e=="object"&&e&&!e.nodeType&&e,a=n&&typeof t=="object"&&t&&!t.nodeType&&t,s=a&&a.exports===n,o=s?r.Buffer:void 0,u=o?o.isBuffer:void 0,h=u||i;t.exports=h}),Ai=M((e,t)=>{var r=pe(),i=rt(),n=Ie(),a="[object Object]",s=Function.prototype,o=Object.prototype,u=s.toString,h=o.hasOwnProperty,v=u.call(Object);function _(R){if(!n(R)||r(R)!=a)return!1;var I=i(R);if(I===null)return!0;var Y=h.call(I,"constructor")&&I.constructor;return typeof Y=="function"&&Y instanceof Y&&u.call(Y)==v}t.exports=_}),nt=M((e,t)=>{var r=pe(),i=Rt(),n=Ie(),a="[object Arguments]",s="[object Array]",o="[object Boolean]",u="[object Date]",h="[object Error]",v="[object Function]",_="[object Map]",R="[object Number]",I="[object Object]",Y="[object RegExp]",re="[object Set]",ae="[object String]",_e="[object WeakMap]",y="[object ArrayBuffer]",k="[object DataView]",S="[object Float32Array]",j="[object Float64Array]",P="[object Int8Array]",O="[object Int16Array]",l="[object Int32Array]",d="[object Uint8Array]",g="[object Uint8ClampedArray]",p="[object Uint16Array]",f="[object Uint32Array]",m={};m[S]=m[j]=m[P]=m[O]=m[l]=m[d]=m[g]=m[p]=m[f]=!0,m[a]=m[s]=m[y]=m[o]=m[k]=m[u]=m[h]=m[v]=m[_]=m[R]=m[I]=m[Y]=m[re]=m[ae]=m[_e]=!1;function E(x){return n(x)&&i(x.length)&&!!m[r(x)]}t.exports=E}),sr=M((e,t)=>{function r(i){return function(n){return i(n)}}t.exports=r}),Lr=M((e,t)=>{var r=oe(),i=typeof e=="object"&&e&&!e.nodeType&&e,n=i&&typeof t=="object"&&t&&!t.nodeType&&t,a=n&&n.exports===i,s=a&&r.process,o=(function(){try{var u=n&&n.require&&n.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}})();t.exports=o}),Rr=M((e,t)=>{var r=nt(),i=sr(),n=Lr(),a=n&&n.isTypedArray,s=a?i(a):r;t.exports=s}),Qr=M((e,t)=>{function r(i,n){if(!(n==="constructor"&&typeof i[n]=="function")&&n!="__proto__")return i[n]}t.exports=r}),Ti=M((e,t)=>{var r=ut(),i=$(),n=Object.prototype,a=n.hasOwnProperty;function s(o,u,h){var v=o[u];(!(a.call(o,u)&&i(v,h))||h===void 0&&!(u in o))&&r(o,u,h)}t.exports=s}),dr=M((e,t)=>{var r=Ti(),i=ut();function n(a,s,o,u){var h=!o;o||(o={});for(var v=-1,_=s.length;++v<_;){var R=s[v],I=u?u(o[R],a[R],R,o,a):void 0;I===void 0&&(I=a[R]),h?i(o,R,I):r(o,R,I)}return o}t.exports=n}),ei=M((e,t)=>{function r(i,n){for(var a=-1,s=Array(i);++a<i;)s[a]=n(a);return s}t.exports=r}),ti=M((e,t)=>{var r=9007199254740991,i=/^(?:0|[1-9]\d*)$/;function n(a,s){var o=typeof a;return s=s??r,!!s&&(o=="number"||o!="symbol"&&i.test(a))&&a>-1&&a%1==0&&a<s}t.exports=n}),Fi=M((e,t)=>{var r=ei(),i=br(),n=Ft(),a=Ot(),s=ti(),o=Rr(),u=Object.prototype,h=u.hasOwnProperty;function v(_,R){var I=n(_),Y=!I&&i(_),re=!I&&!Y&&a(_),ae=!I&&!Y&&!re&&o(_),_e=I||Y||re||ae,y=_e?r(_.length,String):[],k=y.length;for(var S in _)(R||h.call(_,S))&&!(_e&&(S=="length"||re&&(S=="offset"||S=="parent")||ae&&(S=="buffer"||S=="byteLength"||S=="byteOffset")||s(S,k)))&&y.push(S);return y}t.exports=v}),Or=M((e,t)=>{function r(i){var n=[];if(i!=null)for(var a in Object(i))n.push(a);return n}t.exports=r}),ri=M((e,t)=>{var r=ce(),i=Bt(),n=Or(),a=Object.prototype,s=a.hasOwnProperty;function o(u){if(!r(u))return n(u);var h=i(u),v=[];for(var _ in u)_=="constructor"&&(h||!s.call(u,_))||v.push(_);return v}t.exports=o}),Ir=M((e,t)=>{var r=Fi(),i=ri(),n=er();function a(s){return n(s)?r(s,!0):i(s)}t.exports=a}),Ri=M((e,t)=>{var r=dr(),i=Ir();function n(a){return r(a,i(a))}t.exports=n}),Oi=M((e,t)=>{var r=tt(),i=At(),n=Xe(),a=Et(),s=Tt(),o=br(),u=Ft(),h=cr(),v=Ot(),_=fe(),R=ce(),I=Ai(),Y=Rr(),re=Qr(),ae=Ri();function _e(y,k,S,j,P,O,l){var d=re(y,S),g=re(k,S),p=l.get(g);if(p){r(y,S,p);return}var f=O?O(d,g,S+"",y,k,l):void 0,m=f===void 0;if(m){var E=u(g),x=!E&&v(g),w=!E&&!x&&Y(g);f=g,E||x||w?u(d)?f=d:h(d)?f=a(d):x?(m=!1,f=i(g,!0)):w?(m=!1,f=n(g,!0)):f=[]:I(g)||o(g)?(f=d,o(d)?f=ae(d):(!R(d)||_(d))&&(f=s(g))):m=!1}m&&(l.set(g,f),P(f,g,j,O,l),l.delete(g)),r(y,S,f)}t.exports=_e}),ii=M((e,t)=>{var r=Lt(),i=tt(),n=Ht(),a=Oi(),s=ce(),o=Ir(),u=Qr();function h(v,_,R,I,Y){v!==_&&n(_,function(re,ae){if(Y||(Y=new r),s(re))a(v,_,ae,R,h,I,Y);else{var _e=I?I(u(v,ae),re,ae+"",v,_,Y):void 0;_e===void 0&&(_e=re),i(v,ae,_e)}},o)}t.exports=h}),kr=M((e,t)=>{function r(i){return i}t.exports=r}),ni=M((e,t)=>{function r(i,n,a){switch(a.length){case 0:return i.call(n);case 1:return i.call(n,a[0]);case 2:return i.call(n,a[0],a[1]);case 3:return i.call(n,a[0],a[1],a[2])}return i.apply(n,a)}t.exports=r}),Ii=M((e,t)=>{var r=ni(),i=Math.max;function n(a,s,o){return s=i(s===void 0?a.length-1:s,0),function(){for(var u=arguments,h=-1,v=i(u.length-s,0),_=Array(v);++h<v;)_[h]=u[s+h];h=-1;for(var R=Array(s+1);++h<s;)R[h]=u[h];return R[s]=o(_),r(a,this,R)}}t.exports=n}),ji=M((e,t)=>{function r(i){return function(){return i}}t.exports=r}),ai=M((e,t)=>{var r=ji(),i=kt(),n=kr(),a=i?function(s,o){return i(s,"toString",{configurable:!0,enumerable:!1,value:r(o),writable:!0})}:n;t.exports=a}),si=M((e,t)=>{var r=800,i=16,n=Date.now;function a(s){var o=0,u=0;return function(){var h=n(),v=i-(h-u);if(u=h,v>0){if(++o>=r)return arguments[0]}else o=0;return s.apply(void 0,arguments)}}t.exports=a}),pr=M((e,t)=>{var r=ai(),i=si(),n=i(r);t.exports=n}),Ni=M((e,t)=>{var r=kr(),i=Ii(),n=pr();function a(s,o){return n(i(s,o,r),s+"")}t.exports=a}),oi=M((e,t)=>{var r=$(),i=er(),n=ti(),a=ce();function s(o,u,h){if(!a(h))return!1;var v=typeof u;return(v=="number"?i(h)&&n(u,h.length):v=="string"&&u in h)?r(h[u],o):!1}t.exports=s}),li=M((e,t)=>{var r=Ni(),i=oi();function n(a){return r(function(s,o){var u=-1,h=o.length,v=h>1?o[h-1]:void 0,_=h>2?o[2]:void 0;for(v=a.length>3&&typeof v=="function"?(h--,v):void 0,_&&i(o[0],o[1],_)&&(v=h<3?void 0:v,h=1),s=Object(s);++u<h;){var R=o[u];R&&a(s,R,u,v)}return s})}t.exports=n}),xr=M((e,t)=>{var r=ii(),i=li(),n=i(function(a,s,o){r(a,s,o)});t.exports=n}),jr=M((e,t)=>{var r=pe(),i=Ie(),n="[object Symbol]";function a(s){return typeof s=="symbol"||i(s)&&r(s)==n}t.exports=a}),be=M((e,t)=>{var r=Ft(),i=jr(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function s(o,u){if(r(o))return!1;var h=typeof o;return h=="number"||h=="symbol"||h=="boolean"||o==null||i(o)?!0:a.test(o)||!n.test(o)||u!=null&&o in Object(u)}t.exports=s}),ue=M((e,t)=>{var r=_t(),i="Expected a function";function n(a,s){if(typeof a!="function"||s!=null&&typeof s!="function")throw new TypeError(i);var o=function(){var u=arguments,h=s?s.apply(this,u):u[0],v=o.cache;if(v.has(h))return v.get(h);var _=a.apply(this,u);return o.cache=v.set(h,_)||v,_};return o.cache=new(n.Cache||r),o}n.Cache=r,t.exports=n}),ke=M((e,t)=>{var r=ue(),i=500;function n(a){var s=r(a,function(u){return o.size===i&&o.clear(),u}),o=s.cache;return s}t.exports=n}),Pe=M((e,t)=>{var r=ke(),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,a=r(function(s){var o=[];return s.charCodeAt(0)===46&&o.push(""),s.replace(i,function(u,h,v,_){o.push(v?_.replace(n,"$1"):h||u)}),o});t.exports=a}),Ve=M((e,t)=>{function r(i,n){for(var a=-1,s=i==null?0:i.length,o=Array(s);++a<s;)o[a]=n(i[a],a,i);return o}t.exports=r}),Kt=M((e,t)=>{var r=ge(),i=Ve(),n=Ft(),a=jr(),s=r?r.prototype:void 0,o=s?s.toString:void 0;function u(h){if(typeof h=="string")return h;if(n(h))return i(h,u)+"";if(a(h))return o?o.call(h):"";var v=h+"";return v=="0"&&1/h==-1/0?"-0":v}t.exports=u}),It=M((e,t)=>{var r=Kt();function i(n){return n==null?"":r(n)}t.exports=i}),jt=M((e,t)=>{var r=Ft(),i=be(),n=Pe(),a=It();function s(o,u){return r(o)?o:i(o,u)?[o]:n(a(o))}t.exports=s}),Nt=M((e,t)=>{var r=jr();function i(n){if(typeof n=="string"||r(n))return n;var a=n+"";return a=="0"&&1/n==-1/0?"-0":a}t.exports=i}),tr=M((e,t)=>{var r=jt(),i=Nt();function n(a,s){s=r(s,a);for(var o=0,u=s.length;a!=null&&o<u;)a=a[i(s[o++])];return o&&o==u?a:void 0}t.exports=n}),Gt=M((e,t)=>{var r=tr();function i(n,a,s){var o=n==null?void 0:r(n,a);return o===void 0?s:o}t.exports=i}),qt=M((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():(r=r||self).RBush=i()})(e,function(){function r(y,k,S,j,P){(function O(l,d,g,p,f){for(;p>g;){if(p-g>600){var m=p-g+1,E=d-g+1,x=Math.log(m),w=.5*Math.exp(2*x/3),F=.5*Math.sqrt(x*w*(m-w)/m)*(E-m/2<0?-1:1),T=Math.max(g,Math.floor(d-E*w/m+F)),K=Math.min(p,Math.floor(d+(m-E)*w/m+F));O(l,d,T,K,f)}var ne=l[d],se=g,le=p;for(i(l,g,d),f(l[p],ne)>0&&i(l,g,p);se<le;){for(i(l,se,le),se++,le--;f(l[se],ne)<0;)se++;for(;f(l[le],ne)>0;)le--}f(l[g],ne)===0?i(l,g,le):i(l,++le,p),le<=d&&(g=le+1),d<=le&&(p=le-1)}})(y,k,S||0,j||y.length-1,P||n)}function i(y,k,S){var j=y[k];y[k]=y[S],y[S]=j}function n(y,k){return y<k?-1:y>k?1:0}var a=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(y,k,S){if(!S)return k.indexOf(y);for(var j=0;j<k.length;j++)if(S(y,k[j]))return j;return-1}function o(y,k){u(y,0,y.children.length,k,y)}function u(y,k,S,j,P){P||(P=ae(null)),P.minX=1/0,P.minY=1/0,P.maxX=-1/0,P.maxY=-1/0;for(var O=k;O<S;O++){var l=y.children[O];h(P,y.leaf?j(l):l)}return P}function h(y,k){return y.minX=Math.min(y.minX,k.minX),y.minY=Math.min(y.minY,k.minY),y.maxX=Math.max(y.maxX,k.maxX),y.maxY=Math.max(y.maxY,k.maxY),y}function v(y,k){return y.minX-k.minX}function _(y,k){return y.minY-k.minY}function R(y){return(y.maxX-y.minX)*(y.maxY-y.minY)}function I(y){return y.maxX-y.minX+(y.maxY-y.minY)}function Y(y,k){return y.minX<=k.minX&&y.minY<=k.minY&&k.maxX<=y.maxX&&k.maxY<=y.maxY}function re(y,k){return k.minX<=y.maxX&&k.minY<=y.maxY&&k.maxX>=y.minX&&k.maxY>=y.minY}function ae(y){return{children:y,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _e(y,k,S,j,P){for(var O=[k,S];O.length;)if(!((S=O.pop())-(k=O.pop())<=j)){var l=k+Math.ceil((S-k)/j/2)*j;r(y,l,k,S,P),O.push(k,l,l,S)}}return a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(y){var k=this.data,S=[];if(!re(y,k))return S;for(var j=this.toBBox,P=[];k;){for(var O=0;O<k.children.length;O++){var l=k.children[O],d=k.leaf?j(l):l;re(y,d)&&(k.leaf?S.push(l):Y(y,d)?this._all(l,S):P.push(l))}k=P.pop()}return S},a.prototype.collides=function(y){var k=this.data;if(!re(y,k))return!1;for(var S=[];k;){for(var j=0;j<k.children.length;j++){var P=k.children[j],O=k.leaf?this.toBBox(P):P;if(re(y,O)){if(k.leaf||Y(y,O))return!0;S.push(P)}}k=S.pop()}return!1},a.prototype.load=function(y){if(!y||!y.length)return this;if(y.length<this._minEntries){for(var k=0;k<y.length;k++)this.insert(y[k]);return this}var S=this._build(y.slice(),0,y.length-1,0);if(this.data.children.length)if(this.data.height===S.height)this._splitRoot(this.data,S);else{if(this.data.height<S.height){var j=this.data;this.data=S,S=j}this._insert(S,this.data.height-S.height-1,!0)}else this.data=S;return this},a.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},a.prototype.clear=function(){return this.data=ae([]),this},a.prototype.remove=function(y,k){if(!y)return this;for(var S,j,P,O=this.data,l=this.toBBox(y),d=[],g=[];O||d.length;){if(O||(O=d.pop(),j=d[d.length-1],S=g.pop(),P=!0),O.leaf){var p=s(y,O.children,k);if(p!==-1)return O.children.splice(p,1),d.push(O),this._condense(d),this}P||O.leaf||!Y(O,l)?j?(S++,O=j.children[S],P=!1):O=null:(d.push(O),g.push(S),S=0,j=O,O=O.children[0])}return this},a.prototype.toBBox=function(y){return y},a.prototype.compareMinX=function(y,k){return y.minX-k.minX},a.prototype.compareMinY=function(y,k){return y.minY-k.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(y){return this.data=y,this},a.prototype._all=function(y,k){for(var S=[];y;)y.leaf?k.push.apply(k,y.children):S.push.apply(S,y.children),y=S.pop();return k},a.prototype._build=function(y,k,S,j){var P,O=S-k+1,l=this._maxEntries;if(O<=l)return o(P=ae(y.slice(k,S+1)),this.toBBox),P;j||(j=Math.ceil(Math.log(O)/Math.log(l)),l=Math.ceil(O/Math.pow(l,j-1))),(P=ae([])).leaf=!1,P.height=j;var d=Math.ceil(O/l),g=d*Math.ceil(Math.sqrt(l));_e(y,k,S,g,this.compareMinX);for(var p=k;p<=S;p+=g){var f=Math.min(p+g-1,S);_e(y,p,f,d,this.compareMinY);for(var m=p;m<=f;m+=d){var E=Math.min(m+d-1,f);P.children.push(this._build(y,m,E,j-1))}}return o(P,this.toBBox),P},a.prototype._chooseSubtree=function(y,k,S,j){for(;j.push(k),!k.leaf&&j.length-1!==S;){for(var P=1/0,O=1/0,l=void 0,d=0;d<k.children.length;d++){var g=k.children[d],p=R(g),f=(m=y,E=g,(Math.max(E.maxX,m.maxX)-Math.min(E.minX,m.minX))*(Math.max(E.maxY,m.maxY)-Math.min(E.minY,m.minY))-p);f<O?(O=f,P=p<P?p:P,l=g):f===O&&p<P&&(P=p,l=g)}k=l||k.children[0]}var m,E;return k},a.prototype._insert=function(y,k,S){var j=S?y:this.toBBox(y),P=[],O=this._chooseSubtree(j,this.data,k,P);for(O.children.push(y),h(O,j);k>=0&&P[k].children.length>this._maxEntries;)this._split(P,k),k--;this._adjustParentBBoxes(j,P,k)},a.prototype._split=function(y,k){var S=y[k],j=S.children.length,P=this._minEntries;this._chooseSplitAxis(S,P,j);var O=this._chooseSplitIndex(S,P,j),l=ae(S.children.splice(O,S.children.length-O));l.height=S.height,l.leaf=S.leaf,o(S,this.toBBox),o(l,this.toBBox),k?y[k-1].children.push(l):this._splitRoot(S,l)},a.prototype._splitRoot=function(y,k){this.data=ae([y,k]),this.data.height=y.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(y,k,S){for(var j,P,O,l,d,g,p,f=1/0,m=1/0,E=k;E<=S-k;E++){var x=u(y,0,E,this.toBBox),w=u(y,E,S,this.toBBox),F=(P=x,O=w,l=void 0,d=void 0,g=void 0,p=void 0,l=Math.max(P.minX,O.minX),d=Math.max(P.minY,O.minY),g=Math.min(P.maxX,O.maxX),p=Math.min(P.maxY,O.maxY),Math.max(0,g-l)*Math.max(0,p-d)),T=R(x)+R(w);F<f?(f=F,j=E,m=T<m?T:m):F===f&&T<m&&(m=T,j=E)}return j||S-k},a.prototype._chooseSplitAxis=function(y,k,S){var j=y.leaf?this.compareMinX:v,P=y.leaf?this.compareMinY:_;this._allDistMargin(y,k,S,j)<this._allDistMargin(y,k,S,P)&&y.children.sort(j)},a.prototype._allDistMargin=function(y,k,S,j){y.children.sort(j);for(var P=this.toBBox,O=u(y,0,k,P),l=u(y,S-k,S,P),d=I(O)+I(l),g=k;g<S-k;g++){var p=y.children[g];h(O,y.leaf?P(p):p),d+=I(O)}for(var f=S-k-1;f>=k;f--){var m=y.children[f];h(l,y.leaf?P(m):m),d+=I(l)}return d},a.prototype._adjustParentBBoxes=function(y,k,S){for(var j=S;j>=0;j--)h(k[j],y)},a.prototype._condense=function(y){for(var k=y.length-1,S=void 0;k>=0;k--)y[k].children.length===0?k>0?(S=y[k-1].children).splice(S.indexOf(y[k]),1):this.clear():o(y[k],this.toBBox)},a})}),gr=M(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=63710088e-1,e.factors={centimeters:e.earthRadius*100,centimetres:e.earthRadius*100,degrees:e.earthRadius/111325,feet:e.earthRadius*3.28084,inches:e.earthRadius*39.37,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:e.earthRadius*1e3,millimetres:e.earthRadius*1e3,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius*1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function t(p,f,m){m===void 0&&(m={});var E={type:"Feature"};return(m.id===0||m.id)&&(E.id=m.id),m.bbox&&(E.bbox=m.bbox),E.properties=f||{},E.geometry=p,E}e.feature=t;function r(p,f,m){switch(p){case"Point":return i(f).geometry;case"LineString":return o(f).geometry;case"Polygon":return a(f).geometry;case"MultiPoint":return _(f).geometry;case"MultiLineString":return v(f).geometry;case"MultiPolygon":return R(f).geometry;default:throw new Error(p+" is invalid")}}e.geometry=r;function i(p,f,m){if(m===void 0&&(m={}),!p)throw new Error("coordinates is required");if(!Array.isArray(p))throw new Error("coordinates must be an Array");if(p.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!O(p[0])||!O(p[1]))throw new Error("coordinates must contain numbers");var E={type:"Point",coordinates:p};return t(E,f,m)}e.point=i;function n(p,f,m){return m===void 0&&(m={}),h(p.map(function(E){return i(E,f)}),m)}e.points=n;function a(p,f,m){m===void 0&&(m={});for(var E=0,x=p;E<x.length;E++){var w=x[E];if(w.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var F=0;F<w[w.length-1].length;F++)if(w[w.length-1][F]!==w[0][F])throw new Error("First and last Position are not equivalent.")}var T={type:"Polygon",coordinates:p};return t(T,f,m)}e.polygon=a;function s(p,f,m){return m===void 0&&(m={}),h(p.map(function(E){return a(E,f)}),m)}e.polygons=s;function o(p,f,m){if(m===void 0&&(m={}),p.length<2)throw new Error("coordinates must be an array of two or more positions");var E={type:"LineString",coordinates:p};return t(E,f,m)}e.lineString=o;function u(p,f,m){return m===void 0&&(m={}),h(p.map(function(E){return o(E,f)}),m)}e.lineStrings=u;function h(p,f){f===void 0&&(f={});var m={type:"FeatureCollection"};return f.id&&(m.id=f.id),f.bbox&&(m.bbox=f.bbox),m.features=p,m}e.featureCollection=h;function v(p,f,m){m===void 0&&(m={});var E={type:"MultiLineString",coordinates:p};return t(E,f,m)}e.multiLineString=v;function _(p,f,m){m===void 0&&(m={});var E={type:"MultiPoint",coordinates:p};return t(E,f,m)}e.multiPoint=_;function R(p,f,m){m===void 0&&(m={});var E={type:"MultiPolygon",coordinates:p};return t(E,f,m)}e.multiPolygon=R;function I(p,f,m){m===void 0&&(m={});var E={type:"GeometryCollection",geometries:p};return t(E,f,m)}e.geometryCollection=I;function Y(p,f){if(f===void 0&&(f=0),f&&!(f>=0))throw new Error("precision must be a positive number");var m=Math.pow(10,f||0);return Math.round(p*m)/m}e.round=Y;function re(p,f){f===void 0&&(f="kilometers");var m=e.factors[f];if(!m)throw new Error(f+" units is invalid");return p*m}e.radiansToLength=re;function ae(p,f){f===void 0&&(f="kilometers");var m=e.factors[f];if(!m)throw new Error(f+" units is invalid");return p/m}e.lengthToRadians=ae;function _e(p,f){return k(ae(p,f))}e.lengthToDegrees=_e;function y(p){var f=p%360;return f<0&&(f+=360),f}e.bearingToAzimuth=y;function k(p){var f=p%(2*Math.PI);return f*180/Math.PI}e.radiansToDegrees=k;function S(p){var f=p%360;return f*Math.PI/180}e.degreesToRadians=S;function j(p,f,m){if(f===void 0&&(f="kilometers"),m===void 0&&(m="kilometers"),!(p>=0))throw new Error("length must be a positive number");return re(ae(p,f),m)}e.convertLength=j;function P(p,f,m){if(f===void 0&&(f="meters"),m===void 0&&(m="kilometers"),!(p>=0))throw new Error("area must be a positive number");var E=e.areaFactors[f];if(!E)throw new Error("invalid original units");var x=e.areaFactors[m];if(!x)throw new Error("invalid final units");return p/E*x}e.convertArea=P;function O(p){return!isNaN(p)&&p!==null&&!Array.isArray(p)}e.isNumber=O;function l(p){return!!p&&p.constructor===Object}e.isObject=l;function d(p){if(!p)throw new Error("bbox is required");if(!Array.isArray(p))throw new Error("bbox must be an Array");if(p.length!==4&&p.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");p.forEach(function(f){if(!O(f))throw new Error("bbox must only contain numbers")})}e.validateBBox=d;function g(p){if(!p)throw new Error("id is required");if(["string","number"].indexOf(typeof p)===-1)throw new Error("id must be a number or a string")}e.validateId=g}),Nr=M(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=gr();function r(k,S,j){if(k!==null)for(var P,O,l,d,g,p,f,m=0,E=0,x,w=k.type,F=w==="FeatureCollection",T=w==="Feature",K=F?k.features.length:1,ne=0;ne<K;ne++){f=F?k.features[ne].geometry:T?k.geometry:k,x=f?f.type==="GeometryCollection":!1,g=x?f.geometries.length:1;for(var se=0;se<g;se++){var le=0,Le=0;if(d=x?f.geometries[se]:f,d!==null){p=d.coordinates;var Me=d.type;switch(m=j&&(Me==="Polygon"||Me==="MultiPolygon")?1:0,Me){case null:break;case"Point":if(S(p,E,ne,le,Le)===!1)return!1;E++,le++;break;case"LineString":case"MultiPoint":for(P=0;P<p.length;P++){if(S(p[P],E,ne,le,Le)===!1)return!1;E++,Me==="MultiPoint"&&le++}Me==="LineString"&&le++;break;case"Polygon":case"MultiLineString":for(P=0;P<p.length;P++){for(O=0;O<p[P].length-m;O++){if(S(p[P][O],E,ne,le,Le)===!1)return!1;E++}Me==="MultiLineString"&&le++,Me==="Polygon"&&Le++}Me==="Polygon"&&le++;break;case"MultiPolygon":for(P=0;P<p.length;P++){for(Le=0,O=0;O<p[P].length;O++){for(l=0;l<p[P][O].length-m;l++){if(S(p[P][O][l],E,ne,le,Le)===!1)return!1;E++}Le++}le++}break;case"GeometryCollection":for(P=0;P<d.geometries.length;P++)if(r(d.geometries[P],S,j)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(k,S,j,P){var O=j;return r(k,function(l,d,g,p,f){d===0&&j===void 0?O=l:O=S(O,l,d,g,p,f)},P),O}function n(k,S){var j;switch(k.type){case"FeatureCollection":for(j=0;j<k.features.length&&S(k.features[j].properties,j)!==!1;j++);break;case"Feature":S(k.properties,0);break}}function a(k,S,j){var P=j;return n(k,function(O,l){l===0&&j===void 0?P=O:P=S(P,O,l)}),P}function s(k,S){if(k.type==="Feature")S(k,0);else if(k.type==="FeatureCollection")for(var j=0;j<k.features.length&&S(k.features[j],j)!==!1;j++);}function o(k,S,j){var P=j;return s(k,function(O,l){l===0&&j===void 0?P=O:P=S(P,O,l)}),P}function u(k){var S=[];return r(k,function(j){S.push(j)}),S}function h(k,S){var j,P,O,l,d,g,p,f,m,E,x=0,w=k.type==="FeatureCollection",F=k.type==="Feature",T=w?k.features.length:1;for(j=0;j<T;j++){for(g=w?k.features[j].geometry:F?k.geometry:k,f=w?k.features[j].properties:F?k.properties:{},m=w?k.features[j].bbox:F?k.bbox:void 0,E=w?k.features[j].id:F?k.id:void 0,p=g?g.type==="GeometryCollection":!1,d=p?g.geometries.length:1,O=0;O<d;O++){if(l=p?g.geometries[O]:g,l===null){if(S(null,x,f,m,E)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(S(l,x,f,m,E)===!1)return!1;break}case"GeometryCollection":{for(P=0;P<l.geometries.length;P++)if(S(l.geometries[P],x,f,m,E)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}x++}}function v(k,S,j){var P=j;return h(k,function(O,l,d,g,p){l===0&&j===void 0?P=O:P=S(P,O,l,d,g,p)}),P}function _(k,S){h(k,function(j,P,O,l,d){var g=j===null?null:j.type;switch(g){case null:case"Point":case"LineString":case"Polygon":return S(t.feature(j,O,{bbox:l,id:d}),P,0)===!1?!1:void 0}var p;switch(g){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon";break}for(var f=0;f<j.coordinates.length;f++){var m=j.coordinates[f],E={type:p,coordinates:m};if(S(t.feature(E,O),P,f)===!1)return!1}})}function R(k,S,j){var P=j;return _(k,function(O,l,d){l===0&&d===0&&j===void 0?P=O:P=S(P,O,l,d)}),P}function I(k,S){_(k,function(j,P,O){var l=0;if(j.geometry){var d=j.geometry.type;if(!(d==="Point"||d==="MultiPoint")){var g,p=0,f=0,m=0;if(r(j,function(E,x,w,F,T){if(g===void 0||P>p||F>f||T>m){g=E,p=P,f=F,m=T,l=0;return}var K=t.lineString([g,E],j.properties);if(S(K,P,O,T,l)===!1)return!1;l++,g=E})===!1)return!1}}})}function Y(k,S,j){var P=j,O=!1;return I(k,function(l,d,g,p,f){O===!1&&j===void 0?P=l:P=S(P,l,d,g,p,f),O=!0}),P}function re(k,S){if(!k)throw new Error("geojson is required");_(k,function(j,P,O){if(j.geometry!==null){var l=j.geometry.type,d=j.geometry.coordinates;switch(l){case"LineString":if(S(j,P,O,0,0)===!1)return!1;break;case"Polygon":for(var g=0;g<d.length;g++)if(S(t.lineString(d[g],j.properties),P,O,g)===!1)return!1;break}}})}function ae(k,S,j){var P=j;return re(k,function(O,l,d,g){l===0&&j===void 0?P=O:P=S(P,O,l,d,g)}),P}function _e(k,S){if(S=S||{},!t.isObject(S))throw new Error("options is invalid");var j=S.featureIndex||0,P=S.multiFeatureIndex||0,O=S.geometryIndex||0,l=S.segmentIndex||0,d=S.properties,g;switch(k.type){case"FeatureCollection":j<0&&(j=k.features.length+j),d=d||k.features[j].properties,g=k.features[j].geometry;break;case"Feature":d=d||k.properties,g=k.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=k;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var p=g.coordinates;switch(g.type){case"Point":case"MultiPoint":return null;case"LineString":return l<0&&(l=p.length+l-1),t.lineString([p[l],p[l+1]],d,S);case"Polygon":return O<0&&(O=p.length+O),l<0&&(l=p[O].length+l-1),t.lineString([p[O][l],p[O][l+1]],d,S);case"MultiLineString":return P<0&&(P=p.length+P),l<0&&(l=p[P].length+l-1),t.lineString([p[P][l],p[P][l+1]],d,S);case"MultiPolygon":return P<0&&(P=p.length+P),O<0&&(O=p[P].length+O),l<0&&(l=p[P][O].length-l-1),t.lineString([p[P][O][l],p[P][O][l+1]],d,S)}throw new Error("geojson is invalid")}function y(k,S){if(S=S||{},!t.isObject(S))throw new Error("options is invalid");var j=S.featureIndex||0,P=S.multiFeatureIndex||0,O=S.geometryIndex||0,l=S.coordIndex||0,d=S.properties,g;switch(k.type){case"FeatureCollection":j<0&&(j=k.features.length+j),d=d||k.features[j].properties,g=k.features[j].geometry;break;case"Feature":d=d||k.properties,g=k.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=k;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var p=g.coordinates;switch(g.type){case"Point":return t.point(p,d,S);case"MultiPoint":return P<0&&(P=p.length+P),t.point(p[P],d,S);case"LineString":return l<0&&(l=p.length+l),t.point(p[l],d,S);case"Polygon":return O<0&&(O=p.length+O),l<0&&(l=p[O].length+l),t.point(p[O][l],d,S);case"MultiLineString":return P<0&&(P=p.length+P),l<0&&(l=p[P].length+l),t.point(p[P][l],d,S);case"MultiPolygon":return P<0&&(P=p.length+P),O<0&&(O=p[P].length+O),l<0&&(l=p[P][O].length-l),t.point(p[P][O][l],d,S)}throw new Error("geojson is invalid")}e.coordAll=u,e.coordEach=r,e.coordReduce=i,e.featureEach=s,e.featureReduce=o,e.findPoint=y,e.findSegment=_e,e.flattenEach=_,e.flattenReduce=R,e.geomEach=h,e.geomReduce=v,e.lineEach=re,e.lineReduce=ae,e.propEach=n,e.propReduce=a,e.segmentEach=I,e.segmentReduce=Y}),Ja=M(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Nr();function r(i){var n=[1/0,1/0,-1/0,-1/0];return t.coordEach(i,function(a){n[0]>a[0]&&(n[0]=a[0]),n[1]>a[1]&&(n[1]=a[1]),n[2]<a[0]&&(n[2]=a[0]),n[3]<a[1]&&(n[3]=a[1])}),n}r.default=r,e.default=r}),xn=M((e,t)=>{var r=qt(),i=gr(),n=Nr(),a=Ja().default,s=n.featureEach;n.coordEach,i.polygon;var o=i.featureCollection;function u(h){var v=new r(h);return v.insert=function(_){if(_.type!=="Feature")throw new Error("invalid feature");return _.bbox=_.bbox?_.bbox:a(_),r.prototype.insert.call(this,_)},v.load=function(_){var R=[];return Array.isArray(_)?_.forEach(function(I){if(I.type!=="Feature")throw new Error("invalid features");I.bbox=I.bbox?I.bbox:a(I),R.push(I)}):s(_,function(I){if(I.type!=="Feature")throw new Error("invalid features");I.bbox=I.bbox?I.bbox:a(I),R.push(I)}),r.prototype.load.call(this,R)},v.remove=function(_,R){if(_.type!=="Feature")throw new Error("invalid feature");return _.bbox=_.bbox?_.bbox:a(_),r.prototype.remove.call(this,_,R)},v.clear=function(){return r.prototype.clear.call(this)},v.search=function(_){var R=r.prototype.search.call(this,this.toBBox(_));return o(R)},v.collides=function(_){return r.prototype.collides.call(this,this.toBBox(_))},v.all=function(){var _=r.prototype.all.call(this);return o(_)},v.toJSON=function(){return r.prototype.toJSON.call(this)},v.fromJSON=function(_){return r.prototype.fromJSON.call(this,_)},v.toBBox=function(_){var R;if(_.bbox)R=_.bbox;else if(Array.isArray(_)&&_.length===4)R=_;else if(Array.isArray(_)&&_.length===6)R=[_[0],_[1],_[3],_[4]];else if(_.type==="Feature")R=a(_);else if(_.type==="FeatureCollection")R=a(_);else throw new Error("invalid geojson");return{minX:R[0],minY:R[1],maxX:R[2],maxY:R[3]}},v}t.exports=u,t.exports.default=u});Array.prototype.findIndex=Array.prototype.findIndex||function(e){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof e!="function")throw new TypeError("callback must be a function");for(var t=Object(this),r=t.length>>>0,i=arguments[1],n=0;n<r;n++)if(e.call(i,t[n],n,t))return n;return-1},Array.prototype.find=Array.prototype.find||function(e){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof e!="function")throw new TypeError("callback must be a function");for(var t=Object(this),r=t.length>>>0,i=arguments[1],n=0;n<r;n++){var a=t[n];if(e.call(i,a,n,t))return a}},typeof Object.assign!="function"&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var r=arguments[t];if(r!=null)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}),(function(e){e.forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})})([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(i===0)return!1;var n=t|0,a=Math.max(n>=0?n:i-Math.abs(n),0);function s(o,u){return o===u||typeof o=="number"&&typeof u=="number"&&isNaN(o)&&isNaN(u)}for(;a<i;){if(s(r[a],e))return!0;a++}return!1}});var Wa={version:"2.18.3"},Mn=Q(xr()),Qa={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text",selectFirstLayerFor:"Select first layer for {action}",selectSecondLayerFor:"Select second layer for {action}"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line",snapGuidesButton:"Show SnapGuides",unionButton:"Union layers",differenceButton:"Subtract layers"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},es={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex lschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer lschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Lnge",segmentLength:"Segment Lnge",area:"Flche",radius:"Radius",perimeter:"Umfang",height:"Hhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},ts={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},rs={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},is={tooltips:{placeMarker:"Adaug un punct",firstVertex:"Apas aici pentru a aduga primul Vertex",continueLine:"Apas aici pentru a continua desenul",finishLine:"Apas pe orice obiect pentru a finisa desenul",finishPoly:"Apas pe primul obiect pentru a finisa",finishRect:"Apas pentru a finisa",startCircle:"Apas pentru a desena un cerc",finishCircle:"Apas pentru a finisa un cerc",placeCircleMarker:"Adaug un punct"},actions:{finish:"Termin",cancel:"Anuleaz",removeLastVertex:"terge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaug o bulin",drawPolyButton:"Deseneaz un poligon",drawLineButton:"Deseneaz o linie",drawCircleButton:"Deseneaz un cerc",drawRectButton:"Deseneaz un dreptunghi",editButton:"Editeaz straturile",dragButton:"Mut straturile",cutButton:"Taie straturile",deleteButton:"terge straturile",drawCircleMarkerButton:"Deseneaz marcatorul cercului",snappingButton:"Fixai marcatorul glisat pe alte straturi i vrfuri",pinningButton:"Fixai vrfurile partajate mpreun",rotateButton:"Rotii stratul"}},ns={tooltips:{placeMarker:",   ",firstVertex:",    ",continueLine:",   ",finishLine:"     ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" "}},as={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vrtice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del crculo",finishCircle:"Presiona para finalizar el crculo",placeCircleMarker:"Presiona para colocar un marcador de crculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar ltimo vrtice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polgono",drawLineButton:"Dibujar Lnea",drawCircleButton:"Dibujar Crculo",drawRectButton:"Dibujar Rectngulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Crculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vrtices",pinningButton:"Fijar juntos los vrtices compartidos",rotateButton:"Rotar capa"}},ss={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beindigen",finishPoly:"Klik op het eerst punt om te beindigen",finishRect:"Klik om te beindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},os={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer  dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"diter des calques",dragButton:"Dplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"pingler ensemble les sommets partags",rotateButton:"Tourner des calques"}},ls={tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},us={tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:""}},hs={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vrtice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro marcador para finalizar",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do crculo",finishCircle:"Clique para finalizar o crculo",placeCircleMarker:"Clique para posicionar o marcador circular",placeText:"Clique para inserir texto"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover ltimo vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Linha Poligonal",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Recortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices compartilhados",rotateButton:"Rotacionar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Redimensionar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},En={tooltips:{placeMarker:"Clique para colocar marcador",firstVertex:"Clique para colocar primeiro vrtice",continueLine:"Clique para continuar a desenhar",finishLine:"Clique num marcador existente para terminar",finishPoly:"Clique no primeiro marcador para terminar",finishRect:"Clique para terminar",startCircle:"Clique para colocar o centro do crculo",finishCircle:"Clique para terminar o crculo",placeCircleMarker:"Clique para colocar marcador de crculo",placeText:"Clique para colocar texto"},actions:{finish:"Terminar",cancel:"Cancelar",removeLastVertex:"Remover ltimo Vrtice"},buttonTitles:{drawMarkerButton:"Desenhar Marcador",drawPolyButton:"Desenhar Polgonos",drawLineButton:"Desenhar Polilinha",drawCircleButton:"Desenhar Crculo",drawRectButton:"Desenhar Retngulo",editButton:"Editar Camadas",dragButton:"Arrastar Camadas",cutButton:"Cortar Camadas",deleteButton:"Remover Camadas",drawCircleMarkerButton:"Desenhar Marcador de Crculo",snappingButton:"Ajustar marcador arrastado a outras camadas e vrtices",pinningButton:"Unir vrtices partilhados",rotateButton:"Rodar Camadas",drawTextButton:"Desenhar Texto",scaleButton:"Escalar Camadas",autoTracingButton:"Traado Automtico de Linha"},measurements:{totalLength:"Comprimento",segmentLength:"Comprimento do Segmento",area:"rea",radius:"Raio",perimeter:"Permetro",height:"Altura",width:"Largura",coordinates:"Posio",coordinatesMarker:"Marcador de Posio"}},cs={tooltips:{placeMarker:"Kliknij, aby umieci znacznik",firstVertex:"Kliknij, aby umieci pierwszy wierzchoek",continueLine:"Kliknij, aby kontynuowa rysowanie",finishLine:"Kliknij dowolny istniejcy znacznik, aby zakoczy",finishPoly:"Kliknij pierwszy znacznik, aby zakoczy",finishRect:"Kliknij, aby zakoczy",startCircle:"Kliknij, aby umieci rodek okrgu",finishCircle:"Kliknij, aby zakoczy okrg",placeCircleMarker:"Kliknij, aby umieci znacznik okrgu",placeText:"Kliknij, aby umieci tekst"},actions:{finish:"Zakocz",cancel:"Anuluj",removeLastVertex:"Usu ostatni wierzchoek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokt",drawLineButton:"Rysuj lini",drawCircleButton:"Rysuj okrg",drawRectButton:"Rysuj prostokt",editButton:"Edytuj warstwy",dragButton:"Przecignij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usu warstwy",drawCircleMarkerButton:"Rysuj znacznik okrgy",snappingButton:"Przycignij przenoszony znacznik do innych warstw i wierzchokw",pinningButton:"Przypnij wsplne wierzchoki razem",rotateButton:"Obr warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne ledzenie linii"},measurements:{totalLength:"Dugo",segmentLength:"Dugo odcinka",area:"Obszar",radius:"Promie",perimeter:"Obwd",height:"Wysoko",width:"Szeroko",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},ds={tooltips:{placeMarker:"Klicka fr att placera markr",firstVertex:"Klicka fr att placera frsta hrnet",continueLine:"Klicka fr att fortstta rita",finishLine:"Klicka p en existerande punkt fr att slutfra",finishPoly:"Klicka p den frsta punkten fr att slutfra",finishRect:"Klicka fr att slutfra",startCircle:"Klicka fr att placera cirkelns centrum",finishCircle:"Klicka fr att slutfra cirkeln",placeCircleMarker:"Klicka fr att placera cirkelmarkr"},actions:{finish:"Slutfr",cancel:"Avbryt",removeLastVertex:"Ta bort sista hrnet"},buttonTitles:{drawMarkerButton:"Rita Markr",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkr",snappingButton:"Snpp dra markren till andra lager och hrn",pinningButton:"Fst delade hrn tillsammans",rotateButton:"Rotera lagret"}},ps={tooltips:{placeMarker:"     ",firstVertex:"       ",continueLine:"      ",finishLine:"        ",finishPoly:"       ",finishRect:"    ",startCircle:"      ",finishCircle:"      ",placeCircleMarker:"      "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"        ",pinningButton:"   ",rotateButton:"  "}},gs={tooltips:{placeMarker:"Kattintson a jell elhelyezshez",firstVertex:"Kattintson az els pont elhelyezshez",continueLine:"Kattintson a kvetkez pont elhelyezshez",finishLine:"A befejezshez kattintson egy meglv pontra",finishPoly:"A befejezshez kattintson az els pontra",finishRect:"Kattintson a befejezshez",startCircle:"Kattintson a kr kzppontjnak elhelyezshez",finishCircle:"Kattintson a kr befejezshez",placeCircleMarker:"Kattintson a krjell elhelyezshez"},actions:{finish:"Befejezs",cancel:"Mgse",removeLastVertex:"Utols pont eltvoltsa"},buttonTitles:{drawMarkerButton:"Jell rajzolsa",drawPolyButton:"Poligon rajzolsa",drawLineButton:"Vonal rajzolsa",drawCircleButton:"Kr rajzolsa",drawRectButton:"Ngyzet rajzolsa",editButton:"Elemek szerkesztse",dragButton:"Elemek mozgatsa",cutButton:"Elemek vgsa",deleteButton:"Elemek trlse",drawCircleMarkerButton:"Kr jell rajzolsa",snappingButton:"Kapcsolja a jelltt msik elemhez vagy ponthoz",pinningButton:"Kzs pontok sszektse",rotateButton:"Flia elforgatsa"}},fs={tooltips:{placeMarker:"Tryk for at placere en markr",firstVertex:"Tryk for at placere det frste punkt",continueLine:"Tryk for at fortstte linjen",finishLine:"Tryk p et eksisterende punkt for at afslutte",finishPoly:"Tryk p det frste punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkr"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markr",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Trk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkr",snappingButton:"Fastgr trukket markr til andre elementer",pinningButton:"Sammenlg delte elementer",rotateButton:"Roter laget"}},ms={tooltips:{placeMarker:"Klikk for  plassere punkt",firstVertex:"Klikk for  plassere frste punkt",continueLine:"Klikk for  tegne videre",finishLine:"Klikk p et eksisterende punkt for  fullfre",finishPoly:"Klikk frste punkt for  fullfre",finishRect:"Klikk for  fullfre",startCircle:"Klikk for  sette sirkel midtpunkt",finishCircle:"Klikk for  fullfre sirkel",placeCircleMarker:"Klikk for  plassere sirkel",placeText:"Klikk for  plassere tekst"},actions:{finish:"Fullfr",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotr objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalr objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Omrde",radius:"Radius",perimeter:"Omriss",height:"Hyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkr"}},_s={tooltips:{placeMarker:"   ",firstVertex:"    ",continueLine:"   ",finishLine:"      ",finishPoly:"     ",finishRect:"  ",startCircle:"    ",finishCircle:"    ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"      ",rotateButton:" ",drawTextButton:" ",scaleButton:"",autoTracingButton:" "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}},ys={tooltips:{placeMarker:",   ",firstVertex:",    ",continueLine:",   ",finishLine:" -    ",finishPoly:"  ,  ",finishRect:",  ",startCircle:",    ",finishCircle:",   ",placeCircleMarker:",    "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"'   ",rotateButton:" "}},vs={tooltips:{placeMarker:"areti yerletirmek iin tklayn",firstVertex:"lk tepe noktasn yerletirmek iin tklayn",continueLine:"izime devam etmek iin tklayn",finishLine:"Bitirmek iin mevcut herhangi bir iaretiyi tklayn",finishPoly:"Bitirmek iin ilk iaretiyi tklayn",finishRect:"Bitirmek iin tklayn",startCircle:"Daire merkezine yerletirmek iin tklayn",finishCircle:"Daireyi bitirmek iin tklayn",placeCircleMarker:"Daire iaretisi yerletirmek iin tklayn"},actions:{finish:"Bitir",cancel:"ptal",removeLastVertex:"Son keyi kaldr"},buttonTitles:{drawMarkerButton:"izim aretisi",drawPolyButton:"okgenler iz",drawLineButton:"oklu izgi iz",drawCircleButton:"ember iz",drawRectButton:"Dikdrtgen iz",editButton:"Katmanlar dzenle",dragButton:"Katmanlar srkle",cutButton:"Katmanlar kes",deleteButton:"Katmanlar kaldr",drawCircleMarkerButton:"Daire iaretisi iz",snappingButton:"Srklenen iaretiyi dier katmanlara ve kelere yaptr",pinningButton:"Paylalan keleri birbirine sabitle",rotateButton:"Katman dndr"}},Cs={tooltips:{placeMarker:"Kliknutm vytvote znaku",firstVertex:"Kliknutm vytvote prvn objekt",continueLine:"Kliknutm pokraujte v kreslen",finishLine:"Kliknut na libovolnou existujc znaku pro dokonen",finishPoly:"Vyberte prvn bod pro dokonen",finishRect:"Kliknte pro dokonen",startCircle:"Kliknutm pidejte sted kruhu",finishCircle:",   ",placeCircleMarker:"Kliknutm nastavte polomr"},actions:{finish:"Dokonit",cancel:"Zruit",removeLastVertex:"Zruit posledn akci"},buttonTitles:{drawMarkerButton:"Pidat znaku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit kivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdlnk",editButton:"Upravit vrstvu",dragButton:"Peneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Pidat kruhovou znaku",snappingButton:"Navzat tanou znaku k dalm vrstvm a vrcholm",pinningButton:"Spojit spolen body dohromady",rotateButton:"Otote vrstvu"}},bs={tooltips:{placeMarker:"",firstVertex:"",continueLine:"",finishLine:"",finishPoly:"",finishRect:"",startCircle:"",finishCircle:"",placeCircleMarker:"",placeText:""},actions:{finish:"",cancel:"",removeLastVertex:""},buttonTitles:{drawMarkerButton:"",drawPolyButton:"",drawLineButton:"",drawCircleButton:"",drawRectButton:"",editButton:"",dragButton:"",cutButton:"",deleteButton:"",drawCircleMarkerButton:"",snappingButton:"",pinningButton:"",rotateButton:"",drawTextButton:""}},Ls={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtmist",finishLine:"Klikkaa olemassa olevaa merkki lopettaaksesi",finishPoly:"Klikkaa ensimmist merkki lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrn keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrn",placeCircleMarker:"Klikkaa asettaaksesi ympyrmerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirr merkkej",drawPolyButton:"Piirr monikulmioita",drawLineButton:"Piirr viivoja",drawCircleButton:"Piirr ympyr",drawRectButton:"Piirr neliskulmioita",editButton:"Muokkaa",dragButton:"Siirr",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirr ympyrmerkki",snappingButton:"Kiinnit siirrettv merkki toisiin muotoihin",pinningButton:"Kiinnit jaetut muodot yhteen",rotateButton:"Knn",drawTextButton:"Piirr teksti"}},ks={tooltips:{placeMarker:"  ",firstVertex:"   ",continueLine:"  ",finishLine:"   ",finishPoly:"   ",finishRect:" ",startCircle:"    ",finishCircle:"  ",placeCircleMarker:"   ",placeText:"  "},actions:{finish:"",cancel:"",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:" ",cutButton:" ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"       ",pinningButton:"   ",rotateButton:" ",drawTextButton:" "}},xs={tooltips:{placeMarker:"   ",firstVertex:"    ",continueLine:"    ",finishLine:"    ",finishPoly:"    ",finishRect:"  ",startCircle:"    ",finishCircle:"   ",placeCircleMarker:"    ",placeText:"   "},actions:{finish:"",cancel:" ",removeLastVertex:"  "},buttonTitles:{drawMarkerButton:" ",drawPolyButton:" ",drawLineButton:" ",drawCircleButton:" ",drawRectButton:" ",editButton:" ",dragButton:"  ",cutButton:"  ",deleteButton:" ",drawCircleMarkerButton:"  ",snappingButton:"     ",pinningButton:"   ",rotateButton:" ",drawTextButton:" ",scaleButton:"  ",autoTracingButton:"  "},measurements:{totalLength:"",segmentLength:" ",area:"",radius:"",perimeter:"",height:"",width:"",coordinates:"",coordinatesMarker:" "}},Ms=En,Mr={en:Qa,de:es,it:ts,id:rs,ro:is,ru:ns,es:as,nl:ss,fr:os,pt:Ms,pt_br:hs,pt_pt:En,zh:ls,zh_tw:us,pl:cs,sv:ds,el:ps,hu:gs,da:fs,no:ms,fa:_s,ua:ys,tr:vs,cz:Cs,ja:bs,fi:Ls,ko:ks,ky:xs},Es={_globalEditModeEnabled:!1,enableGlobalEditMode(e){let t={...e};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(r=>{this._isRelevantForEdit(r)&&r.pm.enable(t)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(e=>{e.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(e=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(e)},handleLayerAdditionInGlobalEditMode(){let e=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let t in e){let r=e[t];this._isRelevantForEdit(r)&&r.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:e}){this._addedLayersEdit[L.stamp(e)]=e},_isRelevantForEdit(e){return e.pm&&!(e instanceof L.LayerGroup)&&(!L.PM.optIn&&!e.options.pmIgnore||L.PM.optIn&&e.options.pmIgnore===!1)&&!e._pmTempLayer&&e.pm.options.allowEditing}},Bs=Es,ws={_globalDragModeEnabled:!1,enableGlobalDragMode(){let e=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},e.forEach(t=>{this._isRelevantForDrag(t)&&t.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let e=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,e.forEach(t=>{t.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let e=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let t in e){let r=e[t];this._isRelevantForDrag(r)&&r.pm.enableLayerDrag()}},_layerAddedDrag({layer:e}){this._addedLayersDrag[L.stamp(e)]=e},_isRelevantForDrag(e){return e.pm&&!(e instanceof L.LayerGroup)&&(!L.PM.optIn&&!e.options.pmIgnore||L.PM.optIn&&e.options.pmIgnore===!1)&&!e._pmTempLayer&&e.pm.options.draggable}},Ds=ws,Ss={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(e=>{this._isRelevantForRemoval(e)&&(e.pm.enabled()&&e.pm.disable(),e.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(e=>{e.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(e){let t=e.target;this._isRelevantForRemoval(t)&&!t.pm.dragging()&&(t.removeFrom(this.map.pm._getContainingLayer()),t.remove(),t instanceof L.LayerGroup?(this._fireRemoveLayerGroup(t),this._fireRemoveLayerGroup(this.map,t)):(t.pm._fireRemove(t),t.pm._fireRemove(this.map,t)))},_isRelevantForRemoval(e){return e.pm&&!(e instanceof L.LayerGroup)&&(!L.PM.optIn&&!e.options.pmIgnore||L.PM.optIn&&e.options.pmIgnore===!1)&&!e._pmTempLayer&&e.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let e=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let t in e){let r=e[t];this._isRelevantForRemoval(r)&&(r.pm.enabled()&&r.pm.disable(),r.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:e}){this._addedLayersRemoval[L.stamp(e)]=e}},Ps=Ss,As={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(e=>e instanceof L.Polyline).forEach(e=>{this._isRelevantForRotate(e)&&e.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(e=>e instanceof L.Polyline).forEach(e=>{e.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(e){return e.pm&&e instanceof L.Polyline&&!(e instanceof L.LayerGroup)&&(!L.PM.optIn&&!e.options.pmIgnore||L.PM.optIn&&e.options.pmIgnore===!1)&&!e._pmTempLayer&&e.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let e=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let t in e){let r=e[t];this._isRelevantForRemoval(r)&&r.pm.enableRotate()}},_layerAddedRotate({layer:e}){this._addedLayersRotate[L.stamp(e)]=e}},Ts=As,Fs=Q(xr()),Rs={_fireDrawStart(e="Draw",t={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},e,t)},_fireDrawEnd(e="Draw",t={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},e,t)},_fireCreate(e,t="Draw",r={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:e,layer:e},t,r)},_fireCenterPlaced(e="Draw",t={}){let r=e==="Draw"?this._layer:void 0,i=e!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:r,layer:i,latlng:this._layer.getLatLng()},e,t)},_fireCut(e,t,r,i="Draw",n={}){this.__fire(e,"pm:cut",{shape:this._shape,layer:t,originalLayer:r},i,n)},_fireEdit(e=this._layer,t="Edit",r={}){this.__fire(e,"pm:edit",{layer:this._layer,shape:this.getShape()},t,r)},_fireEnable(e="Edit",t={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},e,t)},_fireDisable(e="Edit",t={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},e,t)},_fireUpdate(e="Edit",t={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},e,t)},_fireMarkerDragStart(e,t=void 0,r="Edit",i={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:e,shape:this.getShape(),indexPath:t},r,i)},_fireMarkerDrag(e,t=void 0,r="Edit",i={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:e,shape:this.getShape(),indexPath:t},r,i)},_fireMarkerDragEnd(e,t=void 0,r=void 0,i="Edit",n={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:e,shape:this.getShape(),indexPath:t,intersectionReset:r},i,n)},_fireDragStart(e="Edit",t={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},e,t)},_fireDrag(e,t="Edit",r={}){this.__fire(this._layer,"pm:drag",{...e,shape:this.getShape()},t,r)},_fireDragEnd(e="Edit",t={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},e,t)},_fireDragEnable(e="Edit",t={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},e,t)},_fireDragDisable(e="Edit",t={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},e,t)},_fireRemove(e,t=e,r="Edit",i={}){this.__fire(e,"pm:remove",{layer:t,shape:this.getShape()},r,i)},_fireVertexAdded(e,t,r,i="Edit",n={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:e,indexPath:t,latlng:r,shape:this.getShape()},i,n)},_fireVertexRemoved(e,t,r="Edit",i={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:e,indexPath:t,shape:this.getShape()},r,i)},_fireVertexClick(e,t,r="Edit",i={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:e,indexPath:t,shape:this.getShape()},r,i)},_fireIntersect(e,t=this._layer,r="Edit",i={}){this.__fire(t,"pm:intersect",{layer:this._layer,intersection:e,shape:this.getShape()},r,i)},_fireLayerReset(e,t,r="Edit",i={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:e,indexPath:t,shape:this.getShape()},r,i)},_fireChange(e,t="Edit",r={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:e,shape:this.getShape()},t,r)},_fireTextChange(e,t="Edit",r={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:e,shape:this.getShape()},t,r)},_fireTextFocus(e="Edit",t={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},e,t)},_fireTextBlur(e="Edit",t={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},e,t)},_fireSnapDrag(e,t,r="Snapping",i={}){this.__fire(e,"pm:snapdrag",t,r,i)},_fireSnap(e,t,r="Snapping",i={}){this.__fire(e,"pm:snap",t,r,i)},_fireUnsnap(e,t,r="Snapping",i={}){this.__fire(e,"pm:unsnap",t,r,i)},_fireRotationEnable(e,t,r="Rotation",i={}){this.__fire(e,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},r,i)},_fireRotationDisable(e,t="Rotation",r={}){this.__fire(e,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},t,r)},_fireRotationStart(e,t,r="Rotation",i={}){this.__fire(e,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:t},r,i)},_fireRotation(e,t,r,i=this._rotationLayer,n="Rotation",a={}){this.__fire(e,"pm:rotate",{layer:i,helpLayer:this._layer,startAngle:this._startAngle,angle:i.pm.getAngle(),angleDiff:t,oldLatLngs:r,newLatLngs:i.getLatLngs()},n,a)},_fireRotationEnd(e,t,r,i="Rotation",n={}){this.__fire(e,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:t,angle:this._rotationLayer.pm.getAngle(),originLatLngs:r,newLatLngs:this._rotationLayer.getLatLngs()},i,n)},_fireActionClick(e,t,r,i="Toolbar",n={}){this.__fire(this._map,"pm:actionclick",{text:e.text,action:e,btnName:t,button:r},i,n)},_fireButtonClick(e,t,r="Toolbar",i={}){this.__fire(this._map,"pm:buttonclick",{btnName:e,button:t},r,i)},_fireLangChange(e,t,r,i,n="Global",a={}){this.__fire(this.map,"pm:langchange",{oldLang:e,activeLang:t,fallback:r,translations:i},n,a)},_fireGlobalDragModeToggled(e,t="Global",r={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:e,map:this.map},t,r)},_fireGlobalEditModeToggled(e,t="Global",r={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:e,map:this.map},t,r)},_fireGlobalRemovalModeToggled(e,t="Global",r={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:e,map:this.map},t,r)},_fireGlobalCutModeToggled(e="Global",t={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},e,t)},_fireGlobalDrawModeToggled(e="Global",t={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},e,t)},_fireGlobalRotateModeToggled(e="Global",t={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},e,t)},_fireRemoveLayerGroup(e,t=e,r="Edit",i={}){this.__fire(e,"pm:remove",{layer:t,shape:void 0},r,i)},_fireKeyeventEvent(e,t,r,i="Global",n={}){this.__fire(this.map,"pm:keyevent",{event:e,eventType:t,focusOn:r},i,n)},__fire(e,t,r,i,n={}){r=(0,Fs.default)(r,n,{source:i}),L.PM.Utils._fireEvent(e,t,r)}},ui=Rs,Os=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(e){this.map=e,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),e.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(e){let t="document";this.map.getContainer().contains(e.target)&&(t="map");let r={event:e,eventType:e.type,focusOn:t};this._lastEvents[e.type]=r,this._lastEvents.current=r,this.map.pm._fireKeyeventEvent(e,e.type,t)},_onBlur(e){e.altKey=!1;let t={event:e,eventType:e.type,focusOn:"document"};this._lastEvents[e.type]=t,this._lastEvents.current=t},getLastKeyEvent(e="current"){return this._lastEvents[e]},isShiftKeyPressed(){return this._lastEvents.current?.event.shiftKey},isAltKeyPressed(){return this._lastEvents.current?.event.altKey},isCtrlKeyPressed(){return this._lastEvents.current?.event.ctrlKey},isMetaKeyPressed(){return this._lastEvents.current?.event.metaKey},getPressedKey(){return this._lastEvents.current?.event.key}}),Is=Os,Bn=Q(Gt());function ve(e){let t=L.PM.activeLang;return(0,Bn.default)(Mr[t],e)||(0,Bn.default)(Mr.en,e)||e}function Gi(e){for(let t=0;t<e.length;t+=1){let r=e[t];if(Array.isArray(r)){if(Gi(r))return!0}else if(r!=null&&r!=="")return!0}return!1}function hi(e){return e.reduce((t,r)=>{if(r.length!==0){let i=Array.isArray(r)?hi(r):r;Array.isArray(i)?i.length!==0&&t.push(i):t.push(i)}return t},[])}function js(e,t,r){let i={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a:n,b:a,f:s}=i,o=e.lng,u=e.lat,h=r,v=Math.PI,_=t*v/180,R=Math.sin(_),I=Math.cos(_),Y=(1-s)*Math.tan(u*v/180),re=1/Math.sqrt(1+Y*Y),ae=Y*re,_e=Math.atan2(Y,I),y=re*R,k=1-y*y,S=k*(n*n-a*a)/(a*a),j=1+S/16384*(4096+S*(-768+S*(320-175*S))),P=S/1024*(256+S*(-128+S*(74-47*S))),O=h/(a*j),l=2*Math.PI,d,g,p;for(;Math.abs(O-l)>1e-12;){d=Math.cos(2*_e+O),g=Math.sin(O),p=Math.cos(O);let K=P*g*(d+P/4*(p*(-1+2*d*d)-P/6*d*(-3+4*g*g)*(-3+4*d*d)));l=O,O=h/(a*j)+K}let f=ae*g-re*p*I,m=Math.atan2(ae*p+re*g*I,(1-s)*Math.sqrt(y*y+f*f)),E=Math.atan2(g*R,re*p-ae*g*I),x=s/16*k*(4+s*(4-3*k)),w=E-(1-x)*s*y*(O+x*g*(d+x*p*(-1+2*d*d))),F=o+w*180/v,T=m*180/v;return L.latLng(F,T)}function wn(e,t,r,i,n=!0){let a,s,o,u=[];for(let h=0;h<r;h+=1){if(n)a=h*360/r+i,s=js(e,a,t),o=L.latLng(s.lng,s.lat);else{let v=e.lat+Math.cos(2*h*Math.PI/r)*t,_=e.lng+Math.sin(2*h*Math.PI/r)*t;o=L.latLng(v,_)}u.push(o)}return u}function Ns(e,t,r){t=(t+360)%360;let i=Math.PI/180,n=180/Math.PI,{R:a}=L.CRS.Earth,s=e.lng*i,o=e.lat*i,u=t*i,h=Math.sin(o),v=Math.cos(o),_=Math.cos(r/a),R=Math.sin(r/a),I=Math.asin(h*_+v*R*Math.cos(u)),Y=s+Math.atan2(Math.sin(u)*R*v,_-h*Math.sin(I));Y*=n;let re=Y-360,ae=Y<-180?Y+360:Y;return Y=Y>180?re:ae,L.latLng([I*n,Y])}function zi(e,t,r){let i=e.latLngToContainerPoint(t),n=e.latLngToContainerPoint(r),a=Math.atan2(n.y-i.y,n.x-i.x)*180/Math.PI+90;return a+=a<0?360:0,a}function ci(e,t,r,i){let n=zi(e,t,r);return Ns(t,n,i)}function Gs(e,t,r="asc"){if(!t||Object.keys(t).length===0)return(u,h)=>u-h;let i=Object.keys(t),n,a=i.length-1,s={};for(;a>=0;)n=i[a],s[n.toLowerCase()]=t[n],a-=1;function o(u){if(u instanceof L.Marker)return"Marker";if(u instanceof L.Circle)return"Circle";if(u instanceof L.CircleMarker)return"CircleMarker";if(u instanceof L.Rectangle)return"Rectangle";if(u instanceof L.Polygon)return"Polygon";if(u instanceof L.Polyline)return"Line"}return(u,h)=>{let v,_;if(v=o(u.layer).toLowerCase(),_=o(h.layer).toLowerCase(),!v||!_)return 0;let R=v in s?s[v]:Number.MAX_SAFE_INTEGER,I=_ in s?s[_]:Number.MAX_SAFE_INTEGER,Y=0;return R<I?Y=-1:R>I&&(Y=1),r==="desc"?Y*-1:Y}}function or(e,t=e.getLatLngs()){return e instanceof L.Polygon?L.polygon(t).getLatLngs():L.polyline(t).getLatLngs()}function Dn(e,t){if(t.options.crs?.projection?.MAX_LATITUDE){let r=t.options.crs?.projection?.MAX_LATITUDE;e.lat=Math.max(Math.min(r,e.lat),-r)}return e}function Er(e){return e.options.renderer||e._map&&(e._map._getPaneRenderer(e.options.pane)||e._map.options.renderer||e._map._renderer)||e._renderer}var zs=L.Class.extend({includes:[Bs,Ds,Ps,Ts,ui],initialize(e){this.map=e,this.Draw=new L.PM.Draw(e),this.Toolbar=new L.PM.Toolbar(e),this.Keyboard=Is(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(e)},setLang(e="en",t,r="en"){if(e=e.trim().toLowerCase(),!/^[a-z]{2}$/.test(e)){let n=e.replace(/[-_\s]/g,"-").replace(/^(\w{2})$/,"$1-").match(/([a-z]{2})-?([a-z]{2})?/);if(n){let a=[`${n[1]}_${n[2]}`,`${n[1]}`];for(let s of a)if(Mr[s]){e=s;break}}}let i=L.PM.activeLang;t&&(Mr[e]=(0,Mn.default)(Mr[r],t)),L.PM.activeLang=e,this.map.pm.Toolbar.reinit(),this._fireLangChange(i,e,r,Mr[e])},addControls(e){this.Toolbar.addControls(e)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(e="Polygon",t){e==="Poly"&&(e="Polygon"),this.Draw.enable(e,t)},disableDraw(e="Polygon"){e==="Poly"&&(e="Polygon"),this.Draw.disable(e)},setPathOptions(e,t={}){let r=t.ignoreShapes||[],i=t.merge||!1;this.map.pm.Draw.shapes.forEach(n=>{r.indexOf(n)===-1&&this.map.pm.Draw[n].setPathOptions(e,i)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(e){let t=(0,Mn.default)(this.globalOptions,e);t.editable&&(t.resizeableCircleMarker=t.editable,delete t.editable);let r=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!t.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),r=!0);let i=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizeableCircle!=!!t.resizeableCircle&&(this.map.pm.Draw.Circle.disable(),i=!0),this.map.pm.Draw.shapes.forEach(n=>{this.map.pm.Draw[n].setOptions(t)}),r&&this.map.pm.Draw.CircleMarker.enable(),i&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(n=>{n.pm.setOptions(t)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=t,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(e=>{e.pm.enabled()&&e.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(e){return this.Draw.Cut.enable(e)},toggleGlobalCutMode(e){return this.Draw.Cut.toggle(e)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(e=!1){let t=L.PM.Utils.findLayers(this.map);if(!e)return t;let r=L.featureGroup();return r._pmTempLayer=!0,t.forEach(i=>{r.addLayer(i)}),r},getGeomanDrawLayers(e=!1){let t=L.PM.Utils.findLayers(this.map).filter(i=>i._drawnByGeoman===!0);if(!e)return t;let r=L.featureGroup();return r._pmTempLayer=!0,t.forEach(i=>{r.addLayer(i)}),r},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(e){this._touchEventCounter===0&&(L.DomEvent.on(e,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(e,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(e){this._touchEventCounter===1&&(L.DomEvent.off(e,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(e,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(e){Er(this.map)._onMouseMove(this._createMouseEvent("mousemove",e))},_canvasTouchClick(e){let t="";e.type==="touchstart"||e.type==="pointerdown"?t="mousedown":(e.type==="touchend"||e.type==="pointerup"||e.type==="touchcancel"||e.type==="pointercancel")&&(t="mouseup"),t&&Er(this.map)._onClick(this._createMouseEvent(t,e))},_createMouseEvent(e,t){let r,i=t.touches[0]||t.changedTouches[0];try{r=new MouseEvent(e,{bubbles:t.bubbles,cancelable:t.cancelable,view:t.view,detail:i.detail,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,button:t.button,relatedTarget:t.relatedTarget})}catch{r=document.createEvent("MouseEvents"),r.initMouseEvent(e,t.bubbles,t.cancelable,t.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget)}return r}}),$s=zs,Us=L.Control.extend({includes:[ui],options:{position:"topleft",disableByOtherButtons:!0},initialize(e){this._button=L.Util.extend({},this.options,e)},onAdd(e){return this._map=e,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this._renderButton(),this._container},_renderButton(){let e=this.buttonsDomNode;this.buttonsDomNode=this._makeButton(this._button),e?e.replaceWith(this.buttonsDomNode):this._container.appendChild(this.buttonsDomNode)},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(e){return typeof e=="boolean"?this._button.toggleStatus=e:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._updateActiveAction(this._button),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled(),this._updateActiveAction(this._button)},_triggerClick(e){e&&e.preventDefault(),!this._button.disabled&&(this._button.onClick(e,{button:this,event:e}),this._clicked(e),this._button.afterClick(e,{button:this,event:e}))},_makeButton(e){let t=this.options.position.indexOf("right")>-1?"pos-right":"",r=L.DomUtil.create("div",`button-container  ${t}`,this._container);e.title&&r.setAttribute("title",e.title);let i=L.DomUtil.create("a","leaflet-buttons-control-button",r);i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.href="#";let n=L.DomUtil.create("div",`leaflet-pm-actions-container ${t}`,r),a=e.actions,s={cancel:{text:ve("actions.cancel"),title:ve("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:ve("actions.finish"),title:ve("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:ve("actions.removeLastVertex"),title:ve("actions.removeLastVertex"),onClick(){this._map.pm.Draw[e.jsClass]._removeLastVertex()}},finish:{text:ve("actions.finish"),title:ve("actions.finish"),onClick(u){this._map.pm.Draw[e.jsClass]._finishShape(u)}}};e._preparedActions=a.map(u=>{let h=typeof u=="string"?u:u.name,v;if(s[h])v=s[h];else if(u.text)v=u;else return v;let _=L.DomUtil.create("a",`leaflet-pm-action ${t} action-${h}`,n);if(_.setAttribute("role","button"),_.setAttribute("tabindex","0"),_.href="#",v.title&&(_.title=v.title),_.innerHTML=v.text,L.DomEvent.disableClickPropagation(_),L.DomEvent.on(_,"click",L.DomEvent.stop),v._node=_,!e.disabled&&v.onClick){let R=I=>{I.preventDefault();let Y="",{buttons:re}=this._map.pm.Toolbar;for(let ae in re)if(re[ae]._button===e){Y=ae;break}this._fireActionClick(v,Y,e)};L.DomEvent.addListener(_,"click",R,this),L.DomEvent.addListener(_,"click",v.onClick,this),L.DomEvent.addListener(_,"click",()=>this._updateActiveAction(e))}return v}),this._updateActiveAction(e),e.toggleStatus&&L.DomUtil.addClass(r,"active");let o=L.DomUtil.create("div","control-icon",i);return e.iconUrl&&o.setAttribute("src",e.iconUrl),e.className&&L.DomUtil.addClass(o,e.className),L.DomEvent.disableClickPropagation(i),L.DomEvent.on(i,"click",L.DomEvent.stop),e.disabled||(L.DomEvent.addListener(i,"click",this._onBtnClick,this),L.DomEvent.addListener(i,"click",this._triggerClick,this)),e.disabled&&(L.DomUtil.addClass(i,"pm-disabled"),i.setAttribute("aria-disabled","true")),r},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let e="",{buttons:t}=this._map.pm.Toolbar;for(let r in t)if(t[r]._button===this._button){e=r;break}this._fireButtonClick(e,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let e="pm-disabled",t=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(t,e),t.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(t,e),t.setAttribute("aria-disabled","false"))},_updateActiveAction(e){e._preparedActions?.forEach(t=>{t?._node&&(t.isActive&&t.isActive.call(this)?L.DomUtil.addClass(t._node,"active-action"):L.DomUtil.removeClass(t._node,"active-action"))})}}),Vs=Us;L.Control.PMButton=Vs;var Hs=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(e){this.customButtons=[],this.options.positions={draw:"",edit:"",options:"",custom:""},this.init(e)},reinit(){let e=this.isVisible;this.removeControls(),this._defineButtons(),e&&this.addControls()},init(e){this.map=e,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(e){let t=`${e}Container`;return this[t]||(this[t]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${e} leaflet-bar leaflet-control`)),this[t]},getButtons(){return this.buttons},addControls(e=this.options){typeof e.editPolygon<"u"&&(e.editMode=e.editPolygon),typeof e.deleteLayer<"u"&&(e.removalMode=e.deleteLayer),L.Util.setOptions(this,e),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let e=this.getButtons(),t={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let r in e){let i=e[r];L.Util.setOptions(i,{className:t.geomanIcons[r]})}},removeControls(){let e=this.getButtons();for(let t in e)e[t].remove();this.isVisible=!1},toggleControls(e=this.options){this.isVisible?this.removeControls():this.addControls(e)},_addButton(e,t){return this.buttons[e]=t,this.options[e]=!!this.options[e]||!1,this.buttons[e]},triggerClickOnToggledButtons(e){for(let t in this.buttons){let r=this.buttons[t];r._button.disableByOtherButtons&&r!==e&&r.toggled()&&r._triggerClick()}},toggleButton(e,t,r=!0){e==="editPolygon"&&(e="editMode"),e==="deleteLayer"&&(e="removalMode");let i=e;return r&&this.triggerClickOnToggledButtons(this.buttons[i]),this.buttons[i]?this.buttons[i].toggle(t):!1},_defineButtons(){let e={className:"control-icon leaflet-pm-icon-marker",title:ve("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},t={title:ve("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},r={className:"control-icon leaflet-pm-icon-polyline",title:ve("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={title:ve("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},n={title:ve("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},a={title:ve("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},s={title:ve("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},o={title:ve("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},u={title:ve("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},h={title:ve("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},v={title:ve("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},_={className:"control-icon leaflet-pm-icon-text",title:ve("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(R,I)=>{this.map.pm.Draw[I.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(e)),this._addButton("drawPolyline",new L.Control.PMButton(r)),this._addButton("drawRectangle",new L.Control.PMButton(a)),this._addButton("drawPolygon",new L.Control.PMButton(t)),this._addButton("drawCircle",new L.Control.PMButton(i)),this._addButton("drawCircleMarker",new L.Control.PMButton(n)),this._addButton("drawText",new L.Control.PMButton(_)),this._addButton("editMode",new L.Control.PMButton(s)),this._addButton("dragMode",new L.Control.PMButton(o)),this._addButton("cutPolygon",new L.Control.PMButton(u)),this._addButton("removalMode",new L.Control.PMButton(h)),this._addButton("rotateMode",new L.Control.PMButton(v))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let e=this.getButtons(),t=[];this.options.drawControls===!1&&(t=t.concat(Object.keys(e).filter(r=>!e[r]._button.tool))),this.options.editControls===!1&&(t=t.concat(Object.keys(e).filter(r=>e[r]._button.tool==="edit"))),this.options.optionsControls===!1&&(t=t.concat(Object.keys(e).filter(r=>e[r]._button.tool==="options"))),this.options.customControls===!1&&(t=t.concat(Object.keys(e).filter(r=>e[r]._button.tool==="custom")));for(let r in e)if(this.options[r]&&t.indexOf(r)===-1){let i=e[r]._button.tool;i||(i="draw"),e[r].setPosition(this._getBtnPosition(i)),e[r].addTo(this.map)}},_getBtnPosition(e){return this.options.positions&&this.options.positions[e]?this.options.positions[e]:this.options.position},setBlockPosition(e,t){this.options.positions[e]=t,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(e,t){if(t)typeof t!="object"&&(t={name:t});else throw new TypeError("Button has no name");let r=this._btnNameMapping(e);if(!t.name)throw new TypeError("Button has no name");if(this.buttons[t.name])throw new TypeError("Button with this name already exists");let i=this.map.pm.Draw.createNewDrawInstance(t.name,r);t={...this.buttons[r]._button,...t};let n=this.createCustomControl(t);return{drawInstance:i,control:n}},createCustomControl(e){if(!e.name)throw new TypeError("Button has no name");if(this.buttons[e.name])throw new TypeError("Button with this name already exists");e.onClick||(e.onClick=()=>{}),e.afterClick||(e.afterClick=()=>{}),e.toggle!==!1&&(e.toggle=!0),e.block&&(e.block=e.block.toLowerCase()),(!e.block||e.block==="draw")&&(e.block=""),e.className?e.className.indexOf("control-icon")===-1&&(e.className=`control-icon ${e.className}`):e.className="control-icon";let t={tool:e.block,className:e.className,title:e.title||"",jsClass:e.name,onClick:e.onClick,afterClick:e.afterClick,doToggle:e.toggle,toggleStatus:!1,disableOtherButtons:e.disableOtherButtons??!0,disableByOtherButtons:e.disableByOtherButtons??!0,cssToggle:e.toggle,position:this.options.position,actions:e.actions||[],disabled:!!e.disabled};this.options[e.name]!==!1&&(this.options[e.name]=!0);let r=this._addButton(e.name,new L.Control.PMButton(t));return this.changeControlOrder(),r},controlExists(e){return!!this.getButton(e)},getButton(e){return this.getButtons()[e]},getButtonsInBlock(e){let t={};if(e)for(let r in this.getButtons()){let i=this.getButtons()[r];(i._button.tool===e||e==="draw"&&!i._button.tool)&&(t[r]=i)}return t},changeControlOrder(e=[]){let t=this._shapeMapping(),r=[];e.forEach(a=>{t[a]?r.push(t[a]):r.push(a)});let i=this.getButtons(),n={};r.forEach(a=>{i[a]&&(n[a]=i[a])}),Object.keys(i).filter(a=>!i[a]._button.tool||i[a]._button.tool==="draw").forEach(a=>{r.indexOf(a)===-1&&(n[a]=i[a])}),Object.keys(i).filter(a=>i[a]._button.tool==="edit").forEach(a=>{r.indexOf(a)===-1&&(n[a]=i[a])}),Object.keys(i).filter(a=>i[a]._button.tool==="options").forEach(a=>{r.indexOf(a)===-1&&(n[a]=i[a])}),Object.keys(i).filter(a=>i[a]._button.tool==="custom").forEach(a=>{r.indexOf(a)===-1&&(n[a]=i[a])}),Object.keys(i).forEach(a=>{r.indexOf(a)===-1&&(n[a]=i[a])}),this.map.pm.Toolbar.buttons=n,this._showHideButtons()},getControlOrder(){let e=this.getButtons(),t=[];for(let r in e)t.push(r);return t},changeActionsOfControl(e,t){let r=this._btnNameMapping(e);if(!r)throw new TypeError("No name passed");if(!t)throw new TypeError("No actions passed");if(!this.buttons[r])throw new TypeError("Button with this name not exists");this.buttons[r]._button.actions=t,this.changeControlOrder()},setButtonDisabled(e,t){let r=this._btnNameMapping(e);t?this.buttons[r].disable():this.buttons[r].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(e){let t=this._shapeMapping();return t[e]?t[e]:e}}),Ks=Hs,qs=Q(xr()),Ys={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(e){e.forEach(t=>{if(Array.isArray(t)){this._assignEvents(t);return}t.off("drag",this._handleSnapping,this),t.on("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(e){if(e){let t=e.target;t._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(t=>{t.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(e){let t=e.target;if(t._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),e?.originalEvent?.altKey||this._map?.pm?.Keyboard.isAltKeyPressed()||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let r=this._calcClosestLayer(t.getLatLng(),this._snapList);if(Object.keys(r).length===0)return!1;let i=r.layer instanceof L.Marker||r.layer instanceof L.CircleMarker||!this.options.snapSegment,n;i?n=r.latlng:n=this._checkPrioritiySnapping(r);let a=this.options.snapDistance,s={marker:t,shape:this._shape,snapLatLng:n,segment:r.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:r.layer,distance:r.distance};if(this._fireSnapDrag(s.marker,s),this._fireSnapDrag(this._layer,s),r.distance<a){t._orgLatLng=t.getLatLng(),t.setLatLng(n),t._snapped=!0,t._snapInfo=s;let o=()=>{this._snapLatLng=n,this._fireSnap(t,s),this._fireSnap(this._layer,s)},u=this._snapLatLng||{},h=n||{};(u.lat!==h.lat||u.lng!==h.lng)&&o()}else this._snapLatLng&&(this._unsnap(s),t._snapped=!1,t._snapInfo=void 0,this._fireUnsnap(s.marker,s),this._fireUnsnap(this._layer,s));return!0},_createSnapList(){let e=[],t=[],r=this._map;r.off("layerremove",this._handleSnapLayerRemoval,this),r.on("layerremove",this._handleSnapLayerRemoval,this),r.eachLayer(i=>{if((i instanceof L.Polyline||i instanceof L.Marker||i instanceof L.CircleMarker||i instanceof L.ImageOverlay)&&i.options.snapIgnore!==!0){if(i.options.snapIgnore===void 0&&(!L.PM.optIn&&i.options.pmIgnore===!0||L.PM.optIn&&i.options.pmIgnore!==!1))return;(i instanceof L.Circle||i instanceof L.CircleMarker)&&i.pm&&i.pm._hiddenPolyCircle?e.push(i.pm._hiddenPolyCircle):i instanceof L.ImageOverlay&&(i=L.rectangle(i.getBounds())),e.push(i);let n=L.polyline([],{color:"red",pmIgnore:!0});n._pmTempLayer=!0,t.push(n),(i instanceof L.Circle||i instanceof L.CircleMarker)&&t.push(n)}}),e=e.filter(i=>this._layer!==i),e=e.filter(i=>i._latlng||i._latlngs&&Gi(i._latlngs)),e=e.filter(i=>!i._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let i=L.polyline([],{color:"red",pmIgnore:!0});i._pmTempLayer=!0,t.push(i)}),this._snapList=e.concat(this._otherSnapLayers)):this._snapList=e,this.debugIndicatorLines=t},_handleSnapLayerRemoval({layer:e}){if(!e._leaflet_id)return;let t=this._snapList.findIndex(r=>r._leaflet_id===e._leaflet_id);t>-1&&this._snapList.splice(t,1)},_calcClosestLayer(e,t){return this._calcClosestLayers(e,t,1)[0]},_calcClosestLayers(e,t,r=1){let i=[],n={};t.forEach((s,o)=>{if(s._parentCopy&&s._parentCopy===this._layer||s.getLatLngs?.().flat(5).length<2)return;let u=this._calcLayerDistances(e,s);if(u.distance=Math.floor(u.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[o]){let h=L.polyline([],{color:"red",pmIgnore:!0});h._pmTempLayer=!0,this.debugIndicatorLines[o]=h}this.debugIndicatorLines[o].setLatLngs([e,u.latlng])}r===1&&(n.distance===void 0||u.distance-5<=n.distance)?(u.distance+5<n.distance&&(i=[]),n=u,n.layer=s,i.push(n)):r!==1&&(n={},n=u,n.layer=s,i.push(n))}),r!==1&&(i=i.sort((s,o)=>s.distance-o.distance)),r===-1&&(r=i.length);let a=this._getClosestLayerByPriority(i,r);return L.Util.isArray(a)?a:[a]},_calcLayerDistances(e,t){let r=this._map,i=t instanceof L.Marker||t instanceof L.CircleMarker,n=t instanceof L.Polygon,a=e;if(i){let s=t.getLatLng();return{latlng:{...s},distance:this._getDistance(r,s,a)}}return this._calcLatLngDistances(a,t.getLatLngs(),r,n)},_calcLatLngDistances(e,t,r,i=!1){let n,a,s,o=u=>{u.forEach((h,v)=>{if(Array.isArray(h)){o(h);return}if(this.options.snapSegment){let _=h,R;i?R=v+1===u.length?0:v+1:R=v+1===u.length?void 0:v+1;let I=u[R];if(I){let Y=this._getDistanceToSegment(r,e,_,I);(a===void 0||Y<a)&&(a=Y,s=[_,I])}}else{let _=this._getDistance(r,e,h);(a===void 0||_<a)&&(a=_,n=h)}})};return o(t),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(r,e,s[0],s[1])},segment:s,distance:a}:{latlng:n,distance:a}},_getClosestLayerByPriority(e,t=1){e=e.sort((s,o)=>s._leaflet_id-o._leaflet_id);let r=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],i=this._map.pm.globalOptions.snappingOrder||[],n=0,a={};return i.concat(r).forEach(s=>{a[s]||(n+=1,a[s]=n)}),e.sort(Gs("instanceofShape",a)),t===1?e[0]||{}:e.slice(0,t)},_checkPrioritiySnapping(e){let t=this._map,r=e.segment[0],i=e.segment[1],n=e.latlng,a=n;if(this.options.snapVertex){let s=this._getDistance(t,r,n),o=this._getDistance(t,i,n),u=s<o?r:i,h=s<o?s:o;if(this.options.snapMiddle){let _=L.PM.Utils.calcMiddleLatLng(t,r,i),R=this._getDistance(t,_,n);R<s&&R<o&&(u=_,h=R)}let v=this.options.snapDistance;h<v&&(a=u)}return{...a}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(e,t,r,i){let n=e.getMaxZoom();n===1/0&&(n=e.getZoom());let a=e.project(t,n),s=e.project(r,n),o=e.project(i,n),u=L.LineUtil.closestPointOnSegment(a,s,o);return e.unproject(u,n)},_getDistanceToSegment(e,t,r,i){let n=e.latLngToContainerPoint(t),a=e.latLngToContainerPoint(r),s=e.latLngToContainerPoint(i);return L.LineUtil.pointToSegmentDistance(n,a,s)},_getDistance(e,t,r){return e.latLngToContainerPoint(t).distanceTo(e.latLngToContainerPoint(r))}},Sn=Ys,Xs=L.Class.extend({includes:[Sn,ui],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizeableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0,textOptions:{text:null,focusAfterDraw:null,removeIfEmpty:null,className:null},snapVertex:!0},setOptions(e){L.Util.setOptions(this,e),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(e){let t=new L.Icon.Default;t.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=t,this._map=e,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(r=>{this[r]=new L.PM.Draw[r](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(e,t=!1){t?this.options.pathOptions=(0,qs.default)(this.options.pathOptions,e):this.options.pathOptions=e},getShapes(){return this.shapes},getShape(){return this._shape},enable(e,t){if(!e)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[e].enable(t)},disable(){this.shapes.forEach(e=>{this[e].disable()})},addControls(){this.shapes.forEach(e=>{this[e].addButton()})},getActiveShape(){let e;return this.shapes.forEach(t=>{this[t]._enabled&&(e=t)}),e},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let e=[];this._map.eachLayer(t=>{(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle||t instanceof L.CircleMarker||t instanceof L.ImageOverlay)&&(t._pmTempLayer||e.push(t))}),this._enabled?e.forEach(t=>{L.PM.Utils.disablePopup(t)}):e.forEach(t=>{L.PM.Utils.enablePopup(t)})},createNewDrawInstance(e,t){let r=this._getShapeFromBtnName(t);if(this[e])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[r])throw new TypeError(`There is no class L.PM.Draw.${r}`);return this[e]=new L.PM.Draw[r](this._map),this[e].toolbarButtonName=e,this[e]._shape=e,this.shapes.push(e),this[t]&&this[e].setOptions(this[t].options),this[e].setOptions(this[e].options),this[e]},_getShapeFromBtnName(e){let t={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return t[e]?t[e]:this[e]?this[e]._shape:e},_finishLayer(e){e.pm&&(e.pm.setOptions(this.options),e.pm._shape=this._shape,e.pm._map=this._map),this._addDrawnLayerProp(e)},_addDrawnLayerProp(e){e._drawnByGeoman=!0},_setPane(e,t){t==="layerPane"?e.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":t==="vertexPane"?e.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":t==="markerPane"&&(e.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),at=Xs;at.Marker=at.extend({initialize(e){this._map=e,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(e){L.Util.setOptions(this,e),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(ve("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(e=>{this.isRelevantMarker(e)&&e.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(e){this.enabled()?this.disable():this.enable(e)},isRelevantMarker(e){return e instanceof L.Marker&&e.pm&&!e._pmTempLayer&&!e.pm._initTextMarker},_syncHintMarker(e){if(this._hintMarker.setLatLng(e.latlng),this.options.snappable){let t=e;t.target=this._hintMarker,this._handleSnapping(t)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(e){if(!e.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng);let t=this._hintMarker.getLatLng(),r=new L.Marker(t,this.options.markerStyle);this._setPane(r,"markerPane"),this._finishLayer(r),r.pm||(r.options.draggable=!1),r.addTo(this._map.pm._getContainingLayer()),r.pm&&this.options.markerEditable?r.pm.enable():r.dragging&&r.dragging.disable(),this._fireCreate(r),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){this.options.markerStyle?.icon&&this._hintMarker?.setIcon(this.options.markerStyle.icon)}});var yt=63710088e-1,Pn={centimeters:yt*100,centimetres:yt*100,degrees:yt/111325,feet:yt*3.28084,inches:yt*39.37,kilometers:yt/1e3,kilometres:yt/1e3,meters:yt,metres:yt,miles:yt/1609.344,millimeters:yt*1e3,millimetres:yt*1e3,nauticalmiles:yt/1852,radians:1,yards:yt*1.0936};function Br(e,t,r){r===void 0&&(r={});var i={type:"Feature"};return(r.id===0||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=t||{},i.geometry=e,i}function wr(e,t,r){if(r===void 0&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!An(e[0])||!An(e[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:e};return Br(i,t,r)}function Gr(e,t,r){if(r===void 0&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:e};return Br(i,t,r)}function lr(e,t){t===void 0&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function Zs(e,t){t===void 0&&(t="kilometers");var r=Pn[t];if(!r)throw new Error(t+" units is invalid");return e*r}function Js(e,t){t===void 0&&(t="kilometers");var r=Pn[t];if(!r)throw new Error(t+" units is invalid");return e/r}function $i(e){var t=e%(2*Math.PI);return t*180/Math.PI}function zt(e){var t=e%360;return t*Math.PI/180}function An(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function di(e){var t,r,i={type:"FeatureCollection",features:[]};if(e.type==="Feature"?r=e.geometry:r=e,r.type==="LineString")t=[r.coordinates];else if(r.type==="MultiLineString")t=r.coordinates;else if(r.type==="MultiPolygon")t=[].concat.apply([],r.coordinates);else if(r.type==="Polygon")t=r.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return t.forEach(function(n){t.forEach(function(a){for(var s=0;s<n.length-1;s++)for(var o=s;o<a.length-1;o++)if(!(n===a&&(Math.abs(s-o)===1||s===0&&o===n.length-2&&n[s][0]===n[n.length-1][0]&&n[s][1]===n[n.length-1][1]))){var u=Ws(n[s][0],n[s][1],n[s+1][0],n[s+1][1],a[o][0],a[o][1],a[o+1][0],a[o+1][1]);u&&i.features.push(wr([u[0],u[1]]))}})}),i}function Ws(e,t,r,i,n,a,s,o){var u,h,v,_,R,I={x:null,y:null,onLine1:!1,onLine2:!1};return u=(o-a)*(r-e)-(s-n)*(i-t),u===0?I.x!==null&&I.y!==null?I:!1:(h=t-a,v=e-n,_=(s-n)*h-(o-a)*v,R=(r-e)*h-(i-t)*v,h=_/u,v=R/u,I.x=e+h*(r-e),I.y=t+h*(i-t),h>=0&&h<=1&&(I.onLine1=!0),v>=0&&v<=1&&(I.onLine2=!0),I.onLine1&&I.onLine2?[I.x,I.y]:!1)}at.Line=at.extend({initialize(e){this._map=e,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(e){L.Util.setOptions(this,e),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(ve("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(e){this.enabled()?this.disable():this.enable(e)},_syncHintLine(){let e=this._layer.getLatLngs();if(e.length>0){let t=e[e.length-1];this._hintline.setLatLngs([t,this._hintMarker.getLatLng()])}},_syncHintMarker(e){if(this._hintMarker.setLatLng(e.latlng),this.options.snappable){let r=e;r.target=this._hintMarker,this._handleSnapping(r)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let t=this._layer._defaultShape().slice();t.push(this._hintMarker.getLatLng()),this._change(t)},hasSelfIntersection(){return di(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(e,t){let r=L.polyline(this._layer.getLatLngs());e&&(t||(t=this._hintMarker.getLatLng()),r.addLatLng(t));let i=di(r.toGeoJSON(15));this._doesSelfIntersect=i.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(i,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(e){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,e.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng);let t=this._hintMarker.getLatLng(),r=this._layer.getLatLngs(),i=r[r.length-1];if(t.equals(r[0])||r.length>0&&t.equals(i)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:t,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(t);let n=this._createMarker(t);this._setTooltipText(),this._setHintLineAfterNewVertex(t),this._fireVertexAdded(n,void 0,t,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(e)},_setHintLineAfterNewVertex(e){this._hintline.setLatLngs([e,e])},_removeLastVertex(){let e=this._markers;if(e.length<=1){this.disable();return}let t=this._layer.getLatLngs(),r=e[e.length-1],{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(e,r);e.pop(),this._layerGroup.removeLayer(r);let n=e[e.length-1],a=t.indexOf(n.getLatLng());t=t.slice(0,a+1),this._layer.setLatLngs(t),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(r,i,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let e=this._layer.getLatLngs();if(e.length<=1)return;let t=L.polyline(e,this.options.pathOptions);this._setPane(t,"layerPane"),this._finishLayer(t),t.addTo(this._map.pm._getContainingLayer()),this._fireCreate(t),this.options.snappable&&this._cleanupSnapping();let r=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(r))},_createMarker(e){let t=new L.Marker(e,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(t,"vertexPane"),t._pmTempLayer=!0,this._layerGroup.addLayer(t),this._markers.push(t),t.on("click",this._finishShape,this),t},_setTooltipText(){let{length:e}=this._layer.getLatLngs().flat(),t="";e<=1?t=ve("tooltips.continueLine"):t=ve("tooltips.finishLine"),this._hintMarker.setTooltipContent(t)},_change(e){this._fireChange(e,"Draw")},setStyle(){this._layer?.setStyle(this.options.templineStyle),this._hintline?.setStyle(this.options.hintlineStyle)}}),at.Polygon=at.Line.extend({initialize(e){this._map=e,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(e){L.PM.Draw.Line.prototype.enable.call(this,e),this._layer.pm._shape="Polygon"},_createMarker(e){let t=new L.Marker(e,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(t,"vertexPane"),t._pmTempLayer=!0,this._layerGroup.addLayer(t),this._markers.push(t),this._layer.getLatLngs().flat().length===1?(t.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(t)-1,this.options.snappable&&this._cleanupSnapping()):t.on("click",()=>1),t},_setTooltipText(){let{length:e}=this._layer.getLatLngs().flat(),t="";e<=2?t=ve("tooltips.continueLine"):t=ve("tooltips.finishPoly"),this._hintMarker.setTooltipContent(t)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let e=this._layer.getLatLngs();if(e.length<=2)return;let t=L.polygon(e,this.options.pathOptions);this._setPane(t,"layerPane"),this._finishLayer(t),t.addTo(this._map.pm._getContainingLayer()),this._fireCreate(t),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex;let r=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(r))}}),at.Rectangle=at.extend({initialize(e){this._map=e,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(e){if(L.Util.setOptions(this,e),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(ve("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let t=0;t<2;t+=1){let r=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(r,"vertexPane"),r._pmTempLayer=!0,this._layerGroup.addLayer(r),this._styleMarkers.push(r)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(e){this.enabled()?this.disable():this.enable(e)},_placeStartingMarkers(e){this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng);let t=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(t),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(r=>{L.DomUtil.addClass(r._icon,"visible"),r.setLatLng(t)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(ve("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let e=this._startMarker.getLatLng();e&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([e,e]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(e){if(this._hintMarker.setLatLng(e.latlng),this.options.snappable){let r=e;r.target=this._hintMarker,this._handleSnapping(r)}let t=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(t,"Draw")},_syncRectangleSize(){let e=Dn(this._startMarker.getLatLng(),this._map),t=Dn(this._hintMarker.getLatLng(),this._map),r=L.PM.Utils._getRotatedRectangle(e,t,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(r),this.options.cursorMarker&&this._styleMarkers){let i=[];r.forEach(n=>{!n.equals(e,1e-8)&&!n.equals(t,1e-8)&&i.push(n)}),i.forEach((n,a)=>{try{this._styleMarkers[a].setLatLng(n)}catch{}})}},_findCorners(){let e=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(e[0],e[2],this.options.rectangleAngle||0,this._map)},_finishShape(e){this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng);let t=this._hintMarker.getLatLng(),r=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||r.equals(t))return;let i=L.rectangle([r,t],this.options.pathOptions);if(this.options.rectangleAngle){let a=L.PM.Utils._getRotatedRectangle(r,t,this.options.rectangleAngle||0,this._map);i.setLatLngs(a),i.pm&&i.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(i,"layerPane"),this._finishLayer(i),i.addTo(this._map.pm._getContainingLayer()),this._fireCreate(i);let n=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(n))},setStyle(){this._layer?.setStyle(this.options.pathOptions)}}),at.CircleMarker=at.extend({initialize(e){this._map=e,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(e){if(L.Util.setOptions(this,e),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let t={};L.extend(t,this.options.templineStyle),t.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),t),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(ve("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(ve("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(e=>{this.isRelevantMarker(e)&&e.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(e=>{this.isRelevantMarker(e)&&e.pm.disable()})},enabled(){return this._enabled},toggle(e){this.enabled()?this.disable():this.enable(e)},_placeCenterMarker(e){this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng),this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker);let t=this._hintMarker.getLatLng();this._centerMarker.setLatLng(t),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let e=this._centerMarker.getLatLng();e&&(this._layer.setLatLng(e),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(ve("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let e=this._centerMarker.getLatLng(),t=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([e,t])},_syncCircleRadius(){let e=this._centerMarker.getLatLng(),t=this._hintMarker.getLatLng(),r=this._distanceCalculation(e,t);this.options[this._minRadiusOption]&&r<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&r>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(r)},_syncHintMarker(e){if(this._hintMarker.setLatLng(e.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let r=e;r.target=this._hintMarker,this._handleSnapping(r)}this._handleHintMarkerSnapping();let t=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(t,"Draw")},isRelevantMarker(e){return e instanceof L.CircleMarker&&!(e instanceof L.Circle)&&e.pm&&!e._pmTempLayer},_createMarker(e){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!e.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng);let t=this._hintMarker.getLatLng(),r=new this._BaseCircleClass(t,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(r,"layerPane"),this._finishLayer(r),r.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(r),this._fireCreate(r),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(e){e.pm&&this.options.markerEditable&&e.pm.enable()},_finishShape(e){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng);let t=this._centerMarker.getLatLng(),r=this._defaultRadius;if(this.options[this._editableOption]){let s=this._hintMarker.getLatLng();r=this._distanceCalculation(t,s),this.options[this._minRadiusOption]&&r<this.options[this._minRadiusOption]?r=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&r>this.options[this._maxRadiusOption]&&(r=this.options[this._maxRadiusOption])}let i={...this.options.pathOptions,radius:r},n=new this._BaseCircleClass(t,i);this._setPane(n,"layerPane"),this._finishLayer(n),n.addTo(this._map.pm._getContainingLayer()),n.pm&&n.pm._updateHiddenPolyCircle(),this._fireCreate(n);let a=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(a))},_getNewDestinationOfHintMarker(){let e=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return e;let t=this._centerMarker.getLatLng(),r=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&r<this.options[this._minRadiusOption]?e=ci(this._map,t,e,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&r>this.options[this._maxRadiusOption]&&(e=ci(this._map,t,e,this._getMaxDistanceInMeter()))}return e},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let e=this._centerMarker.getLatLng(),t=this._hintMarker.getLatLng(),r=this._distanceCalculation(e,t);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&r<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&r>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){let e={};L.extend(e,this.options.templineStyle),this.options[this._editableOption]&&(e.radius=0),this._layer?.setStyle(e),this._hintline?.setStyle(this.options.hintlineStyle)},_distanceCalculation(e,t){return this._map.project(e).distanceTo(this._map.project(t))}}),at.Circle=at.CircleMarker.extend({initialize(e){this._map=e,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(e,t){return this._map.distance(e,t)}});function Yt(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Xt(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function pi(e){return e.type==="Feature"?e.geometry:e}function Tn(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}function Ui(e,t,r){if(e!==null)for(var i,n,a,s,o,u,h,v=0,_=0,R,I=e.type,Y=I==="FeatureCollection",re=I==="Feature",ae=Y?e.features.length:1,_e=0;_e<ae;_e++){h=Y?e.features[_e].geometry:re?e.geometry:e,R=h?h.type==="GeometryCollection":!1,o=R?h.geometries.length:1;for(var y=0;y<o;y++){var k=0,S=0;if(s=R?h.geometries[y]:h,s!==null){u=s.coordinates;var j=s.type;switch(v=0,j){case null:break;case"Point":if(t(u,_,_e,k,S)===!1)return!1;_++,k++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(t(u[i],_,_e,k,S)===!1)return!1;_++,j==="MultiPoint"&&k++}j==="LineString"&&k++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(n=0;n<u[i].length-v;n++){if(t(u[i][n],_,_e,k,S)===!1)return!1;_++}j==="MultiLineString"&&k++,j==="Polygon"&&S++}j==="Polygon"&&k++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(S=0,n=0;n<u[i].length;n++){for(a=0;a<u[i][n].length-v;a++){if(t(u[i][n][a],_,_e,k,S)===!1)return!1;_++}S++}k++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(Ui(s.geometries[i],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function zr(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var r=0;r<e.features.length&&t(e.features[r],r)!==!1;r++);}function Qs(e,t,r){var i=r;return zr(e,function(n,a){a===0&&r===void 0?i=n:i=t(i,n,a)}),i}function eo(e,t){var r,i,n,a,s,o,u,h,v,_,R=0,I=e.type==="FeatureCollection",Y=e.type==="Feature",re=I?e.features.length:1;for(r=0;r<re;r++){for(o=I?e.features[r].geometry:Y?e.geometry:e,h=I?e.features[r].properties:Y?e.properties:{},v=I?e.features[r].bbox:Y?e.bbox:void 0,_=I?e.features[r].id:Y?e.id:void 0,u=o?o.type==="GeometryCollection":!1,s=u?o.geometries.length:1,n=0;n<s;n++){if(a=u?o.geometries[n]:o,a===null){if(t(null,R,h,v,_)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,R,h,v,_)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(t(a.geometries[i],R,h,v,_)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}R++}}function Vi(e,t){eo(e,function(r,i,n,a,s){var o=r===null?null:r.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return t(Br(r,n,{bbox:a,id:s}),i,0)===!1?!1:void 0}var u;switch(o){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var h=0;h<r.coordinates.length;h++){var v=r.coordinates[h],_={type:u,coordinates:v};if(t(Br(_,n),i,h)===!1)return!1}})}function to(e){if(!e)throw new Error("geojson is required");var t=[];return Vi(e,function(r){ro(r,t)}),lr(t)}function ro(e,t){var r=[],i=e.geometry;if(i!==null){switch(i.type){case"Polygon":r=Xt(i);break;case"LineString":r=[Xt(i)]}r.forEach(function(n){var a=io(n,e.properties);a.forEach(function(s){s.id=t.length,t.push(s)})})}}function io(e,t){var r=[];return e.reduce(function(i,n){var a=Gr([i,n],t);return a.bbox=no(i,n),r.push(a),n}),r}function no(e,t){var r=e[0],i=e[1],n=t[0],a=t[1],s=r<n?r:n,o=i<a?i:a,u=r>n?r:n,h=i>a?i:a;return[s,o,u,h]}var Hi=to,ao=Q(xn(),1);function so(e,t){var r={},i=[];if(e.type==="LineString"&&(e=Br(e)),t.type==="LineString"&&(t=Br(t)),e.type==="Feature"&&t.type==="Feature"&&e.geometry!==null&&t.geometry!==null&&e.geometry.type==="LineString"&&t.geometry.type==="LineString"&&e.geometry.coordinates.length===2&&t.geometry.coordinates.length===2){var n=Fn(e,t);return n&&i.push(n),lr(i)}var a=(0,ao.default)();return a.load(Hi(t)),zr(Hi(e),function(s){zr(a.search(s),function(o){var u=Fn(s,o);if(u){var h=Xt(u).join(",");r[h]||(r[h]=!0,i.push(u))}})}),lr(i)}function Fn(e,t){var r=Xt(e),i=Xt(t);if(r.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(i.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=r[0][0],a=r[0][1],s=r[1][0],o=r[1][1],u=i[0][0],h=i[0][1],v=i[1][0],_=i[1][1],R=(_-h)*(s-n)-(v-u)*(o-a),I=(v-u)*(a-h)-(_-h)*(n-u),Y=(s-n)*(a-h)-(o-a)*(n-u);if(R===0)return null;var re=I/R,ae=Y/R;if(re>=0&&re<=1&&ae>=0&&ae<=1){var _e=n+re*(s-n),y=a+re*(o-a);return wr([_e,y])}return null}var fr=so,Rn=Q(xn(),1);function oo(e,t,r){r===void 0&&(r={});var i=Yt(e),n=Yt(t),a=zt(n[1]-i[1]),s=zt(n[0]-i[0]),o=zt(i[1]),u=zt(n[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(o)*Math.cos(u);return Zs(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),r.units)}var mr=oo;function lo(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=mr(e.slice(0,2),[i,r]),s=mr(e.slice(0,2),[t,n]);if(a>=s){var o=(r+n)/2;return[t,o-(i-t)/2,i,o+(i-t)/2]}else{var u=(t+i)/2;return[u-(n-r)/2,r,u+(n-r)/2,n]}}var uo=lo;function Ki(e){var t=[1/0,1/0,-1/0,-1/0];return Ui(e,function(r){t[0]>r[0]&&(t[0]=r[0]),t[1]>r[1]&&(t[1]=r[1]),t[2]<r[0]&&(t[2]=r[0]),t[3]<r[1]&&(t[3]=r[1])}),t}Ki.default=Ki;var $r=Ki;function ho(e,t){t===void 0&&(t={});var r=t.precision,i=t.coordinates,n=t.mutate;if(r=r==null||isNaN(r)?6:r,i=i==null||isNaN(i)?3:i,!e)throw new Error("<geojson> is required");if(typeof r!="number")throw new Error("<precision> must be a number");if(typeof i!="number")throw new Error("<coordinates> must be a number");(n===!1||n===void 0)&&(e=JSON.parse(JSON.stringify(e)));var a=Math.pow(10,r);return Ui(e,function(s){co(s,a,i)}),e}function co(e,t,r){e.length>r&&e.splice(r,e.length);for(var i=0;i<e.length;i++)e[i]=Math.round(e[i]*t)/t;return e}var po=ho;function On(e,t,r){if(r===void 0&&(r={}),r.final===!0)return go(e,t);var i=Yt(e),n=Yt(t),a=zt(i[0]),s=zt(n[0]),o=zt(i[1]),u=zt(n[1]),h=Math.sin(s-a)*Math.cos(u),v=Math.cos(o)*Math.sin(u)-Math.sin(o)*Math.cos(u)*Math.cos(s-a);return $i(Math.atan2(h,v))}function go(e,t){var r=On(t,e);return r=(r+180)%360,r}function In(e,t,r,i){i===void 0&&(i={});var n=Yt(e),a=zt(n[0]),s=zt(n[1]),o=zt(r),u=Js(t,i.units),h=Math.asin(Math.sin(s)*Math.cos(u)+Math.cos(s)*Math.sin(u)*Math.cos(o)),v=a+Math.atan2(Math.sin(o)*Math.sin(u)*Math.cos(s),Math.cos(u)-Math.sin(s)*Math.sin(h)),_=$i(v),R=$i(h);return wr([_,R],i.properties)}function fo(e,t,r){r===void 0&&(r={});var i=wr([1/0,1/0],{dist:1/0}),n=0;return Vi(e,function(a){for(var s=Xt(a),o=0;o<s.length-1;o++){var u=wr(s[o]);u.properties.dist=mr(t,u,r);var h=wr(s[o+1]);h.properties.dist=mr(t,h,r);var v=mr(u,h,r),_=Math.max(u.properties.dist,h.properties.dist),R=On(u,h),I=In(t,_,R+90,r),Y=In(t,_,R-90,r),re=fr(Gr([I.geometry.coordinates,Y.geometry.coordinates]),Gr([u.geometry.coordinates,h.geometry.coordinates])),ae=null;re.features.length>0&&(ae=re.features[0],ae.properties.dist=mr(t,ae,r),ae.properties.location=n+mr(u,ae,r)),u.properties.dist<i.properties.dist&&(i=u,i.properties.index=o,i.properties.location=n),h.properties.dist<i.properties.dist&&(i=h,i.properties.index=o+1,i.properties.location=n+v),ae&&ae.properties.dist<i.properties.dist&&(i=ae,i.properties.index=o),n+=v}}),i}var mo=fo;function _o(e,t){if(!e)throw new Error("line is required");if(!t)throw new Error("splitter is required");var r=Tn(e),i=Tn(t);if(r!=="LineString")throw new Error("line must be LineString");if(i==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(i==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var n=po(t,{precision:7});switch(i){case"Point":return qi(e,n);case"MultiPoint":return jn(e,n);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return jn(e,fr(e,n))}}function jn(e,t){var r=[],i=(0,Rn.default)();return Vi(t,function(n){if(r.forEach(function(o,u){o.id=u}),!r.length)r=qi(e,n).features,r.forEach(function(o){o.bbox||(o.bbox=uo($r(o)))}),i.load(lr(r));else{var a=i.search(n);if(a.features.length){var s=Nn(n,a);r=r.filter(function(o){return o.id!==s.id}),i.remove(s),zr(qi(s,n),function(o){r.push(o),i.insert(o)})}}}),lr(r)}function qi(e,t){var r=[],i=Xt(e)[0],n=Xt(e)[e.geometry.coordinates.length-1];if(Yi(i,Yt(t))||Yi(n,Yt(t)))return lr([e]);var a=(0,Rn.default)(),s=Hi(e);a.load(s);var o=a.search(t);if(!o.features.length)return lr([e]);var u=Nn(t,o),h=[i],v=Qs(s,function(_,R,I){var Y=Xt(R)[1],re=Yt(t);return I===u.id?(_.push(re),r.push(Gr(_)),Yi(re,Y)?[re]:[re,Y]):(_.push(Y),_)},h);return v.length>1&&r.push(Gr(v)),lr(r)}function Nn(e,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var r,i=1/0;return zr(t,function(n){var a=mo(n,e),s=a.properties.dist;s<i&&(r=n,i=s)}),r}function Yi(e,t){return e[0]===t[0]&&e[1]===t[1]}var yo=_o;function gi(e,t,r){if(r===void 0&&(r={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var i=Yt(e),n=pi(t),a=n.type,s=t.bbox,o=n.coordinates;if(s&&vo(i,s)===!1)return!1;a==="Polygon"&&(o=[o]);for(var u=!1,h=0;h<o.length&&!u;h++)if(Gn(i,o[h][0],r.ignoreBoundary)){for(var v=!1,_=1;_<o[h].length&&!v;)Gn(i,o[h][_],!r.ignoreBoundary)&&(v=!0),_++;v||(u=!0)}return u}function Gn(e,t,r){var i=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var n=0,a=t.length-1;n<t.length;a=n++){var s=t[n][0],o=t[n][1],u=t[a][0],h=t[a][1],v=e[1]*(s-u)+o*(u-e[0])+h*(e[0]-s)===0&&(s-e[0])*(u-e[0])<=0&&(o-e[1])*(h-e[1])<=0;if(v)return!r;var _=o>e[1]!=h>e[1]&&e[0]<(u-s)*(e[1]-o)/(h-o)+s;_&&(i=!i)}return i}function vo(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function Co(e,t,r){r===void 0&&(r={});for(var i=Yt(e),n=Xt(t),a=0;a<n.length-1;a++){var s=!1;if(r.ignoreEndVertices&&(a===0&&(s="start"),a===n.length-2&&(s="end"),a===0&&a+1===n.length-1&&(s="both")),bo(n[a],n[a+1],i,s,typeof r.epsilon>"u"?null:r.epsilon))return!0}return!1}function bo(e,t,r,i,n){var a=r[0],s=r[1],o=e[0],u=e[1],h=t[0],v=t[1],_=r[0]-o,R=r[1]-u,I=h-o,Y=v-u,re=_*Y-R*I;if(n!==null){if(Math.abs(re)>n)return!1}else if(re!==0)return!1;if(i){if(i==="start")return Math.abs(I)>=Math.abs(Y)?I>0?o<a&&a<=h:h<=a&&a<o:Y>0?u<s&&s<=v:v<=s&&s<u;if(i==="end")return Math.abs(I)>=Math.abs(Y)?I>0?o<=a&&a<h:h<a&&a<=o:Y>0?u<=s&&s<v:v<s&&s<=u;if(i==="both")return Math.abs(I)>=Math.abs(Y)?I>0?o<a&&a<h:h<a&&a<o:Y>0?u<s&&s<v:v<s&&s<u}else return Math.abs(I)>=Math.abs(Y)?I>0?o<=a&&a<=h:h<=a&&a<=o:Y>0?u<=s&&s<=v:v<=s&&s<=u;return!1}var Ur=Co;function Lo(e,t){var r=pi(e),i=pi(t),n=r.type,a=i.type,s=r.coordinates,o=i.coordinates;switch(n){case"Point":switch(a){case"Point":return Xi(s,o);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return ko(r,i);case"MultiPoint":return xo(r,i);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return Ur(i,r,{ignoreEndVertices:!0});case"LineString":return Bo(r,i);case"MultiPoint":return Mo(r,i);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return gi(i,r,{ignoreBoundary:!0});case"LineString":return wo(r,i);case"Polygon":return Do(r,i);case"MultiPoint":return Eo(r,i);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function ko(e,t){var r,i=!1;for(r=0;r<e.coordinates.length;r++)if(Xi(e.coordinates[r],t.coordinates)){i=!0;break}return i}function xo(e,t){for(var r=0,i=t.coordinates;r<i.length;r++){for(var n=i[r],a=!1,s=0,o=e.coordinates;s<o.length;s++){var u=o[s];if(Xi(n,u)){a=!0;break}}if(!a)return!1}return!0}function Mo(e,t){for(var r=!1,i=0,n=t.coordinates;i<n.length;i++){var a=n[i];if(Ur(a,e,{ignoreEndVertices:!0})&&(r=!0),!Ur(a,e))return!1}return!!r}function Eo(e,t){for(var r=0,i=t.coordinates;r<i.length;r++){var n=i[r];if(!gi(n,e,{ignoreBoundary:!0}))return!1}return!0}function Bo(e,t){for(var r=!1,i=0,n=t.coordinates;i<n.length;i++){var a=n[i];if(Ur({type:"Point",coordinates:a},e,{ignoreEndVertices:!0})&&(r=!0),!Ur({type:"Point",coordinates:a},e,{ignoreEndVertices:!1}))return!1}return r}function wo(e,t){var r=!1,i=0,n=$r(e),a=$r(t);if(!zn(n,a))return!1;for(i;i<t.coordinates.length-1;i++){var s=So(t.coordinates[i],t.coordinates[i+1]);if(gi({type:"Point",coordinates:s},e,{ignoreBoundary:!0})){r=!0;break}}return r}function Do(e,t){if(e.type==="Feature"&&e.geometry===null||t.type==="Feature"&&t.geometry===null)return!1;var r=$r(e),i=$r(t);if(!zn(r,i))return!1;for(var n=pi(t).coordinates,a=0,s=n;a<s.length;a++)for(var o=s[a],u=0,h=o;u<h.length;u++){var v=h[u];if(!gi(v,e))return!1}return!0}function zn(e,t){return!(e[0]>t[0]||e[2]<t[2]||e[1]>t[1]||e[3]<t[3])}function Xi(e,t){return e[0]===t[0]&&e[1]===t[1]}function So(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}var Po=Q(Gt()),$n=e=>()=>e,Zi=e=>{let t=e?(r,i)=>i.minus(r).abs().isLessThanOrEqualTo(e):$n(!1);return(r,i)=>t(r,i)?0:r.comparedTo(i)};function Ao(e){let t=e?(r,i,n,a,s)=>r.exponentiatedBy(2).isLessThanOrEqualTo(a.minus(i).exponentiatedBy(2).plus(s.minus(n).exponentiatedBy(2)).times(e)):$n(!1);return(r,i,n)=>{let a=r.x,s=r.y,o=n.x,u=n.y,h=s.minus(u).times(i.x.minus(o)).minus(a.minus(o).times(i.y.minus(u)));return t(h,a,s,o,u)?0:h.comparedTo(0)}}var To=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Ji=Math.ceil,wt=Math.floor,vt="[BigNumber Error] ",Un=vt+"Number primitive has more than 15 significant digits: ",$t=1e14,de=14,Wi=9007199254740991,Qi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],ur=1e7,Ze=1e9;function Vn(e){var t,r,i,n=y.prototype={constructor:y,toString:null,valueOf:null},a=new y(1),s=20,o=4,u=-7,h=21,v=-1e7,_=1e7,R=!1,I=1,Y=0,re={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},ae="0123456789abcdefghijklmnopqrstuvwxyz",_e=!0;function y(l,d){var g,p,f,m,E,x,w,F,T=this;if(!(T instanceof y))return new y(l,d);if(d==null){if(l&&l._isBigNumber===!0){T.s=l.s,!l.c||l.e>_?T.c=T.e=null:l.e<v?T.c=[T.e=0]:(T.e=l.e,T.c=l.c.slice());return}if((x=typeof l=="number")&&l*0==0){if(T.s=1/l<0?(l=-l,-1):1,l===~~l){for(m=0,E=l;E>=10;E/=10,m++);m>_?T.c=T.e=null:(T.e=m,T.c=[l]);return}F=String(l)}else{if(!To.test(F=String(l)))return i(T,F,x);T.s=F.charCodeAt(0)==45?(F=F.slice(1),-1):1}(m=F.indexOf("."))>-1&&(F=F.replace(".","")),(E=F.search(/e/i))>0?(m<0&&(m=E),m+=+F.slice(E+1),F=F.substring(0,E)):m<0&&(m=F.length)}else{if(je(d,2,ae.length,"Base"),d==10&&_e)return T=new y(l),P(T,s+T.e+1,o);if(F=String(l),x=typeof l=="number"){if(l*0!=0)return i(T,F,x,d);if(T.s=1/l<0?(F=F.slice(1),-1):1,y.DEBUG&&F.replace(/^0\.0*|\./,"").length>15)throw Error(Un+l)}else T.s=F.charCodeAt(0)===45?(F=F.slice(1),-1):1;for(g=ae.slice(0,d),m=E=0,w=F.length;E<w;E++)if(g.indexOf(p=F.charAt(E))<0){if(p=="."){if(E>m){m=w;continue}}else if(!f&&(F==F.toUpperCase()&&(F=F.toLowerCase())||F==F.toLowerCase()&&(F=F.toUpperCase()))){f=!0,E=-1,m=0;continue}return i(T,String(l),x,d)}x=!1,F=r(F,d,10,T.s),(m=F.indexOf("."))>-1?F=F.replace(".",""):m=F.length}for(E=0;F.charCodeAt(E)===48;E++);for(w=F.length;F.charCodeAt(--w)===48;);if(F=F.slice(E,++w)){if(w-=E,x&&y.DEBUG&&w>15&&(l>Wi||l!==wt(l)))throw Error(Un+T.s*l);if((m=m-E-1)>_)T.c=T.e=null;else if(m<v)T.c=[T.e=0];else{if(T.e=m,T.c=[],E=(m+1)%de,m<0&&(E+=de),E<w){for(E&&T.c.push(+F.slice(0,E)),w-=de;E<w;)T.c.push(+F.slice(E,E+=de));E=de-(F=F.slice(E)).length}else E-=w;for(;E--;F+="0");T.c.push(+F)}}else T.c=[T.e=0]}y.clone=Vn,y.ROUND_UP=0,y.ROUND_DOWN=1,y.ROUND_CEIL=2,y.ROUND_FLOOR=3,y.ROUND_HALF_UP=4,y.ROUND_HALF_DOWN=5,y.ROUND_HALF_EVEN=6,y.ROUND_HALF_CEIL=7,y.ROUND_HALF_FLOOR=8,y.EUCLID=9,y.config=y.set=function(l){var d,g;if(l!=null)if(typeof l=="object"){if(l.hasOwnProperty(d="DECIMAL_PLACES")&&(g=l[d],je(g,0,Ze,d),s=g),l.hasOwnProperty(d="ROUNDING_MODE")&&(g=l[d],je(g,0,8,d),o=g),l.hasOwnProperty(d="EXPONENTIAL_AT")&&(g=l[d],g&&g.pop?(je(g[0],-Ze,0,d),je(g[1],0,Ze,d),u=g[0],h=g[1]):(je(g,-Ze,Ze,d),u=-(h=g<0?-g:g))),l.hasOwnProperty(d="RANGE"))if(g=l[d],g&&g.pop)je(g[0],-Ze,-1,d),je(g[1],1,Ze,d),v=g[0],_=g[1];else if(je(g,-Ze,Ze,d),g)v=-(_=g<0?-g:g);else throw Error(vt+d+" cannot be zero: "+g);if(l.hasOwnProperty(d="CRYPTO"))if(g=l[d],g===!!g)if(g)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))R=g;else throw R=!g,Error(vt+"crypto unavailable");else R=g;else throw Error(vt+d+" not true or false: "+g);if(l.hasOwnProperty(d="MODULO_MODE")&&(g=l[d],je(g,0,9,d),I=g),l.hasOwnProperty(d="POW_PRECISION")&&(g=l[d],je(g,0,Ze,d),Y=g),l.hasOwnProperty(d="FORMAT"))if(g=l[d],typeof g=="object")re=g;else throw Error(vt+d+" not an object: "+g);if(l.hasOwnProperty(d="ALPHABET"))if(g=l[d],typeof g=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(g))_e=g.slice(0,10)=="0123456789",ae=g;else throw Error(vt+d+" invalid: "+g)}else throw Error(vt+"Object expected: "+l);return{DECIMAL_PLACES:s,ROUNDING_MODE:o,EXPONENTIAL_AT:[u,h],RANGE:[v,_],CRYPTO:R,MODULO_MODE:I,POW_PRECISION:Y,FORMAT:re,ALPHABET:ae}},y.isBigNumber=function(l){if(!l||l._isBigNumber!==!0)return!1;if(!y.DEBUG)return!0;var d,g,p=l.c,f=l.e,m=l.s;e:if({}.toString.call(p)=="[object Array]"){if((m===1||m===-1)&&f>=-Ze&&f<=Ze&&f===wt(f)){if(p[0]===0){if(f===0&&p.length===1)return!0;break e}if(d=(f+1)%de,d<1&&(d+=de),String(p[0]).length==d){for(d=0;d<p.length;d++)if(g=p[d],g<0||g>=$t||g!==wt(g))break e;if(g!==0)return!0}}}else if(p===null&&f===null&&(m===null||m===1||m===-1))return!0;throw Error(vt+"Invalid BigNumber: "+l)},y.maximum=y.max=function(){return S(arguments,-1)},y.minimum=y.min=function(){return S(arguments,1)},y.random=(function(){var l=9007199254740992,d=Math.random()*l&2097151?function(){return wt(Math.random()*l)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(g){var p,f,m,E,x,w=0,F=[],T=new y(a);if(g==null?g=s:je(g,0,Ze),E=Ji(g/de),R)if(crypto.getRandomValues){for(p=crypto.getRandomValues(new Uint32Array(E*=2));w<E;)x=p[w]*131072+(p[w+1]>>>11),x>=9e15?(f=crypto.getRandomValues(new Uint32Array(2)),p[w]=f[0],p[w+1]=f[1]):(F.push(x%1e14),w+=2);w=E/2}else if(crypto.randomBytes){for(p=crypto.randomBytes(E*=7);w<E;)x=(p[w]&31)*281474976710656+p[w+1]*1099511627776+p[w+2]*4294967296+p[w+3]*16777216+(p[w+4]<<16)+(p[w+5]<<8)+p[w+6],x>=9e15?crypto.randomBytes(7).copy(p,w):(F.push(x%1e14),w+=7);w=E/7}else throw R=!1,Error(vt+"crypto unavailable");if(!R)for(;w<E;)x=d(),x<9e15&&(F[w++]=x%1e14);for(E=F[--w],g%=de,E&&g&&(x=Qi[de-g],F[w]=wt(E/x)*x);F[w]===0;F.pop(),w--);if(w<0)F=[m=0];else{for(m=-1;F[0]===0;F.splice(0,1),m-=de);for(w=1,x=F[0];x>=10;x/=10,w++);w<de&&(m-=de-w)}return T.e=m,T.c=F,T}})(),y.sum=function(){for(var l=1,d=arguments,g=new y(d[0]);l<d.length;)g=g.plus(d[l++]);return g},r=(function(){var l="0123456789";function d(g,p,f,m){for(var E,x=[0],w,F=0,T=g.length;F<T;){for(w=x.length;w--;x[w]*=p);for(x[0]+=m.indexOf(g.charAt(F++)),E=0;E<x.length;E++)x[E]>f-1&&(x[E+1]==null&&(x[E+1]=0),x[E+1]+=x[E]/f|0,x[E]%=f)}return x.reverse()}return function(g,p,f,m,E){var x,w,F,T,K,ne,se,le,Le=g.indexOf("."),Me=s,Ce=o;for(Le>=0&&(T=Y,Y=0,g=g.replace(".",""),le=new y(p),ne=le.pow(g.length-Le),Y=T,le.c=d(rr(St(ne.c),ne.e,"0"),10,f,l),le.e=le.c.length),se=d(g,p,f,E?(x=ae,l):(x=l,ae)),F=T=se.length;se[--T]==0;se.pop());if(!se[0])return x.charAt(0);if(Le<0?--F:(ne.c=se,ne.e=F,ne.s=m,ne=t(ne,le,Me,Ce,f),se=ne.c,K=ne.r,F=ne.e),w=F+Me+1,Le=se[w],T=f/2,K=K||w<0||se[w+1]!=null,K=Ce<4?(Le!=null||K)&&(Ce==0||Ce==(ne.s<0?3:2)):Le>T||Le==T&&(Ce==4||K||Ce==6&&se[w-1]&1||Ce==(ne.s<0?8:7)),w<1||!se[0])g=K?rr(x.charAt(1),-Me,x.charAt(0)):x.charAt(0);else{if(se.length=w,K)for(--f;++se[--w]>f;)se[w]=0,w||(++F,se=[1].concat(se));for(T=se.length;!se[--T];);for(Le=0,g="";Le<=T;g+=x.charAt(se[Le++]));g=rr(g,F,x.charAt(0))}return g}})(),t=(function(){function l(p,f,m){var E,x,w,F,T=0,K=p.length,ne=f%ur,se=f/ur|0;for(p=p.slice();K--;)w=p[K]%ur,F=p[K]/ur|0,E=se*w+F*ne,x=ne*w+E%ur*ur+T,T=(x/m|0)+(E/ur|0)+se*F,p[K]=x%m;return T&&(p=[T].concat(p)),p}function d(p,f,m,E){var x,w;if(m!=E)w=m>E?1:-1;else for(x=w=0;x<m;x++)if(p[x]!=f[x]){w=p[x]>f[x]?1:-1;break}return w}function g(p,f,m,E){for(var x=0;m--;)p[m]-=x,x=p[m]<f[m]?1:0,p[m]=x*E+p[m]-f[m];for(;!p[0]&&p.length>1;p.splice(0,1));}return function(p,f,m,E,x){var w,F,T,K,ne,se,le,Le,Me,Ce,Ee,ct,Mi,nn,an,Wt,qr,Pt=p.s==f.s?1:-1,ft=p.c,Ne=f.c;if(!ft||!ft[0]||!Ne||!Ne[0])return new y(!p.s||!f.s||(ft?Ne&&ft[0]==Ne[0]:!Ne)?NaN:ft&&ft[0]==0||!Ne?Pt*0:Pt/0);for(Le=new y(Pt),Me=Le.c=[],F=p.e-f.e,Pt=m+F+1,x||(x=$t,F=Dt(p.e/de)-Dt(f.e/de),Pt=Pt/de|0),T=0;Ne[T]==(ft[T]||0);T++);if(Ne[T]>(ft[T]||0)&&F--,Pt<0)Me.push(1),K=!0;else{for(nn=ft.length,Wt=Ne.length,T=0,Pt+=2,ne=wt(x/(Ne[0]+1)),ne>1&&(Ne=l(Ne,ne,x),ft=l(ft,ne,x),Wt=Ne.length,nn=ft.length),Mi=Wt,Ce=ft.slice(0,Wt),Ee=Ce.length;Ee<Wt;Ce[Ee++]=0);qr=Ne.slice(),qr=[0].concat(qr),an=Ne[0],Ne[1]>=x/2&&an++;do{if(ne=0,w=d(Ne,Ce,Wt,Ee),w<0){if(ct=Ce[0],Wt!=Ee&&(ct=ct*x+(Ce[1]||0)),ne=wt(ct/an),ne>1)for(ne>=x&&(ne=x-1),se=l(Ne,ne,x),le=se.length,Ee=Ce.length;d(se,Ce,le,Ee)==1;)ne--,g(se,Wt<le?qr:Ne,le,x),le=se.length,w=1;else ne==0&&(w=ne=1),se=Ne.slice(),le=se.length;if(le<Ee&&(se=[0].concat(se)),g(Ce,se,Ee,x),Ee=Ce.length,w==-1)for(;d(Ne,Ce,Wt,Ee)<1;)ne++,g(Ce,Wt<Ee?qr:Ne,Ee,x),Ee=Ce.length}else w===0&&(ne++,Ce=[0]);Me[T++]=ne,Ce[0]?Ce[Ee++]=ft[Mi]||0:(Ce=[ft[Mi]],Ee=1)}while((Mi++<nn||Ce[0]!=null)&&Pt--);K=Ce[0]!=null,Me[0]||Me.splice(0,1)}if(x==$t){for(T=1,Pt=Me[0];Pt>=10;Pt/=10,T++);P(Le,m+(Le.e=T+F*de-1)+1,E,K)}else Le.e=F,Le.r=+K;return Le}})();function k(l,d,g,p){var f,m,E,x,w;if(g==null?g=o:je(g,0,8),!l.c)return l.toString();if(f=l.c[0],E=l.e,d==null)w=St(l.c),w=p==1||p==2&&(E<=u||E>=h)?mi(w,E):rr(w,E,"0");else if(l=P(new y(l),d,g),m=l.e,w=St(l.c),x=w.length,p==1||p==2&&(d<=m||m<=u)){for(;x<d;w+="0",x++);w=mi(w,m)}else if(d-=E,w=rr(w,m,"0"),m+1>x){if(--d>0)for(w+=".";d--;w+="0");}else if(d+=m-x,d>0)for(m+1==x&&(w+=".");d--;w+="0");return l.s<0&&f?"-"+w:w}function S(l,d){for(var g,p,f=1,m=new y(l[0]);f<l.length;f++)p=new y(l[f]),(!p.s||(g=_r(m,p))===d||g===0&&m.s===d)&&(m=p);return m}function j(l,d,g){for(var p=1,f=d.length;!d[--f];d.pop());for(f=d[0];f>=10;f/=10,p++);return(g=p+g*de-1)>_?l.c=l.e=null:g<v?l.c=[l.e=0]:(l.e=g,l.c=d),l}i=(function(){var l=/^(-?)0([xbo])(?=\w[\w.]*$)/i,d=/^([^.]+)\.$/,g=/^\.([^.]+)$/,p=/^-?(Infinity|NaN)$/,f=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(m,E,x,w){var F,T=x?E:E.replace(f,"");if(p.test(T))m.s=isNaN(T)?null:T<0?-1:1;else{if(!x&&(T=T.replace(l,function(K,ne,se){return F=(se=se.toLowerCase())=="x"?16:se=="b"?2:8,!w||w==F?ne:K}),w&&(F=w,T=T.replace(d,"$1").replace(g,"0.$1")),E!=T))return new y(T,F);if(y.DEBUG)throw Error(vt+"Not a"+(w?" base "+w:"")+" number: "+E);m.s=null}m.c=m.e=null}})();function P(l,d,g,p){var f,m,E,x,w,F,T,K=l.c,ne=Qi;if(K){e:{for(f=1,x=K[0];x>=10;x/=10,f++);if(m=d-f,m<0)m+=de,E=d,w=K[F=0],T=wt(w/ne[f-E-1]%10);else if(F=Ji((m+1)/de),F>=K.length)if(p){for(;K.length<=F;K.push(0));w=T=0,f=1,m%=de,E=m-de+1}else break e;else{for(w=x=K[F],f=1;x>=10;x/=10,f++);m%=de,E=m-de+f,T=E<0?0:wt(w/ne[f-E-1]%10)}if(p=p||d<0||K[F+1]!=null||(E<0?w:w%ne[f-E-1]),p=g<4?(T||p)&&(g==0||g==(l.s<0?3:2)):T>5||T==5&&(g==4||p||g==6&&(m>0?E>0?w/ne[f-E]:0:K[F-1])%10&1||g==(l.s<0?8:7)),d<1||!K[0])return K.length=0,p?(d-=l.e+1,K[0]=ne[(de-d%de)%de],l.e=-d||0):K[0]=l.e=0,l;if(m==0?(K.length=F,x=1,F--):(K.length=F+1,x=ne[de-m],K[F]=E>0?wt(w/ne[f-E]%ne[E])*x:0),p)for(;;)if(F==0){for(m=1,E=K[0];E>=10;E/=10,m++);for(E=K[0]+=x,x=1;E>=10;E/=10,x++);m!=x&&(l.e++,K[0]==$t&&(K[0]=1));break}else{if(K[F]+=x,K[F]!=$t)break;K[F--]=0,x=1}for(m=K.length;K[--m]===0;K.pop());}l.e>_?l.c=l.e=null:l.e<v&&(l.c=[l.e=0])}return l}function O(l){var d,g=l.e;return g===null?l.toString():(d=St(l.c),d=g<=u||g>=h?mi(d,g):rr(d,g,"0"),l.s<0?"-"+d:d)}return n.absoluteValue=n.abs=function(){var l=new y(this);return l.s<0&&(l.s=1),l},n.comparedTo=function(l,d){return _r(this,new y(l,d))},n.decimalPlaces=n.dp=function(l,d){var g,p,f,m=this;if(l!=null)return je(l,0,Ze),d==null?d=o:je(d,0,8),P(new y(m),l+m.e+1,d);if(!(g=m.c))return null;if(p=((f=g.length-1)-Dt(this.e/de))*de,f=g[f])for(;f%10==0;f/=10,p--);return p<0&&(p=0),p},n.dividedBy=n.div=function(l,d){return t(this,new y(l,d),s,o)},n.dividedToIntegerBy=n.idiv=function(l,d){return t(this,new y(l,d),0,1)},n.exponentiatedBy=n.pow=function(l,d){var g,p,f,m,E,x,w,F,T,K=this;if(l=new y(l),l.c&&!l.isInteger())throw Error(vt+"Exponent not an integer: "+O(l));if(d!=null&&(d=new y(d)),x=l.e>14,!K.c||!K.c[0]||K.c[0]==1&&!K.e&&K.c.length==1||!l.c||!l.c[0])return T=new y(Math.pow(+O(K),x?l.s*(2-fi(l)):+O(l))),d?T.mod(d):T;if(w=l.s<0,d){if(d.c?!d.c[0]:!d.s)return new y(NaN);p=!w&&K.isInteger()&&d.isInteger(),p&&(K=K.mod(d))}else{if(l.e>9&&(K.e>0||K.e<-1||(K.e==0?K.c[0]>1||x&&K.c[1]>=24e7:K.c[0]<8e13||x&&K.c[0]<=9999975e7)))return m=K.s<0&&fi(l)?-0:0,K.e>-1&&(m=1/m),new y(w?1/m:m);Y&&(m=Ji(Y/de+2))}for(x?(g=new y(.5),w&&(l.s=1),F=fi(l)):(f=Math.abs(+O(l)),F=f%2),T=new y(a);;){if(F){if(T=T.times(K),!T.c)break;m?T.c.length>m&&(T.c.length=m):p&&(T=T.mod(d))}if(f){if(f=wt(f/2),f===0)break;F=f%2}else if(l=l.times(g),P(l,l.e+1,1),l.e>14)F=fi(l);else{if(f=+O(l),f===0)break;F=f%2}K=K.times(K),m?K.c&&K.c.length>m&&(K.c.length=m):p&&(K=K.mod(d))}return p?T:(w&&(T=a.div(T)),d?T.mod(d):m?P(T,Y,o,E):T)},n.integerValue=function(l){var d=new y(this);return l==null?l=o:je(l,0,8),P(d,d.e+1,l)},n.isEqualTo=n.eq=function(l,d){return _r(this,new y(l,d))===0},n.isFinite=function(){return!!this.c},n.isGreaterThan=n.gt=function(l,d){return _r(this,new y(l,d))>0},n.isGreaterThanOrEqualTo=n.gte=function(l,d){return(d=_r(this,new y(l,d)))===1||d===0},n.isInteger=function(){return!!this.c&&Dt(this.e/de)>this.c.length-2},n.isLessThan=n.lt=function(l,d){return _r(this,new y(l,d))<0},n.isLessThanOrEqualTo=n.lte=function(l,d){return(d=_r(this,new y(l,d)))===-1||d===0},n.isNaN=function(){return!this.s},n.isNegative=function(){return this.s<0},n.isPositive=function(){return this.s>0},n.isZero=function(){return!!this.c&&this.c[0]==0},n.minus=function(l,d){var g,p,f,m,E=this,x=E.s;if(l=new y(l,d),d=l.s,!x||!d)return new y(NaN);if(x!=d)return l.s=-d,E.plus(l);var w=E.e/de,F=l.e/de,T=E.c,K=l.c;if(!w||!F){if(!T||!K)return T?(l.s=-d,l):new y(K?E:NaN);if(!T[0]||!K[0])return K[0]?(l.s=-d,l):new y(T[0]?E:o==3?-0:0)}if(w=Dt(w),F=Dt(F),T=T.slice(),x=w-F){for((m=x<0)?(x=-x,f=T):(F=w,f=K),f.reverse(),d=x;d--;f.push(0));f.reverse()}else for(p=(m=(x=T.length)<(d=K.length))?x:d,x=d=0;d<p;d++)if(T[d]!=K[d]){m=T[d]<K[d];break}if(m&&(f=T,T=K,K=f,l.s=-l.s),d=(p=K.length)-(g=T.length),d>0)for(;d--;T[g++]=0);for(d=$t-1;p>x;){if(T[--p]<K[p]){for(g=p;g&&!T[--g];T[g]=d);--T[g],T[p]+=$t}T[p]-=K[p]}for(;T[0]==0;T.splice(0,1),--F);return T[0]?j(l,T,F):(l.s=o==3?-1:1,l.c=[l.e=0],l)},n.modulo=n.mod=function(l,d){var g,p,f=this;return l=new y(l,d),!f.c||!l.s||l.c&&!l.c[0]?new y(NaN):!l.c||f.c&&!f.c[0]?new y(f):(I==9?(p=l.s,l.s=1,g=t(f,l,0,3),l.s=p,g.s*=p):g=t(f,l,0,I),l=f.minus(g.times(l)),!l.c[0]&&I==1&&(l.s=f.s),l)},n.multipliedBy=n.times=function(l,d){var g,p,f,m,E,x,w,F,T,K,ne,se,le,Le,Me,Ce=this,Ee=Ce.c,ct=(l=new y(l,d)).c;if(!Ee||!ct||!Ee[0]||!ct[0])return!Ce.s||!l.s||Ee&&!Ee[0]&&!ct||ct&&!ct[0]&&!Ee?l.c=l.e=l.s=null:(l.s*=Ce.s,!Ee||!ct?l.c=l.e=null:(l.c=[0],l.e=0)),l;for(p=Dt(Ce.e/de)+Dt(l.e/de),l.s*=Ce.s,w=Ee.length,K=ct.length,w<K&&(le=Ee,Ee=ct,ct=le,f=w,w=K,K=f),f=w+K,le=[];f--;le.push(0));for(Le=$t,Me=ur,f=K;--f>=0;){for(g=0,ne=ct[f]%Me,se=ct[f]/Me|0,E=w,m=f+E;m>f;)F=Ee[--E]%Me,T=Ee[E]/Me|0,x=se*F+T*ne,F=ne*F+x%Me*Me+le[m]+g,g=(F/Le|0)+(x/Me|0)+se*T,le[m--]=F%Le;le[m]=g}return g?++p:le.splice(0,1),j(l,le,p)},n.negated=function(){var l=new y(this);return l.s=-l.s||null,l},n.plus=function(l,d){var g,p=this,f=p.s;if(l=new y(l,d),d=l.s,!f||!d)return new y(NaN);if(f!=d)return l.s=-d,p.minus(l);var m=p.e/de,E=l.e/de,x=p.c,w=l.c;if(!m||!E){if(!x||!w)return new y(f/0);if(!x[0]||!w[0])return w[0]?l:new y(x[0]?p:f*0)}if(m=Dt(m),E=Dt(E),x=x.slice(),f=m-E){for(f>0?(E=m,g=w):(f=-f,g=x),g.reverse();f--;g.push(0));g.reverse()}for(f=x.length,d=w.length,f-d<0&&(g=w,w=x,x=g,d=f),f=0;d;)f=(x[--d]=x[d]+w[d]+f)/$t|0,x[d]=$t===x[d]?0:x[d]%$t;return f&&(x=[f].concat(x),++E),j(l,x,E)},n.precision=n.sd=function(l,d){var g,p,f,m=this;if(l!=null&&l!==!!l)return je(l,1,Ze),d==null?d=o:je(d,0,8),P(new y(m),l,d);if(!(g=m.c))return null;if(f=g.length-1,p=f*de+1,f=g[f]){for(;f%10==0;f/=10,p--);for(f=g[0];f>=10;f/=10,p++);}return l&&m.e+1>p&&(p=m.e+1),p},n.shiftedBy=function(l){return je(l,-Wi,Wi),this.times("1e"+l)},n.squareRoot=n.sqrt=function(){var l,d,g,p,f,m=this,E=m.c,x=m.s,w=m.e,F=s+4,T=new y("0.5");if(x!==1||!E||!E[0])return new y(!x||x<0&&(!E||E[0])?NaN:E?m:1/0);if(x=Math.sqrt(+O(m)),x==0||x==1/0?(d=St(E),(d.length+w)%2==0&&(d+="0"),x=Math.sqrt(+d),w=Dt((w+1)/2)-(w<0||w%2),x==1/0?d="5e"+w:(d=x.toExponential(),d=d.slice(0,d.indexOf("e")+1)+w),g=new y(d)):g=new y(x+""),g.c[0]){for(w=g.e,x=w+F,x<3&&(x=0);;)if(f=g,g=T.times(f.plus(t(m,f,F,1))),St(f.c).slice(0,x)===(d=St(g.c)).slice(0,x))if(g.e<w&&--x,d=d.slice(x-3,x+1),d=="9999"||!p&&d=="4999"){if(!p&&(P(f,f.e+s+2,0),f.times(f).eq(m))){g=f;break}F+=4,x+=4,p=1}else{(!+d||!+d.slice(1)&&d.charAt(0)=="5")&&(P(g,g.e+s+2,1),l=!g.times(g).eq(m));break}}return P(g,g.e+s+1,o,l)},n.toExponential=function(l,d){return l!=null&&(je(l,0,Ze),l++),k(this,l,d,1)},n.toFixed=function(l,d){return l!=null&&(je(l,0,Ze),l=l+this.e+1),k(this,l,d)},n.toFormat=function(l,d,g){var p,f=this;if(g==null)l!=null&&d&&typeof d=="object"?(g=d,d=null):l&&typeof l=="object"?(g=l,l=d=null):g=re;else if(typeof g!="object")throw Error(vt+"Argument not an object: "+g);if(p=f.toFixed(l,d),f.c){var m,E=p.split("."),x=+g.groupSize,w=+g.secondaryGroupSize,F=g.groupSeparator||"",T=E[0],K=E[1],ne=f.s<0,se=ne?T.slice(1):T,le=se.length;if(w&&(m=x,x=w,w=m,le-=m),x>0&&le>0){for(m=le%x||x,T=se.substr(0,m);m<le;m+=x)T+=F+se.substr(m,x);w>0&&(T+=F+se.slice(m)),ne&&(T="-"+T)}p=K?T+(g.decimalSeparator||"")+((w=+g.fractionGroupSize)?K.replace(new RegExp("\\d{"+w+"}\\B","g"),"$&"+(g.fractionGroupSeparator||"")):K):T}return(g.prefix||"")+p+(g.suffix||"")},n.toFraction=function(l){var d,g,p,f,m,E,x,w,F,T,K,ne,se=this,le=se.c;if(l!=null&&(x=new y(l),!x.isInteger()&&(x.c||x.s!==1)||x.lt(a)))throw Error(vt+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+O(x));if(!le)return new y(se);for(d=new y(a),F=g=new y(a),p=w=new y(a),ne=St(le),m=d.e=ne.length-se.e-1,d.c[0]=Qi[(E=m%de)<0?de+E:E],l=!l||x.comparedTo(d)>0?m>0?d:F:x,E=_,_=1/0,x=new y(ne),w.c[0]=0;T=t(x,d,0,1),f=g.plus(T.times(p)),f.comparedTo(l)!=1;)g=p,p=f,F=w.plus(T.times(f=F)),w=f,d=x.minus(T.times(f=d)),x=f;return f=t(l.minus(g),p,0,1),w=w.plus(f.times(F)),g=g.plus(f.times(p)),w.s=F.s=se.s,m=m*2,K=t(F,p,m,o).minus(se).abs().comparedTo(t(w,g,m,o).minus(se).abs())<1?[F,p]:[w,g],_=E,K},n.toNumber=function(){return+O(this)},n.toPrecision=function(l,d){return l!=null&&je(l,1,Ze),k(this,l,d,2)},n.toString=function(l){var d,g=this,p=g.s,f=g.e;return f===null?p?(d="Infinity",p<0&&(d="-"+d)):d="NaN":(l==null?d=f<=u||f>=h?mi(St(g.c),f):rr(St(g.c),f,"0"):l===10&&_e?(g=P(new y(g),s+f+1,o),d=rr(St(g.c),g.e,"0")):(je(l,2,ae.length,"Base"),d=r(rr(St(g.c),f,"0"),10,l,p,!0)),p<0&&g.c[0]&&(d="-"+d)),d},n.valueOf=n.toJSON=function(){return O(this)},n._isBigNumber=!0,n[Symbol.toStringTag]="BigNumber",n[Symbol.for("nodejs.util.inspect.custom")]=n.valueOf,e!=null&&y.set(e),y}function Dt(e){var t=e|0;return e>0||e===t?t:t-1}function St(e){for(var t,r,i=1,n=e.length,a=e[0]+"";i<n;){for(t=e[i++]+"",r=de-t.length;r--;t="0"+t);a+=t}for(n=a.length;a.charCodeAt(--n)===48;);return a.slice(0,n+1||1)}function _r(e,t){var r,i,n=e.c,a=t.c,s=e.s,o=t.s,u=e.e,h=t.e;if(!s||!o)return null;if(r=n&&!n[0],i=a&&!a[0],r||i)return r?i?0:-o:s;if(s!=o)return s;if(r=s<0,i=u==h,!n||!a)return i?0:!n^r?1:-1;if(!i)return u>h^r?1:-1;for(o=(u=n.length)<(h=a.length)?u:h,s=0;s<o;s++)if(n[s]!=a[s])return n[s]>a[s]^r?1:-1;return u==h?0:u>h^r?1:-1}function je(e,t,r,i){if(e<t||e>r||e!==wt(e))throw Error(vt+(i||"Argument")+(typeof e=="number"?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function fi(e){var t=e.c.length-1;return Dt(e.e/de)==t&&e.c[t]%2!=0}function mi(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function rr(e,t,r){var i,n;if(t<0){for(n=r+".";++t;n+=r);e=n+e}else if(i=e.length,++t>i){for(n=r,t-=i;--t;n+=r);e+=n}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}var Fo=Vn(),Zt=Fo,Ro=class{key;left=null;right=null;constructor(e){this.key=e}},Vr=class extends Ro{constructor(e){super(e)}},Oo=class{size=0;modificationCount=0;splayCount=0;splay(e){let t=this.root;if(t==null)return this.compare(e,e),-1;let r=null,i=null,n=null,a=null,s=t,o=this.compare,u;for(;;)if(u=o(s.key,e),u>0){let h=s.left;if(h==null||(u=o(h.key,e),u>0&&(s.left=h.right,h.right=s,s=h,h=s.left,h==null)))break;r==null?i=s:r.left=s,r=s,s=h}else if(u<0){let h=s.right;if(h==null||(u=o(h.key,e),u<0&&(s.right=h.left,h.left=s,s=h,h=s.right,h==null)))break;n==null?a=s:n.right=s,n=s,s=h}else break;return n!=null&&(n.right=s.left,s.left=a),r!=null&&(r.left=s.right,s.right=i),this.root!==s&&(this.root=s,this.splayCount++),u}splayMin(e){let t=e,r=t.left;for(;r!=null;){let i=r;t.left=i.right,i.right=t,t=i,r=t.left}return t}splayMax(e){let t=e,r=t.right;for(;r!=null;){let i=r;t.right=i.left,i.left=t,t=i,r=t.right}return t}_delete(e){if(this.root==null||this.splay(e)!=0)return null;let t=this.root,r=t,i=t.left;if(this.size--,i==null)this.root=t.right;else{let n=t.right;t=this.splayMax(i),t.right=n,this.root=t}return this.modificationCount++,r}addNewRoot(e,t){this.size++,this.modificationCount++;let r=this.root;if(r==null){this.root=e;return}t<0?(e.left=r,e.right=r.right,r.right=null):(e.right=r,e.left=r.left,r.left=null),this.root=e}_first(){let e=this.root;return e==null?null:(this.root=this.splayMin(e),this.root)}_last(){let e=this.root;return e==null?null:(this.root=this.splayMax(e),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(e){return this.validKey(e)&&this.splay(e)==0}defaultCompare(){return(e,t)=>e<t?-1:e>t?1:0}wrap(){return{getRoot:()=>this.root,setRoot:e=>{this.root=e},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:e=>{this.splayCount=e},splay:e=>this.splay(e),has:e=>this.has(e)}}},_i=class Xr extends Oo{root=null;compare;validKey;constructor(t,r){super(),this.compare=t??this.defaultCompare(),this.validKey=r??(i=>i!=null&&i!=null)}delete(t){return this.validKey(t)?this._delete(t)!=null:!1}deleteAll(t){for(let r of t)this.delete(r)}forEach(t){let r=this[Symbol.iterator](),i;for(;i=r.next(),!i.done;)t(i.value,i.value,this)}add(t){let r=this.splay(t);return r!=0&&this.addNewRoot(new Vr(t),r),this}addAndReturn(t){let r=this.splay(t);return r!=0&&this.addNewRoot(new Vr(t),r),this.root.key}addAll(t){for(let r of t)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)<0)return this.root.key;let r=this.root.left;if(r==null)return null;let i=r.right;for(;i!=null;)r=i,i=r.right;return r.key}firstAfter(t){if(t==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(t)>0)return this.root.key;let r=this.root.right;if(r==null)return null;let i=r.left;for(;i!=null;)r=i,i=r.left;return r.key}retainAll(t){let r=new Xr(this.compare,this.validKey),i=this.modificationCount;for(let n of t){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(n)&&this.splay(n)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(t){return!this.validKey(t)||this.splay(t)!=0?null:this.root.key}intersection(t){let r=new Xr(this.compare,this.validKey);for(let i of this)t.has(i)&&r.add(i);return r}difference(t){let r=new Xr(this.compare,this.validKey);for(let i of this)t.has(i)||r.add(i);return r}union(t){let r=this.clone();return r.addAll(t),r}clone(){let t=new Xr(this.compare,this.validKey);return t.size=this.size,t.root=this.copyNode(this.root),t}copyNode(t){if(t==null)return null;function r(n,a){let s,o;do{if(s=n.left,o=n.right,s!=null){let u=new Vr(s.key);a.left=u,r(s,u)}if(o!=null){let u=new Vr(o.key);a.right=u,n=o,a=u}}while(o!=null)}let i=new Vr(t.key);return r(t,i),i}toSet(){return this.clone()}entries(){return new jo(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[Symbol.iterator](){return new Io(this.wrap())}[Symbol.toStringTag]="[object Set]"},Hn=class{tree;path=new Array;modificationCount=null;splayCount;constructor(e){this.tree=e,this.splayCount=e.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;let e=this.path[this.path.length-1];return this.getValue(e)}rebuildPath(e){this.path.splice(0,this.path.length),this.tree.splay(e),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(e){for(;e!=null;)this.path.push(e),e=e.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let r=this.tree.getRoot();for(;r!=null;)this.path.push(r),r=r.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let e=this.path[this.path.length-1],t=e.right;if(t!=null){for(;t!=null;)this.path.push(t),t=t.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===e;)e=this.path.pop();return this.path.length>0}},Io=class extends Hn{getValue(e){return e.key}},jo=class extends Hn{getValue(e){return[e.key,e.key]}},No=e=>e,Go=e=>{if(e){let t=new _i(Zi(e)),r=new _i(Zi(e)),i=(a,s)=>s.addAndReturn(a),n=a=>({x:i(a.x,t),y:i(a.y,r)});return n({x:new Zt(0),y:new Zt(0)}),n}return No},en=e=>({set:t=>{ir=en(t)},reset:()=>en(e),compare:Zi(e),snap:Go(e),orient:Ao(e)}),ir=en(),Hr=(e,t)=>e.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(e.ur.x)&&e.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(e.ur.y),tn=(e,t)=>{if(t.ur.x.isLessThan(e.ll.x)||e.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(e.ll.y)||e.ur.y.isLessThan(t.ll.y))return null;let r=e.ll.x.isLessThan(t.ll.x)?t.ll.x:e.ll.x,i=e.ur.x.isLessThan(t.ur.x)?e.ur.x:t.ur.x,n=e.ll.y.isLessThan(t.ll.y)?t.ll.y:e.ll.y,a=e.ur.y.isLessThan(t.ur.y)?e.ur.y:t.ur.y;return{ll:{x:r,y:n},ur:{x:i,y:a}}},yi=(e,t)=>e.x.times(t.y).minus(e.y.times(t.x)),Kn=(e,t)=>e.x.times(t.x).plus(e.y.times(t.y)),vi=e=>Kn(e,e).sqrt(),zo=(e,t,r)=>{let i={x:t.x.minus(e.x),y:t.y.minus(e.y)},n={x:r.x.minus(e.x),y:r.y.minus(e.y)};return yi(n,i).div(vi(n)).div(vi(i))},$o=(e,t,r)=>{let i={x:t.x.minus(e.x),y:t.y.minus(e.y)},n={x:r.x.minus(e.x),y:r.y.minus(e.y)};return Kn(n,i).div(vi(n)).div(vi(i))},qn=(e,t,r)=>t.y.isZero()?null:{x:e.x.plus(t.x.div(t.y).times(r.minus(e.y))),y:r},Yn=(e,t,r)=>t.x.isZero()?null:{x:r,y:e.y.plus(t.y.div(t.x).times(r.minus(e.x)))},Uo=(e,t,r,i)=>{if(t.x.isZero())return Yn(r,i,e.x);if(i.x.isZero())return Yn(e,t,r.x);if(t.y.isZero())return qn(r,i,e.y);if(i.y.isZero())return qn(e,t,r.y);let n=yi(t,i);if(n.isZero())return null;let a={x:r.x.minus(e.x),y:r.y.minus(e.y)},s=yi(a,t).div(n),o=yi(a,i).div(n),u=e.x.plus(o.times(t.x)),h=r.x.plus(s.times(i.x)),v=e.y.plus(o.times(t.y)),_=r.y.plus(s.times(i.y)),R=u.plus(h).div(2),I=v.plus(_).div(2);return{x:R,y:I}},Jt=class Za{point;isLeft;segment;otherSE;consumedBy;static compare(t,r){let i=Za.comparePoints(t.point,r.point);return i!==0?i:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:Ci.compare(t.segment,r.segment))}static comparePoints(t,r){return t.x.isLessThan(r.x)?-1:t.x.isGreaterThan(r.x)?1:t.y.isLessThan(r.y)?-1:t.y.isGreaterThan(r.y)?1:0}constructor(t,r){t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=r}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");let r=t.point.events;for(let i=0,n=r.length;i<n;i++){let a=r[i];this.point.events.push(a),a.point=this.point}this.checkForConsuming()}checkForConsuming(){let t=this.point.events.length;for(let r=0;r<t;r++){let i=this.point.events[r];if(i.segment.consumedBy===void 0)for(let n=r+1;n<t;n++){let a=this.point.events[n];a.consumedBy===void 0&&i.otherSE.point.events===a.otherSE.point.events&&i.segment.consume(a.segment)}}}getAvailableLinkedEvents(){let t=[];for(let r=0,i=this.point.events.length;r<i;r++){let n=this.point.events[r];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){let r=new Map,i=n=>{let a=n.otherSE;r.set(n,{sine:zo(this.point,t.point,a.point),cosine:$o(this.point,t.point,a.point)})};return(n,a)=>{r.has(n)||i(n),r.has(a)||i(a);let{sine:s,cosine:o}=r.get(n),{sine:u,cosine:h}=r.get(a);return s.isGreaterThanOrEqualTo(0)&&u.isGreaterThanOrEqualTo(0)?o.isLessThan(h)?1:o.isGreaterThan(h)?-1:0:s.isLessThan(0)&&u.isLessThan(0)?o.isLessThan(h)?-1:o.isGreaterThan(h)?1:0:u.isLessThan(s)?-1:u.isGreaterThan(s)?1:0}}},Vo=0,Ci=class Di{id;leftSE;rightSE;rings;windings;ringOut;consumedBy;prev;_prevInResult;_beforeState;_afterState;_isInResult;static compare(t,r){let i=t.leftSE.point.x,n=r.leftSE.point.x,a=t.rightSE.point.x,s=r.rightSE.point.x;if(s.isLessThan(i))return 1;if(a.isLessThan(n))return-1;let o=t.leftSE.point.y,u=r.leftSE.point.y,h=t.rightSE.point.y,v=r.rightSE.point.y;if(i.isLessThan(n)){if(u.isLessThan(o)&&u.isLessThan(h))return 1;if(u.isGreaterThan(o)&&u.isGreaterThan(h))return-1;let _=t.comparePoint(r.leftSE.point);if(_<0)return 1;if(_>0)return-1;let R=r.comparePoint(t.rightSE.point);return R!==0?R:-1}if(i.isGreaterThan(n)){if(o.isLessThan(u)&&o.isLessThan(v))return-1;if(o.isGreaterThan(u)&&o.isGreaterThan(v))return 1;let _=r.comparePoint(t.leftSE.point);if(_!==0)return _;let R=t.comparePoint(r.rightSE.point);return R<0?1:R>0?-1:1}if(o.isLessThan(u))return-1;if(o.isGreaterThan(u))return 1;if(a.isLessThan(s)){let _=r.comparePoint(t.rightSE.point);if(_!==0)return _}if(a.isGreaterThan(s)){let _=t.comparePoint(r.rightSE.point);if(_<0)return 1;if(_>0)return-1}if(!a.eq(s)){let _=h.minus(o),R=a.minus(i),I=v.minus(u),Y=s.minus(n);if(_.isGreaterThan(R)&&I.isLessThan(Y))return 1;if(_.isLessThan(R)&&I.isGreaterThan(Y))return-1}return a.isGreaterThan(s)?1:a.isLessThan(s)||h.isLessThan(v)?-1:h.isGreaterThan(v)?1:t.id<r.id?-1:t.id>r.id?1:0}constructor(t,r,i,n){this.id=++Vo,this.leftSE=t,t.segment=this,t.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=t,this.rings=i,this.windings=n}static fromRing(t,r,i){let n,a,s,o=Jt.comparePoints(t,r);if(o<0)n=t,a=r,s=1;else if(o>0)n=r,a=t,s=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);let u=new Jt(n,!0),h=new Jt(a,!1);return new Di(u,h,[i],[s])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let t=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(r)?t:r},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(r)?t:r}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return ir.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){let r=this.bbox(),i=t.bbox(),n=tn(r,i);if(n===null)return null;let a=this.leftSE.point,s=this.rightSE.point,o=t.leftSE.point,u=t.rightSE.point,h=Hr(r,o)&&this.comparePoint(o)===0,v=Hr(i,a)&&t.comparePoint(a)===0,_=Hr(r,u)&&this.comparePoint(u)===0,R=Hr(i,s)&&t.comparePoint(s)===0;if(v&&h)return R&&!_?s:!R&&_?u:null;if(v)return _&&a.x.eq(u.x)&&a.y.eq(u.y)?null:a;if(h)return R&&s.x.eq(o.x)&&s.y.eq(o.y)?null:o;if(R&&_)return null;if(R)return s;if(_)return u;let I=Uo(a,this.vector(),o,t.vector());return I===null||!Hr(n,I)?null:ir.snap(I)}split(t){let r=[],i=t.events!==void 0,n=new Jt(t,!0),a=new Jt(t,!1),s=this.rightSE;this.replaceRightSE(a),r.push(a),r.push(n);let o=new Di(n,s,this.rings.slice(),this.windings.slice());return Jt.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),Jt.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(n.checkForConsuming(),a.checkForConsuming()),r}swapEvents(){let t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let r=0,i=this.windings.length;r<i;r++)this.windings[r]*=-1}consume(t){let r=this,i=t;for(;r.consumedBy;)r=r.consumedBy;for(;i.consumedBy;)i=i.consumedBy;let n=Di.compare(r,i);if(n!==0){if(n>0){let a=r;r=i,i=a}if(r.prev===i){let a=r;r=i,i=a}for(let a=0,s=i.rings.length;a<s;a++){let o=i.rings[a],u=i.windings[a],h=r.rings.indexOf(o);h===-1?(r.rings.push(o),r.windings.push(u)):r.windings[h]+=u}i.rings=null,i.windings=null,i.consumedBy=r,i.leftSE.consumedBy=r.leftSE,i.rightSE.consumedBy=r.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{let t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;let t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};let r=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys;for(let o=0,u=this.rings.length;o<u;o++){let h=this.rings[o],v=this.windings[o],_=r.indexOf(h);_===-1?(r.push(h),i.push(v)):i[_]+=v}let a=[],s=[];for(let o=0,u=r.length;o<u;o++){if(i[o]===0)continue;let h=r[o],v=h.poly;if(s.indexOf(v)===-1)if(h.isExterior)a.push(v);else{s.indexOf(v)===-1&&s.push(v);let _=a.indexOf(h.poly);_!==-1&&a.splice(_,1)}}for(let o=0,u=a.length;o<u;o++){let h=a[o].multiPoly;n.indexOf(h)===-1&&n.push(h)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;let t=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(bi.type){case"union":{let i=t.length===0,n=r.length===0;this._isInResult=i!==n;break}case"intersection":{let i,n;t.length<r.length?(i=t.length,n=r.length):(i=r.length,n=t.length),this._isInResult=n===bi.numMultiPolys&&i<n;break}case"xor":{let i=Math.abs(t.length-r.length);this._isInResult=i%2===1;break}case"difference":{let i=n=>n.length===1&&n[0].isSubject;this._isInResult=i(t)!==i(r);break}}return this._isInResult}},Xn=class{poly;isExterior;segments;bbox;constructor(e,t,r){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let i=ir.snap({x:new Zt(e[0][0]),y:new Zt(e[0][1])});this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let n=i;for(let a=1,s=e.length;a<s;a++){if(typeof e[a][0]!="number"||typeof e[a][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let o=ir.snap({x:new Zt(e[a][0]),y:new Zt(e[a][1])});o.x.eq(n.x)&&o.y.eq(n.y)||(this.segments.push(Ci.fromRing(n,o,this)),o.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=o.x),o.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=o.y),o.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=o.x),o.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=o.y),n=o)}(!i.x.eq(n.x)||!i.y.eq(n.y))&&this.segments.push(Ci.fromRing(n,i,this))}getSweepEvents(){let e=[];for(let t=0,r=this.segments.length;t<r;t++){let i=this.segments[t];e.push(i.leftSE),e.push(i.rightSE)}return e}},Ho=class{multiPoly;exteriorRing;interiorRings;bbox;constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Xn(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,i=e.length;r<i;r++){let n=new Xn(e[r],this,!1);n.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=n.bbox.ur.y),this.interiorRings.push(n)}this.multiPoly=t}getSweepEvents(){let e=this.exteriorRing.getSweepEvents();for(let t=0,r=this.interiorRings.length;t<r;t++){let i=this.interiorRings[t].getSweepEvents();for(let n=0,a=i.length;n<a;n++)e.push(i[n])}return e}},Zn=class{isSubject;polys;bbox;constructor(e,t){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:new Zt(Number.POSITIVE_INFINITY),y:new Zt(Number.POSITIVE_INFINITY)},ur:{x:new Zt(Number.NEGATIVE_INFINITY),y:new Zt(Number.NEGATIVE_INFINITY)}};for(let r=0,i=e.length;r<i;r++){let n=new Ho(e[r],this);n.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=n.bbox.ur.y),this.polys.push(n)}this.isSubject=t}getSweepEvents(){let e=[];for(let t=0,r=this.polys.length;t<r;t++){let i=this.polys[t].getSweepEvents();for(let n=0,a=i.length;n<a;n++)e.push(i[n])}return e}},Ko=class mn{events;poly;_isExteriorRing;_enclosingRing;static factory(t){let r=[];for(let i=0,n=t.length;i<n;i++){let a=t[i];if(!a.isInResult()||a.ringOut)continue;let s=null,o=a.leftSE,u=a.rightSE,h=[o],v=o.point,_=[];for(;s=o,o=u,h.push(o),o.point!==v;)for(;;){let R=o.getAvailableLinkedEvents();if(R.length===0){let re=h[0].point,ae=h[h.length-1].point;throw new Error(`Unable to complete output ring starting at [${re.x}, ${re.y}]. Last matching segment found ends at [${ae.x}, ${ae.y}].`)}if(R.length===1){u=R[0].otherSE;break}let I=null;for(let re=0,ae=_.length;re<ae;re++)if(_[re].point===o.point){I=re;break}if(I!==null){let re=_.splice(I)[0],ae=h.splice(re.index);ae.unshift(ae[0].otherSE),r.push(new mn(ae.reverse()));continue}_.push({index:h.length,point:o.point});let Y=o.getLeftmostComparator(s);u=R.sort(Y)[0].otherSE;break}r.push(new mn(h))}return r}constructor(t){this.events=t;for(let r=0,i=t.length;r<i;r++)t[r].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point,r=[t];for(let h=1,v=this.events.length-1;h<v;h++){let _=this.events[h].point,R=this.events[h+1].point;ir.orient(_,t,R)!==0&&(r.push(_),t=_)}if(r.length===1)return null;let i=r[0],n=r[1];ir.orient(i,t,n)===0&&r.shift(),r.push(r[0]);let a=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:r.length-1,o=this.isExteriorRing()?r.length:-1,u=[];for(let h=s;h!=o;h+=a)u.push([r[h].x.toNumber(),r[h].y.toNumber()]);return u}isExteriorRing(){if(this._isExteriorRing===void 0){let t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let n=1,a=this.events.length;n<a;n++){let s=this.events[n];Jt.compare(t,s)>0&&(t=s)}let r=t.segment.prevInResult(),i=r?r.prevInResult():null;for(;;){if(!r)return null;if(!i)return r.ringOut;if(i.ringOut!==r.ringOut)return i.ringOut?.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut?.enclosingRing();r=i.prevInResult(),i=r?r.prevInResult():null}}},Jn=class{exteriorRing;interiorRings;constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){let e=this.exteriorRing.getGeom();if(e===null)return null;let t=[e];for(let r=0,i=this.interiorRings.length;r<i;r++){let n=this.interiorRings[r].getGeom();n!==null&&t.push(n)}return t}},qo=class{rings;polys;constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){let e=[];for(let t=0,r=this.polys.length;t<r;t++){let i=this.polys[t].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];if(!n.poly)if(n.isExteriorRing())t.push(new Jn(n));else{let a=n.enclosingRing();a?.poly||t.push(new Jn(a)),a?.poly?.addInterior(n)}}return t}},Yo=class{queue;tree;segments;constructor(e,t=Ci.compare){this.queue=e,this.tree=new _i(t),this.segments=[]}process(e){let t=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.delete(e.otherSE):this.tree.delete(t),r;e.isLeft&&this.tree.add(t);let i=t,n=t;do i=this.tree.lastBefore(i);while(i!=null&&i.consumedBy!=null);do n=this.tree.firstAfter(n);while(n!=null&&n.consumedBy!=null);if(e.isLeft){let a=null;if(i){let o=i.getIntersection(t);if(o!==null&&(t.isAnEndpoint(o)||(a=o),!i.isAnEndpoint(o))){let u=this._splitSafely(i,o);for(let h=0,v=u.length;h<v;h++)r.push(u[h])}}let s=null;if(n){let o=n.getIntersection(t);if(o!==null&&(t.isAnEndpoint(o)||(s=o),!n.isAnEndpoint(o))){let u=this._splitSafely(n,o);for(let h=0,v=u.length;h<v;h++)r.push(u[h])}}if(a!==null||s!==null){let o=null;a===null?o=s:s===null?o=a:o=Jt.comparePoints(a,s)<=0?a:s,this.queue.delete(t.rightSE),r.push(t.rightSE);let u=t.split(o);for(let h=0,v=u.length;h<v;h++)r.push(u[h])}r.length>0?(this.tree.delete(t),r.push(e)):(this.segments.push(t),t.prev=i)}else{if(i&&n){let a=i.getIntersection(n);if(a!==null){if(!i.isAnEndpoint(a)){let s=this._splitSafely(i,a);for(let o=0,u=s.length;o<u;o++)r.push(s[o])}if(!n.isAnEndpoint(a)){let s=this._splitSafely(n,a);for(let o=0,u=s.length;o<u;o++)r.push(s[o])}}}this.tree.delete(t)}return r}_splitSafely(e,t){this.tree.delete(e);let r=e.rightSE;this.queue.delete(r);let i=e.split(t);return i.push(r),e.consumedBy===void 0&&this.tree.add(e),i}},Xo=class{type;numMultiPolys;run(e,t,r){Kr.type=e;let i=[new Zn(t,!0)];for(let u=0,h=r.length;u<h;u++)i.push(new Zn(r[u],!1));if(Kr.numMultiPolys=i.length,Kr.type==="difference"){let u=i[0],h=1;for(;h<i.length;)tn(i[h].bbox,u.bbox)!==null?h++:i.splice(h,1)}if(Kr.type==="intersection")for(let u=0,h=i.length;u<h;u++){let v=i[u];for(let _=u+1,R=i.length;_<R;_++)if(tn(v.bbox,i[_].bbox)===null)return[]}let n=new _i(Jt.compare);for(let u=0,h=i.length;u<h;u++){let v=i[u].getSweepEvents();for(let _=0,R=v.length;_<R;_++)n.add(v[_])}let a=new Yo(n),s=null;for(n.size!=0&&(s=n.first(),n.delete(s));s;){let u=a.process(s);for(let h=0,v=u.length;h<v;h++){let _=u[h];_.consumedBy===void 0&&n.add(_)}n.size!=0?(s=n.first(),n.delete(s)):s=null}ir.reset();let o=Ko.factory(a.segments);return new qo(o).getGeom()}},Kr=new Xo,bi=Kr,Zo=(e,...t)=>bi.run("intersection",e,t),Jo=(e,...t)=>bi.run("difference",e,t);ir.set;function Li(e){let t={type:"Feature"};return t.geometry=e,t}function ki(e){return e.type==="Feature"?e.geometry:e}function Wn(e){return e&&e.geometry&&e.geometry.coordinates?e.geometry.coordinates:e}function Wo(e){return Li({type:"LineString",coordinates:e})}function Qo(e){return Li({type:"MultiLineString",coordinates:e})}function Qn(e){return Li({type:"Polygon",coordinates:e})}function ea(e){return Li({type:"MultiPolygon",coordinates:e})}function el(e,t){let r=ki(e),i=ki(t),n=Zo(r.coordinates,i.coordinates);return n.length===0?null:n.length===1?Qn(n[0]):ea(n)}function tl(e,t){let r=ki(e),i=ki(t),n=Jo(r.coordinates,i.coordinates);return n.length===0?null:n.length===1?Qn(n[0]):ea(n)}function ta(e){return Array.isArray(e)?1+ta(e[0]):-1}function rl(e){e instanceof L.Polyline&&(e=e.toGeoJSON(15));let t=Wn(e),r=ta(t),i=[];return r>1?t.forEach(n=>{i.push(Wo(n))}):i.push(e),i}function il(e){let t=[];return e.eachLayer(r=>{t.push(Wn(r.toGeoJSON(15)))}),Qo(t)}at.Cut=at.Polygon.extend({initialize(e){this._map=e,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let e=this._layer.getLatLngs();if(e.length<=2)return;let t=L.polygon(e,this.options.pathOptions);t._latlngInfos=this._layer._latlngInfo,this.cut(t),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:i,originalLayer:n})=>{this._fireCut(n,i,n),this._fireCut(this._map,i,n),n.pm._fireEdit()}),this._editedLayers=[];let r=this._hintMarker.getLatLng();this.disable(),this.options.continueDrawing&&(this.enable(),this._hintMarker.setLatLng(r))},cut(e){let t=this._map._layers,r=e._latlngInfos||[];Object.keys(t).map(i=>t[i]).filter(i=>i.pm).filter(i=>!i._pmTempLayer).filter(i=>!L.PM.optIn&&!i.options.pmIgnore||L.PM.optIn&&i.options.pmIgnore===!1).filter(i=>i instanceof L.Polyline).filter(i=>i!==e).filter(i=>i.pm.options.allowCutting).filter(i=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(i)>-1:!0).filter(i=>!this._layerGroup.hasLayer(i)).filter(i=>{try{let n=!!fr(e.toGeoJSON(15),i.toGeoJSON(15)).features.length>0;return n||i instanceof L.Polyline&&!(i instanceof L.Polygon)?n:!!el(e.toGeoJSON(15),i.toGeoJSON(15))}catch{return i instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(i=>{let n;if(i instanceof L.Polygon){n=L.polygon(i.getLatLngs());let u=n.getLatLngs();r.forEach(h=>{if(h&&h.snapInfo){let{latlng:v}=h,_=this._calcClosestLayer(v,[n]);if(_&&_.segment&&_.distance<this.options.snapDistance){let{segment:R}=_;if(R&&R.length===2){let{indexPath:I,parentPath:Y,newIndex:re}=L.PM.Utils._getIndexFromSegment(u,R);(I.length>1?(0,Po.default)(u,Y):u).splice(re,0,v)}}}})}else n=i;let a=this._cutLayer(e,n),s=L.geoJSON(a,i.options);s.getLayers().length===1&&([s]=s.getLayers()),this._setPane(s,"layerPane");let o=s.addTo(this._map.pm._getContainingLayer());if(o.pm.enable(i.pm.options),o.pm.disable(),i._pmTempLayer=!0,e._pmTempLayer=!0,i.remove(),i.removeFrom(this._map.pm._getContainingLayer()),e.remove(),e.removeFrom(this._map.pm._getContainingLayer()),o.getLayers&&o.getLayers().length===0&&this._map.pm.removeLayer({target:o}),o instanceof L.LayerGroup?(o.eachLayer(u=>{this._addDrawnLayerProp(u)}),this._addDrawnLayerProp(o)):this._addDrawnLayerProp(o),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let u=this.options.layersToCut.indexOf(i);u>-1&&this.options.layersToCut.splice(u,1)}this._editedLayers.push({layer:o,originalLayer:i})})},_cutLayer(e,t){let r=L.geoJSON(),i;if(t instanceof L.Polygon)i=tl(t.toGeoJSON(15),e.toGeoJSON(15));else{let n=rl(t);n.forEach(a=>{let s=yo(a,e.toGeoJSON(15)),o;s&&s.features.length>0?o=L.geoJSON(s):o=L.geoJSON(a),o.getLayers().forEach(u=>{Lo(e.toGeoJSON(15),u.toGeoJSON(15))||u.addTo(r)})}),n.length>1?i=il(r):i=r.toGeoJSON(15)}return i},_change:L.Util.falseFn}),at.Text=at.extend({initialize(e){this._map=e,this._shape="Text",this.toolbarButtonName="drawText"},enable(e){L.Util.setOptions(this,e),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(ve("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker?.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.off("mousemove",this._showHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(e){this.enabled()?this.disable():this.enable(e)},_syncHintMarker(e){if(this._hintMarker.setLatLng(e.latlng),this.options.snappable){let t=e;t.target=this._hintMarker,this._handleSnapping(t)}},_createMarker(e){if(!e.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(e.latlng);let t=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),this.options.textOptions?.className){let n=this.options.textOptions.className.split(" ");this.textArea.classList.add(...n)}let r=this._createTextIcon(this.textArea),i=new L.Marker(t,{textMarker:!0,_textMarkerOverPM:!0,icon:r});if(this._setPane(i,"markerPane"),this._finishLayer(i),i.pm||(i.options.draggable=!1),i.addTo(this._map.pm._getContainingLayer()),i.pm){i.pm.textArea=this.textArea,L.setOptions(i.pm,{removeIfEmpty:this.options.textOptions?.removeIfEmpty??!0});let n=this.options.textOptions?.focusAfterDraw??!0;i.pm._createTextMarker(n),this.options.textOptions?.text&&i.pm.setText(this.options.textOptions.text)}this._fireCreate(i),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this._map.once("mousemove",this._showHintMarkerAfterMoving,this)},_showHintMarkerAfterMoving(e){this.enable(),this._hintMarker.setLatLng(e.latlng)},_createTextArea(){let e=document.createElement("textarea");return e.readOnly=!0,e.classList.add("pm-textarea","pm-disabled"),e},_createTextIcon(e){return L.divIcon({className:"pm-text-marker",html:e})}});var nl={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,Er(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let e=this._getDOMElem();e&&(Er(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(e)):L.DomEvent.on(e,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,Er(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let e=this._getDOMElem();e&&(Er(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(e)):L.DomEvent.off(e,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(e){let t=e.touches?e.touches[0]:e,r={originalEvent:t,target:this._layer};return r.containerPoint=this._map.mouseEventToContainerPoint(t),r.latlng=this._map.containerPointToLatLng(r.containerPoint),this._dragMixinOnMouseDown(r),!1},_simulateMouseMoveEvent(e){let t=e.touches?e.touches[0]:e,r={originalEvent:t,target:this._layer};return r.containerPoint=this._map.mouseEventToContainerPoint(t),r.latlng=this._map.containerPointToLatLng(r.containerPoint),this._dragMixinOnMouseMove(r),!1},_simulateMouseUpEvent(e){let t={originalEvent:e.touches?e.touches[0]:e,target:this._layer};return e.type.indexOf("touch")===-1&&(t.containerPoint=this._map.mouseEventToContainerPoint(e),t.latlng=this._map.containerPointToLatLng(t.containerPoint)),this._dragMixinOnMouseUp(t),!1},_dragMixinOnMouseDown(e){if(e.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(e);let t=e._fromLayerSync,r=this._syncLayers("_dragMixinOnMouseDown",e);if(this._layer instanceof L.Marker&&(this.options.snappable&&!t&&!r?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let i="resizeableCircleMarker";this._layer instanceof L.Circle&&(i="resizeableCircle"),this.options.snappable&&!t&&!r?this._layer.pm.options[i]||this._initSnappableMarkersDrag():this._layer.pm.options[i]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=e.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(e){this._overwriteEventIfItComesFromMarker(e);let t=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",e),this._dragging||(this._dragging=!0,L.DomUtil.addClass(t,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=e.latlng),this._onLayerDrag(e),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(e){let t=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",e),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,t&&L.DomUtil.removeClass(t,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(e){let{latlng:t}=e,r={lat:t.lat-this._tempDragCoord.lat,lng:t.lng-this._tempDragCoord.lng},i=n=>n.map(a=>{if(Array.isArray(a))return i(a);let s={lat:a.lat+r.lat,lng:a.lng+r.lng};return(a.alt||a.alt===0)&&(s.alt=a.alt),s});if(this._layer instanceof L.Circle&&this._layer.options.resizeableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let n=i([this._layer.getLatLng()]);this._layer.setLatLng(n[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let n=this._layer.getLatLng();this._layer._snapped&&(n=this._layer._orgLatLng);let a=i([n]);this._layer.setLatLng(a[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let n=i([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(n),this._fireChange(this._layer.getBounds(),"Edit")}else{let n=i(this._layer.getLatLngs());this._layer.setLatLngs(n),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=t,e.layer=this._layer,this._fireDrag(e)},addDraggingClass(){let e=this._getDOMElem();e&&L.DomUtil.addClass(e,"leaflet-pm-draggable")},removeDraggingClass(){let e=this._getDOMElem();e&&L.DomUtil.removeClass(e,"leaflet-pm-draggable")},_getDOMElem(){let e=null;return this._layer._path?e=this._layer._path:this._layer._renderer&&this._layer._renderer._container?e=this._layer._renderer._container:this._layer._image?e=this._layer._image:this._layer._icon&&(e=this._layer._icon),e},_overwriteEventIfItComesFromMarker(e){e.target.getLatLng&&(!e.target._radius||e.target._radius<=10)&&(e.containerPoint=this._map.mouseEventToContainerPoint(e.originalEvent),e.latlng=this._map.containerPointToLatLng(e.containerPoint))},_syncLayers(e,t){if(this.enabled())return!1;if(!t._fromLayerSync&&this._layer===t.target&&this.options.syncLayersOnDrag){t._fromLayerSync=!0;let r=[];if(L.Util.isArray(this.options.syncLayersOnDrag))r=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(i=>{i instanceof L.LayerGroup&&(r=r.concat(i.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let i in this._parentLayerGroup){let n=this._parentLayerGroup[i];n.pm&&(r=n.pm.getLayers(!0))}return L.Util.isArray(r)&&r.length>0&&(r=r.filter(i=>!!i.pm).filter(i=>!!i.pm.options.draggable),r.forEach(i=>{i!==this._layer&&i.pm[e]&&(i._snapped=!1,i.pm[e](t))})),r.length>0}return!1},_stopDOMImageDrag(e){return e.preventDefault(),!1}},al=nl,sl=Q(Gt());function ol(e,t,r,i){return r.unproject(t.transform(r.project(e,i)),i)}function ra(e,t,r){let i=r.getMaxZoom();if(i===1/0&&(i=r.getZoom()),L.Util.isArray(e)){let n=[];return e.forEach(a=>{n.push(ra(a,t,r))}),n}return e instanceof L.LatLng?ol(e,t,r,i):null}function Dr(e,t){t instanceof L.Layer&&(t=t.getLatLng());let r=e.getMaxZoom();return r===1/0&&(r=e.getZoom()),e.project(t,r)}function xi(e,t){let r=e.getMaxZoom();return r===1/0&&(r=e.getZoom()),e.unproject(t,r)}var ll={_onRotateStart(e){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Dr(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Dr(this._map,e.target.getLatLng()),this._initialRotateLatLng=or(this._layer),this._startAngle=this.getAngle();let t=or(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,t),this._fireRotationStart(this._map,t)},_onRotate(e){let t=Dr(this._map,e.target.getLatLng()),r=this._rotationStartPoint,i=this._rotationOriginPoint,n=Math.atan2(t.y-i.y,t.x-i.x)-Math.atan2(r.y-i.y,r.x-i.x);this._layer.setLatLngs(this._rotateLayer(n,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let a=this;function s(v,_=[],R=-1){if(R>-1&&_.push(R),L.Util.isArray(v[0]))v.forEach((I,Y)=>s(I,_.slice(),Y));else{let I=_.length>0?(0,sl.default)(a._markers,_):a._markers[0];v.forEach((Y,re)=>{I[re].setLatLng(Y)})}}s(this._layer.getLatLngs());let o=or(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(n,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let u=n*180/Math.PI;u=u<0?u+360:u;let h=u+this._startAngle;this._setAngle(h),this._rotationLayer.pm._setAngle(h),this._fireRotation(this._rotationLayer,u,o),this._fireRotation(this._map,u,o),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let e=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let t=or(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=or(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,e,t),this._fireRotationEnd(this._map,e,t),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(e,t,r,i,n){let a=Dr(n,r);return this._matrix=i.clone().rotate(e,a).flip(),ra(t,this._matrix,n)},_setAngle(e){e=e<0?e+360:e,this._angle=e%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let e=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),t=e.getCenter();return e.removeFrom(this._layer._map),t},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(zi(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let e={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),e),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=or(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(e){let t=this.getAngle(),r=this._layer.getLatLngs(),i=e*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(i,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+e),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(i,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let n=this.getAngle()-t;n=n<0?n+360:n,this._startAngle=t,this._fireRotation(this._layer,n,r,this._layer),this._fireRotation(this._map||this._layer._map,n,r,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(e){let t=e-this.getAngle();this.rotateLayer(t)},getAngle(){return this._angle||0},setInitAngle(e){this._setAngle(e)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(e){this._rotationCenter=e,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(e)}},ul=ll,hl=L.Class.extend({includes:[al,Sn,ul,ui],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizeableCircle:!0,snapMiddle:!1,snapVertex:!0},setOptions(e){L.Util.setOptions(this,e)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(e,t){t==="layerPane"?e.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":t==="vertexPane"?e.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":t==="markerPane"&&(e.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(e,t){let r=t.target,i={layer:this._layer,marker:r,event:t},n="";return e==="move"?n="moveVertexValidation":e==="add"?n="addVertexValidation":e==="remove"&&(n="removeVertexValidation"),this.options[n]&&typeof this.options[n]=="function"&&!this.options[n](i)?(e==="move"&&(r._cancelDragEventChain=r.getLatLng()),!1):(r._cancelDragEventChain=null,!0)},_vertexValidationDrag(e){return e._cancelDragEventChain?(e._latlng=e._cancelDragEventChain,e.update(),!1):!0},_vertexValidationDragEnd(e){return e._cancelDragEventChain?(e._cancelDragEventChain=null,!1):!0}}),Je=hl;Je.LayerGroup=L.Class.extend({initialize(e){this._layerGroup=e,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(i=>this._initLayer(i));let t=i=>{if(i.layer._pmTempLayer)return;this._layers=this.getLayers();let n=this._layers.filter(a=>!a.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in a.pm._parentLayerGroup));n.forEach(a=>{this._initLayer(a)}),n.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(t,100,this),this),this._layerGroup.on("layerremove",i=>{this._removeLayerFromGroup(i.target)},this);let r=i=>{i.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(r,100,this),this)},enable(e,t=[]){t.length===0&&(this._layers=this.getLayers()),this._options=e,this._layers.forEach(r=>{r instanceof L.LayerGroup?t.indexOf(r._leaflet_id)===-1&&(t.push(r._leaflet_id),r.pm.enable(e,t)):r.pm.enable(e)})},disable(e=[]){e.length===0&&(this._layers=this.getLayers()),this._layers.forEach(t=>{t instanceof L.LayerGroup?e.indexOf(t._leaflet_id)===-1&&(e.push(t._leaflet_id),t.pm.disable(e)):t.pm.disable()})},enabled(e=[]){return e.length===0&&(this._layers=this.getLayers()),!!this._layers.find(t=>t instanceof L.LayerGroup?e.indexOf(t._leaflet_id)===-1?(e.push(t._leaflet_id),t.pm.enabled(e)):!1:t.pm.enabled())},toggleEdit(e,t=[]){t.length===0&&(this._layers=this.getLayers()),this._options=e,this._layers.forEach(r=>{r instanceof L.LayerGroup?t.indexOf(r._leaflet_id)===-1&&(t.push(r._leaflet_id),r.pm.toggleEdit(e,t)):r.pm.toggleEdit(e)})},_initLayer(e){let t=L.Util.stamp(this._layerGroup);e.pm._parentLayerGroup||(e.pm._parentLayerGroup={}),e.pm._parentLayerGroup[t]=this._layerGroup},_removeLayerFromGroup(e){if(e.pm&&e.pm._layerGroup){let t=L.Util.stamp(this._layerGroup);delete e.pm._layerGroup[t]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(e=>e.pm.dragging()):!1},getOptions(){return this.options},_getMap(){return this._map||this._layers.find(e=>!!e._map)?._map||null},getLayers(e=!1,t=!0,r=!0,i=[]){let n=[];return e?this._layerGroup.getLayers().forEach(a=>{n.push(a),a instanceof L.LayerGroup&&i.indexOf(a._leaflet_id)===-1&&(i.push(a._leaflet_id),n=n.concat(a.pm.getLayers(!0,!0,!0,i)))}):n=this._layerGroup.getLayers(),r&&(n=n.filter(a=>!(a instanceof L.LayerGroup))),t&&(n=n.filter(a=>!!a.pm),n=n.filter(a=>!a._pmTempLayer),n=n.filter(a=>!L.PM.optIn&&!a.options.pmIgnore||L.PM.optIn&&a.options.pmIgnore===!1)),n},setOptions(e,t=[]){t.length===0&&(this._layers=this.getLayers()),this.options=e,this._layers.forEach(r=>{r.pm&&(r instanceof L.LayerGroup?t.indexOf(r._leaflet_id)===-1&&(t.push(r._leaflet_id),r.pm.setOptions(e,t)):r.pm.setOptions(e))})}}),Je.Marker=Je.extend({_shape:"Marker",initialize(e){this._layer=e,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(e={draggable:!0}){if(L.Util.setOptions(this,e),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(e){this.enabled()?this.disable():this.enable(e)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(e){let t=e.target;t.remove(),this._fireRemove(t),this._fireRemove(this._map,t)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let e=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,e.off("pm:drag",this._handleSnapping,this),e.on("pm:drag",this._handleSnapping,this),e.off("pm:dragend",this._cleanupSnapping,this),e.on("pm:dragend",this._cleanupSnapping,this),e.off("pm:dragstart",this._unsnap,this),e.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let e=this._layer;e.off("pm:drag",this._handleSnapping,this),e.off("pm:dragend",this._cleanupSnapping,this),e.off("pm:dragstart",this._unsnap,this)}});var hr=Q(Gt()),cl={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this._layer.on("remove",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let e=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=e.filter((t,r,i)=>i.indexOf(t)===r)},_removeFromCache(e){let t=this.markerCache.indexOf(e);t>-1&&this.markerCache.splice(t,1)},renderLimits(e){this.markerCache.forEach(t=>{e.includes(t)?this._markerGroup.addLayer(t):this._markerGroup.removeLayer(t)})},applyLimitFilters({latlng:e={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let t=[...this._filterClosestMarkers(e)];this.renderLimits(t)},_filterClosestMarkers(e){let t=[...this.markerCache],r=this.options.limitMarkersToCount;return r===-1?t:(t.sort((i,n)=>{let a=i._latlng.distanceTo(e),s=n._latlng.distanceTo(e);return a-s}),t.filter((i,n)=>r>-1?n<r:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(e){this._preventRenderMarkers=!!e}},dl=cl;Je.Line=Je.extend({includes:[dl],_shape:"Line",initialize(e){this._layer=e,this._enabled=!1},enable(e){if(L.Util.setOptions(this,e),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let e=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(e,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(e){return this.enabled()?this.disable():this.enable(e),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let e=this._map,t=this._layer.getLatLngs();this._markerGroup&&(this._markerGroup.removeFrom(e),this._markerGroup.clearLayers()),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let r=i=>{if(Array.isArray(i[0]))return i.map(r,this);let n=i.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&i.map((a,s)=>{let o=this.isPolygon()?(s+1)%i.length:s+1;return this._createMiddleMarker(n[s],n[o])}),n};this._markers=r(t),this.filterMarkerGroup(),e.addLayer(this._markerGroup)},_createMarker(e){let t=new L.Marker(e,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(t,"vertexPane"),t._pmTempLayer=!0,this.options.rotate?(t.on("dragstart",this._onRotateStart,this),t.on("drag",this._onRotate,this),t.on("dragend",this._onRotateEnd,this)):(t.on("click",this._onVertexClick,this),t.on("dragstart",this._onMarkerDragStart,this),t.on("move",this._onMarkerDrag,this),t.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||t.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(t),t},_createMiddleMarker(e,t){if(!e||!t)return!1;let r=L.PM.Utils.calcMiddleLatLng(this._map,e.getLatLng(),t.getLatLng()),i=this._createMarker(r),n=L.divIcon({className:"marker-icon marker-icon-middle"});return i.setIcon(n),i.leftM=e,i.rightM=t,e._middleMarkerNext=i,t._middleMarkerPrev=i,i.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),i.on("movestart",this._onMiddleMarkerMoveStart,this),i},_onMiddleMarkerClick(e){let t=e.target;if(!this._vertexValidation("add",e))return;let r=L.divIcon({className:"marker-icon"});t.setIcon(r),this._addMarker(t,t.leftM,t.rightM)},_onMiddleMarkerMoveStart(e){let t=e.target;if(t.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",e)){t.on("move",this._onMiddleMarkerMovePrevent,this);return}t._dragging=!0,this._addMarker(t,t.leftM,t.rightM)},_onMiddleMarkerMovePrevent(e){let t=e.target;this._vertexValidationDrag(t)},_onMiddleMarkerMoveEnd(e){let t=e.target;if(t.off("move",this._onMiddleMarkerMovePrevent,this),t.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(t))return;let r=L.divIcon({className:"marker-icon"});t.setIcon(r),setTimeout(()=>{delete t._dragging},100)},_addMarker(e,t,r){e.off("movestart",this._onMiddleMarkerMoveStart,this),e.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let i=e.getLatLng(),n=this._layer._latlngs;delete e.leftM,delete e.rightM;let{indexPath:a,index:s,parentPath:o}=L.PM.Utils.findDeepMarkerIndex(this._markers,t),u=a.length>1?(0,hr.default)(n,o):n,h=a.length>1?(0,hr.default)(this._markers,o):this._markers;u.splice(s+1,0,i),h.splice(s+1,0,e),this._layer.setLatLngs(n),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(t,e),this._createMiddleMarker(e,r)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(e,L.PM.Utils.findDeepMarkerIndex(this._markers,e).indexPath,i),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return di(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(e){let t=this._layer,r,i;if(this.options.allowSelfIntersection?r=!1:(i=di(this._layer.toGeoJSON(15)),r=i.features.length>0),r){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return r;e?this._flashLayer():(t.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(i)}else t.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return r},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(e,t){e.forEach(r=>{Array.isArray(r)?this._updateDisabledMarkerStyle(r,t):r._icon&&(t&&!this._checkMarkerAllowedToDrag(r)?L.DomUtil.addClass(r._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(r._icon,"vertexmarker-disabled"))})},_removeMarker(e){let t=e.target;if(!this._vertexValidation("remove",e))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=or(this._layer,this._layer.getLatLngs()));let r=this._layer.getLatLngs(),{indexPath:i,index:n,parentPath:a}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);if(!i)return;let s=i.length>1?(0,hr.default)(r,a):r,o=i.length>1?(0,hr.default)(this._markers,a):this._markers,u=a[a.length-1]>0&&this._layer instanceof L.Polygon;if(!this.options.removeLayerBelowMinVertexCount&&!u&&(s.length<=2||this.isPolygon()&&s.length<=3)){this._flashLayer();return}s.splice(n,1),this._layer.setLatLngs(r),this.isPolygon()&&s.length<=2&&s.splice(0,s.length);let h=!1;if(s.length<=1&&(s.splice(0,s.length),a.length>1&&i.length>1&&(r=hi(r)),this._layer.setLatLngs(r),this._initMarkers(),h=!0),Gi(r)||this._layer.remove(),r=hi(r),this._layer.setLatLngs(r),this._markers=hi(this._markers),!h&&(o=i.length>1?(0,hr.default)(this._markers,a):this._markers,t._middleMarkerPrev&&(this._markerGroup.removeLayer(t._middleMarkerPrev),this._removeFromCache(t._middleMarkerPrev)),t._middleMarkerNext&&(this._markerGroup.removeLayer(t._middleMarkerNext),this._removeFromCache(t._middleMarkerNext)),this._markerGroup.removeLayer(t),this._removeFromCache(t),o)){let v,_;if(this.isPolygon()?(v=(n+1)%o.length,_=(n+(o.length-1))%o.length):(_=n-1<0?void 0:n-1,v=n+1>=o.length?void 0:n+1),v!==_){let R=o[_],I=o[v];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(R,I)}o.splice(n,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(t,i),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(e){let t=this._layer.getLatLngs(),r=e.getLatLng(),{indexPath:i,index:n,parentPath:a}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);(i.length>1?(0,hr.default)(t,a):t).splice(n,1,r),this._layer.setLatLngs(t)},_getNeighborMarkers(e){let{indexPath:t,index:r,parentPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e),n=t.length>1?(0,hr.default)(this._markers,i):this._markers,a=(r+1)%n.length,s=(r+(n.length-1))%n.length,o=n[s],u=n[a];return{prevMarker:o,nextMarker:u}},_checkMarkerAllowedToDrag(e){let{prevMarker:t,nextMarker:r}=this._getNeighborMarkers(e),i=L.polyline([t.getLatLng(),e.getLatLng()]),n=L.polyline([e.getLatLng(),r.getLatLng()]),a=fr(this._layer.toGeoJSON(15),i.toGeoJSON(15)).features.length,s=fr(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length;return e.getLatLng()===this._markers[0][0].getLatLng()?s+=1:e.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(a+=1),!(a<=2&&s<=2)},_onMarkerDragStart(e){let t=e.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",e))return;let{indexPath:r}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);this._fireMarkerDragStart(e,r),this.options.allowSelfIntersection||(this._coordsBeforeEdit=or(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(t):this._markerAllowedToDrag=null},_onMarkerDrag(e){let t=e.target;if(!this._vertexValidationDrag(t))return;let{indexPath:r,index:i,parentPath:n}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);if(!r)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(t);let a=r.length>1?(0,hr.default)(this._markers,n):this._markers,s=(i+1)%a.length,o=(i+(a.length-1))%a.length,u=t.getLatLng(),h=a[o].getLatLng(),v=a[s].getLatLng();if(t._middleMarkerNext){let _=L.PM.Utils.calcMiddleLatLng(this._map,u,v);t._middleMarkerNext.setLatLng(_)}if(t._middleMarkerPrev){let _=L.PM.Utils.calcMiddleLatLng(this._map,u,h);t._middleMarkerPrev.setLatLng(_)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(e,r),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(e){let t=e.target;if(!this._vertexValidationDragEnd(t))return;let{indexPath:r}=L.PM.Utils.findDeepMarkerIndex(this._markers,t),i=!this.options.allowSelfIntersection&&this.hasSelfIntersection();i&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(i=!1);let n=!this.options.allowSelfIntersection&&i;if(this._fireMarkerDragEnd(e,r,n),n){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(e,r);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(e){let t=e.target;if(t._dragging)return;let{indexPath:r}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);this._fireVertexClick(e,r)}}),Je.Polygon=Je.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(e){let{prevMarker:t,nextMarker:r}=this._getNeighborMarkers(e),i=L.polyline([t.getLatLng(),e.getLatLng()]),n=L.polyline([e.getLatLng(),r.getLatLng()]),a=fr(this._layer.toGeoJSON(15),i.toGeoJSON(15)).features.length,s=fr(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length;return!(a<=2&&s<=2)}}),Je.Rectangle=Je.Polygon.extend({_shape:"Rectangle",_initMarkers(){let e=this._map,t=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,e.addLayer(this._markerGroup),this._markers=[],this._markers[0]=t.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((r,i)=>{let n=this._cornerMarkers.find(a=>a._index===i);n&&n.setLatLng(r)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(e,t){let r=new L.Marker(e,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(r,"vertexPane"),r._origLatLng=e,r._index=t,r._pmTempLayer=!0,r.on("click",this._onVertexClick,this),this._markerGroup.addLayer(r),r},_addMarkerEvents(){this._markers[0].forEach(e=>{e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(e){if(!this._vertexValidation("move",e))return;let t=e.target,r=this._cornerMarkers;t._oppositeCornerLatLng=r.find(n=>n._index===(t._index+2)%4).getLatLng(),t._snapped=!1;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);this._fireMarkerDragStart(e,i)},_onMarkerDrag(e){let t=e.target;if(!this._vertexValidationDrag(t)||t._index===void 0)return;this._adjustRectangleForMarkerMove(t);let{indexPath:r}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);this._fireMarkerDrag(e,r),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(e){let t=e.target;if(!this._vertexValidationDragEnd(t))return;this._cornerMarkers.forEach(i=>{delete i._oppositeCornerLatLng});let{indexPath:r}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);this._fireMarkerDragEnd(e,r),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_adjustRectangleForMarkerMove(e){L.extend(e._origLatLng,e._latlng);let t=L.PM.Utils._getRotatedRectangle(e.getLatLng(),e._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(t),this._adjustAllMarkers(e),this._layer.redraw()},_adjustAllMarkers(e){let t=this._layer.getLatLngs()[0];if(t&&t.length!==4&&t.length>0)t.forEach((r,i)=>{this._cornerMarkers[i].setLatLng(r)}),this._cornerMarkers.slice(t.length).forEach(r=>{r.setLatLng(t[0])});else if(!t||!t.length)console.error("The layer has no LatLngs");else{let r=t.findIndex(i=>e.getLatLng().equals(i));r>-1?(this._cornerMarkers[(e._index+1)%4].setLatLng(t[(r+1)%4]),this._cornerMarkers[(e._index+2)%4].setLatLng(t[(r+2)%4]),this._cornerMarkers[(e._index+3)%4].setLatLng(t[(r+3)%4])):this._cornerMarkers.forEach(i=>{i.setLatLng(t[i._index])})}},_findCorners(){this._angle===void 0&&this.setInitAngle(zi(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let e=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(e[0],e[2],this.getAngle(),this._map||this)}}),Je.CircleMarker=Je.extend({_shape:"CircleMarker",initialize(e){this._layer=e,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(e={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,e),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this._helperLayers&&(this._helperLayers.clearLayers(),this._helperLayers.removeFrom(this._map)),this.options[this._editableOption]?(this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(e){this.enabled()?this.disable():this.enable(e)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let e=this._map;this._helperLayers&&(this._helperLayers.removeFrom(e),this._helperLayers.clearLayers()),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(e);let t=this._layer.getLatLng(),r=this._layer._radius,i=this._getLatLngOnCircle(t,r);this._centerMarker=this._createCenterMarker(t),this._outerMarker=this._createOuterMarker(i),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(e,t){let r=this._map.project(e),i=L.point(r.x+t,r.y);return this._map.unproject(i)},_createHintLine(e,t){let r=e.getLatLng(),i=t.getLatLng();this._hintline=L.polyline([r,i],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(e){let t=this._createMarker(e);return this.options.draggable?(L.DomUtil.addClass(t._icon,"leaflet-pm-draggable"),t.on("move",this._moveCircle,this)):t.dragging.disable(),t},_createOuterMarker(e){let t=this._createMarker(e);return t.on("drag",this._resizeCircle,this),t},_createMarker(e){let t=new L.Marker(e,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(t,"vertexPane"),t._origLatLng=e,t._pmTempLayer=!0,t.on("dragstart",this._onMarkerDragStart,this),t.on("drag",this._onMarkerDrag,this),t.on("dragend",this._onMarkerDragEnd,this),t.on("click",this._onVertexClick,this),this._helperLayers.addLayer(t),t},_moveCircle(e){if(e.target._cancelDragEventChain)return;let t=this._centerMarker.getLatLng();this._layer.setLatLng(t);let r=this._layer._radius,i=this._getLatLngOnCircle(t,r);this._outerMarker._latlng=i,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let e=this._layer.getLatLng(),t=this._layer._radius,r=this._getLatLngOnCircle(e,t);this._outerMarker.setLatLng(r),this._centerMarker.setLatLng(e),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let e=this._centerMarker.getLatLng(),t=this._outerMarker.getLatLng(),r=this._distanceCalculation(e,t);this.options[this._minRadiusOption]&&r<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&r>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(r),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let e=this._centerMarker.getLatLng(),t=this._outerMarker.getLatLng();this._hintline.setLatLngs([e,t])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(e){this._vertexValidation("move",e)&&this._fireMarkerDragStart(e)},_onMarkerDrag(e){let t=e.target;t instanceof L.Marker&&!this._vertexValidationDrag(t)||this._fireMarkerDrag(e)},_onMarkerDragEnd(e){this._extedingMarkerDragEnd();let t=e.target;this._vertexValidationDragEnd(t)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(e))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let e=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,e.off("pm:drag",this._handleSnapping,this),e.on("pm:drag",this._handleSnapping,this),e.off("pm:dragend",this._cleanupSnapping,this),e.on("pm:dragend",this._cleanupSnapping,this),e.off("pm:dragstart",this._unsnap,this),e.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let e=this._layer;e.off("pm:drag",this._handleSnapping,this),e.off("pm:dragend",this._cleanupSnapping,this),e.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let e=this._layer._map||this._map;if(e){let t=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),e,this._layer.getLatLng()),r=L.circle(this._layer.getLatLng(),this._layer.options);r.setRadius(t);let i=e&&e.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(r,200,!i).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(r,200,!i),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let e=this._centerMarker.getLatLng(),t=this._outerMarker.getLatLng(),r=this._distanceCalculation(e,t);return this.options[this._minRadiusOption]&&r<this.options[this._minRadiusOption]?t=ci(this._map,e,t,this._getMinDistanceInMeter(e)):this.options[this._maxRadiusOption]&&r>this.options[this._maxRadiusOption]&&(t=ci(this._map,e,t,this._getMaxDistanceInMeter(e))),t},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let e=this._centerMarker.getLatLng(),t=this._outerMarker.getLatLng(),r=this._distanceCalculation(e,t);this.options[this._minRadiusOption]&&r<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&r>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(e,t){return this._map.project(e).distanceTo(this._map.project(t))},_getMinDistanceInMeter(e){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,e)},_getMaxDistanceInMeter(e){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,e)},_onVertexClick(e){e.target._dragging||this._fireVertexClick(e,void 0)}}),Je.Circle=Je.CircleMarker.extend({_shape:"Circle",initialize(e){this._layer=e,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizeableCircle",this._updateHiddenPolyCircle()},enable(e){L.PM.Edit.CircleMarker.prototype.enable.call(this,e||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let e=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(e,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let e=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!e).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!e),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(e,t){return this._map.distance(e,t)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(e){e.target._dragging||this._fireVertexClick(e,void 0)}}),Je.ImageOverlay=Je.extend({_shape:"ImageOverlay",initialize(e){this._layer=e,this._enabled=!1},toggleEdit(e){this.enabled()?this.disable():this.enable(e)},enabled(){return this._enabled},enable(e={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,e),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let e=this._layer.getBounds(),t=e.getNorthWest(),r=e.getNorthEast(),i=e.getSouthEast(),n=e.getSouthWest();return[t,r,i,n]}}),Je.Text=Je.extend({_shape:"Text",initialize(e){this._layer=e,this._enabled=!1},enable(e){if(L.Util.setOptions(this,e),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let e=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),e.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(e){this.enabled()?this.disable():this.enable(e)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let e=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,e.off("pm:drag",this._handleSnapping,this),e.on("pm:drag",this._handleSnapping,this),e.off("pm:dragend",this._cleanupSnapping,this),e.on("pm:dragend",this._cleanupSnapping,this),e.off("pm:dragstart",this._unsnap,this),e.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let e=this._layer;e.off("pm:drag",this._handleSnapping,this),e.off("pm:dragend",this._cleanupSnapping,this),e.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let e=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,t=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${e}px`,this.textArea.style.width=`${t}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(e){e.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(e={}){let t=this._hasFocus;this._hasFocus=e.type==="focus",!t!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(e){e&&(this.textArea.value=e),this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let t=this.options.className.split(" ");this.textArea.classList.add(...t)}let e=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(e),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(e=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),e===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(e){e.preventDefault()}});var rn=function(e,t,r,i,n,a){this._matrix=[e,t,r,i,n,a]};rn.init=()=>new L.PM.Matrix(1,0,0,1,0,0),rn.prototype={transform(e){return this._transform(e.clone())},_transform(e){let t=this._matrix,{x:r,y:i}=e;return e.x=t[0]*r+t[1]*i+t[4],e.y=t[2]*r+t[3]*i+t[5],e},untransform(e){let t=this._matrix;return new L.Point((e.x/t[0]-t[4])/t[0],(e.y/t[2]-t[5])/t[2])},clone(){let e=this._matrix;return new L.PM.Matrix(e[0],e[1],e[2],e[3],e[4],e[5])},translate(e){if(e===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let t,r;return typeof e=="number"?(t=e,r=e):(t=e.x,r=e.y),this._add(1,0,0,1,t,r)},scale(e,t){if(e===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let r,i;return t=t||L.point(0,0),typeof e=="number"?(r=e,i=e):(r=e.x,i=e.y),this._add(r,0,0,i,t.x,t.y)._add(1,0,0,1,-t.x,-t.y)},rotate(e,t){let r=Math.cos(e),i=Math.sin(e);return t=t||new L.Point(0,0),this._add(r,i,-i,r,t.x,t.y)._add(1,0,0,1,-t.x,-t.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(e,t,r,i,n,a){let s=[[],[],[]],o=this._matrix,u=[[o[0],o[2],o[4]],[o[1],o[3],o[5]],[0,0,1]],h=[[e,r,n],[t,i,a],[0,0,1]],v;e&&e instanceof L.PM.Matrix&&(o=e._matrix,h=[[o[0],o[2],o[4]],[o[1],o[3],o[5]],[0,0,1]]);for(let _=0;_<3;_+=1)for(let R=0;R<3;R+=1){v=0;for(let I=0;I<3;I+=1)v+=u[_][I]*h[I][R];s[_][R]=v}return this._matrix=[s[0][0],s[1][0],s[0][1],s[1][1],s[0][2],s[1][2]],this}};var pl=rn,gl={calcMiddleLatLng(e,t,r){let i=e.project(t),n=e.project(r);return e.unproject(i._add(n)._divideBy(2))},findLayers(e){let t=[];return e.eachLayer(r=>{(r instanceof L.Polyline||r instanceof L.Marker||r instanceof L.Circle||r instanceof L.CircleMarker||r instanceof L.ImageOverlay)&&t.push(r)}),t=t.filter(r=>!!r.pm),t=t.filter(r=>!r._pmTempLayer),t=t.filter(r=>!L.PM.optIn&&!r.options.pmIgnore||L.PM.optIn&&r.options.pmIgnore===!1),t},circleToPolygon(e,t=60,r=!0){let i=e.getLatLng(),n=e.getRadius(),a=wn(i,n,t,0,r),s=[];for(let o=0;o<a.length;o+=1){let u=[a[o].lat,a[o].lng];s.push(u)}return L.polygon(s,e.options)},disablePopup(e){e.getPopup()&&(e._tempPopupCopy=e.getPopup(),e.unbindPopup())},enablePopup(e){e._tempPopupCopy&&(e.bindPopup(e._tempPopupCopy),delete e._tempPopupCopy)},_fireEvent(e,t,r,i=!1){e.fire(t,r,i);let{groups:n}=this.getAllParentGroups(e);n.forEach(a=>{a.fire(t,r,i)})},getAllParentGroups(e){let t=[],r=[],i=n=>{for(let a in n._eventParents)if(t.indexOf(a)===-1){t.push(a);let s=n._eventParents[a];r.push(s),i(s)}};return!e._pmLastGroupFetch||!e._pmLastGroupFetch.time||new Date().getTime()-e._pmLastGroupFetch.time>1e3?(i(e),e._pmLastGroupFetch={time:new Date().getTime(),groups:r,groupIds:t},{groupIds:t,groups:r}):{groups:e._pmLastGroupFetch.groups,groupIds:e._pmLastGroupFetch.groupIds}},createGeodesicPolygon:wn,getTranslation:ve,findDeepCoordIndex(e,t,r=!0){let i,n=s=>(o,u)=>{let h=s.concat(u);if(r){if(o.lat&&o.lat===t.lat&&o.lng===t.lng)return i=h,!0}else if(o.lat&&L.latLng(o).equals(t))return i=h,!0;return Array.isArray(o)&&o.some(n(h))};e.some(n([]));let a={};return i&&(a={indexPath:i,index:i[i.length-1],parentPath:i.slice(0,i.length-1)}),a},findDeepMarkerIndex(e,t){let r,i=a=>(s,o)=>{let u=a.concat(o);return s._leaflet_id===t._leaflet_id?(r=u,!0):Array.isArray(s)&&s.some(i(u))};e.some(i([]));let n={};return r&&(n={indexPath:r,index:r[r.length-1],parentPath:r.slice(0,r.length-1)}),n},_getIndexFromSegment(e,t){if(t&&t.length===2){let r=this.findDeepCoordIndex(e,t[0]),i=this.findDeepCoordIndex(e,t[1]),n=Math.max(r.index,i.index);return(r.index===0||i.index===0)&&n!==1&&(n+=1),{indexA:r,indexB:i,newIndex:n,indexPath:r.indexPath,parentPath:r.parentPath}}return null},_getRotatedRectangle(e,t,r,i){let n=Dr(i,e),a=Dr(i,t),s=r*Math.PI/180,o=Math.cos(s),u=Math.sin(s),h=(a.x-n.x)*o+(a.y-n.y)*u,v=(a.y-n.y)*o-(a.x-n.x)*u,_=h*o+n.x,R=h*u+n.y,I=-v*u+n.x,Y=v*o+n.y,re=xi(i,n),ae=xi(i,{x:_,y:R}),_e=xi(i,a),y=xi(i,{x:I,y:Y});return[re,ae,_e,y]},pxRadiusToMeterRadius(e,t,r){let i=t.project(r),n=L.point(i.x+e,i.y);return t.distance(t.unproject(n),r)}},fl=gl;L.PM=L.PM||{version:Wa.version,Map:$s,Toolbar:Ks,Draw:at,Edit:Je,Utils:fl,Matrix:pl,activeLang:"en",optIn:!1,initialize(e){this.addInitHooks(e)},setOptIn(e){this.optIn=!!e},addInitHooks(){function e(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(e);function t(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(t);function r(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(r);function i(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(i);function n(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(n);function a(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(a);function s(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(s);function o(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(o);function u(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(u)},reInitLayer(e){e instanceof L.LayerGroup&&e.eachLayer(t=>{this.reInitLayer(t)}),e.pm||L.PM.optIn&&e.options.pmIgnore!==!1||e.options.pmIgnore||(e instanceof L.Map?e.pm=new L.PM.Map(e):e instanceof L.Marker?e.options.textMarker?(e.pm=new L.PM.Edit.Text(e),e.pm._initTextMarker(),e.pm._createTextMarker(!1)):e.pm=new L.PM.Edit.Marker(e):e instanceof L.Circle?e.pm=new L.PM.Edit.Circle(e):e instanceof L.CircleMarker?e.pm=new L.PM.Edit.CircleMarker(e):e instanceof L.Rectangle?e.pm=new L.PM.Edit.Rectangle(e):e instanceof L.Polygon?e.pm=new L.PM.Edit.Polygon(e):e instanceof L.Polyline?e.pm=new L.PM.Edit.Line(e):e instanceof L.LayerGroup?e.pm=new L.PM.Edit.LayerGroup(e):e instanceof L.ImageOverlay&&(e.pm=new L.PM.Edit.ImageOverlay(e)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(e){let t=this._map.mouseEventToLayerPoint(e),r,i;for(let n=this._drawFirst;n;n=n.next)r=n.layer,r.options.interactive&&r._containsPoint(t)&&(!(e.type==="click"||e.type==="preclick")||!this._map._draggableMoved(r))&&(i=r);i&&(L.DomEvent.fakeStop(e),this._fireEvent([i],e))}}),L.PM.initialize()})()),ya}$h();const Uh=()=>{console.log("Geoman initialized globally")},{Footer:Vh}=ar;function Hh(){const c=qe(C=>C.portal.activePortalDetails);return N.jsx(Vh,{style:{textAlign:"center"},children:N.jsx("p",{children:c?.portal_copyright})})}const{Sider:Kh,Content:qh,Header:Yh,Footer:ec}=ar,Xh=A.memo(()=>{const{token:{colorBgContainer:c,borderRadiusLG:C}}=hu.useToken(),{portal_url:b}=bl(),B=Tr(),D=Ll(),{sidebarCollapsed:G}=qe(te=>te.map),M=qe(te=>te.ui),[V,Q]=A.useState([]);A.useEffect(()=>{b&&B(kl("/"+b))},[b]),A.useEffect(()=>(document.title="GIS Dashboard",()=>{B(xl()),B(Ml())}),[]),A.useEffect(()=>{Uh()},[]);const W=A.useCallback(()=>M.isAttributeTableOpen?["0"]:M.isMeasureOpen?["1"]:M.isLegendVisible?["2"]:M.isPrintModalOpen?["4"]:M.isBufferOpen?["5"]:M.isIdentifyOpen?["6"]:[],[M]);A.useEffect(()=>{Q(W())},[M,W]);const $=[{key:"0",icon:st.createElement(Ph),label:"Attributes",onClick:()=>{B(dn({state:!1})),B(cn({state:!0}))}},{key:"1",icon:st.createElement(Lh),label:"Measure",onClick:()=>{B(El())}},{key:"2",icon:st.createElement(fa),label:"Legends",onClick:()=>{B(Bl())}},{key:"3",icon:st.createElement(xh),label:"Clear",onClick:()=>window.location.reload()},{key:"4",icon:st.createElement(Bh),label:"Print",onClick:()=>{B(wl())}},{key:"5",icon:st.createElement(Dh),label:"Buffer",onClick:()=>{B(cn({state:!1})),B(dn({state:!0}))}},{key:"6",icon:st.createElement(fa),label:"Identify",onClick:()=>{B(Dl())}}],ee=te=>{B(na())};return N.jsxs(ar,{className:"gis-layout",style:{minHeight:"100vh"},children:[N.jsx(Kh,{style:{backgroundColor:"white"},width:400,breakpoint:"lg",collapsed:G,collapsedWidth:0,onCollapse:ee,children:N.jsx(qa,{})}),N.jsxs(ar,{children:[N.jsx(Yh,{style:{padding:"0 16px",background:c},children:N.jsxs(_n,{align:"middle",justify:"space-between",wrap:!1,style:{width:"100%"},children:[N.jsx(Pr,{span:22,children:N.jsxs("div",{style:{width:"100%",display:"flex",gap:"12px",alignItems:"center"},children:[N.jsx(Sr,{title:"Back",children:N.jsx(nr,{type:"text",onClick:()=>{D(-1)},icon:N.jsx(cu,{})})}),N.jsx(Sr,{title:G?"Open sidebar":"Collapse sidebar",children:N.jsx(nr,{type:"text",onClick:()=>B(na()),icon:G?N.jsx(fh,{}):N.jsx(dh,{})})}),N.jsx(du,{mode:"horizontal",items:$,selectable:!0,selectedKeys:V,style:{flex:1,minWidth:0,borderBottom:"none",background:"transparent"}})]})}),N.jsx(Pr,{span:2,style:{textAlign:"right"},children:N.jsx(pu,{})})]})}),N.jsx(qh,{style:{margin:"24px 16px 0"},children:N.jsx("div",{style:{width:"100%",height:"100%",minHeight:360,background:c,borderRadius:C},children:N.jsx(Xa,{})})}),N.jsx(Hh,{})]})]})});Xh.displayName="GisDashboard";export{Xh as default};
